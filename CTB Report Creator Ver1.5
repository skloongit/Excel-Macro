Sub FileSelect()
    myRow = ActiveSheet.Shapes(Application.Caller).BottomRightCell.Row
    myGetFile = Application.GetOpenFilename(, , "Please select " & Range("A" & myRow).Value & " file:")
        If myGetFile = False Then
            End
        Else
            mySelect = myGetFile
            Range("B" & myRow).Value = mySelect
        End If
End Sub
Sub CtbFileSelect()
    myMacroFile = ActiveWorkbook.Name
    DeleteCfSheet
    myRow = ActiveSheet.Shapes(Application.Caller).BottomRightCell.Row
    myGetFile = Application.GetOpenFilename(, , "Please select " & Range("A" & myRow).Value & " file:")
        If myGetFile = False Then
            End
        Else
            mySelect = myGetFile
            Range("B" & myRow).Value = mySelect
            Application.ScreenUpdating = False
            Workbooks.Open mySelect, False, True
            myCfFilename = ActiveWorkbook.Name
            If ActiveSheet.AutoFilterMode = True Then
               Rows("3:3").AutoFilter
            End If
            Set mySearchValue = Cells.Find(What:="Part Number", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
            If mySearchValue Is Nothing Then
                Set mySearchValue = Cells.Find(What:="PartNumber", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
                If mySearchValue Is Nothing Then
                    MsgBox "Part Number column not found! The Macro will stop here!"
                    End
                Else
                    mySearchValue = Cells.Find(What:="PartNumber", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
                    If mySearchValue <> 1 Then
                        Cells(1, mySearchValue).EntireColumn.Cut
                        Columns("A:A").Insert
                    End If
                End If
            Else
                mySearchValue = Cells.Find(What:="Part Number", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
                If mySearchValue <> 1 Then
                    Cells(1, mySearchValue).EntireColumn.Cut
                    Columns("A:A").Insert
                End If
            End If
            
            'SPD
            Set mySearchValue = Cells.Find(What:="SPD", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
            If mySearchValue Is Nothing Then
                MsgBox "SPD column not found! The Macro will stop here!"
                End
            Else
                mySearchValue = Cells.Find(What:="SPD", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
                If mySearchValue <> 2 Then
                    Cells(1, mySearchValue).EntireColumn.Cut
                    Columns("B:B").Insert
                End If
            End If
            myTempTotal = Range("A" & Rows.Count).End(xlUp).Row
            Range("J1:J" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
            ActiveSheet.Range("$J$1:$J$" & myTempTotal).RemoveDuplicates Columns:=1, Header:=xlYes
            Range("J2:J" & Range("A" & Rows.Count).End(xlUp).Row).Copy
            Range("M1").PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
            myA = 13
            Do Until Cells(1, myA).Value = ""
                Range("J1:K" & myTempTotal).Value = Range("A1:B" & myTempTotal).Value
                Range("L1:L" & myTempTotal).Value = "=IF(J1=""" & Cells(1, myA).Value & """,ROW(K1),""Delete"")"
                Range("L1:L" & myTempTotal).Value = Range("L1:L" & myTempTotal).Value
                ActiveSheet.Range("$J$1:$L$" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
                ActiveSheet.Range("$J$1:$L$" & Range("K" & Rows.Count).End(xlUp).Row).RemoveDuplicates Columns:=2, Header:=xlYes
                myTemp = Range("K" & Rows.Count).End(xlUp).Row
                Range(Cells(2, myA), Cells(myTemp, myA)).Value = Range("K2:K" & myTemp).Value
                myA = myA + 1
            Loop
            Columns("A:L").Delete
            ActiveSheet.Name = "CF_DueDate"
            Sheets("CF_DueDate").Copy Before:=Workbooks(myMacroFile).Sheets(Workbooks(myMacroFile).Sheets.Count)
            Sheets("CF_DueDate").Visible = False
            Sheets("Macro").Select
            Workbooks(myCfFilename).Close False
            Application.ScreenUpdating = True
        End If
End Sub
Sub DeleteCfSheet()
    On Error Resume Next
    Application.DisplayAlerts = False
    Sheets("CF_DueDate").Delete
    Application.DisplayAlerts = True
End Sub
Sub Ctb()
    myMacroFile = ActiveWorkbook.Name
    myMacroPath = ActiveWorkbook.Path
    myStrTime = Time
    Range("E22:F" & Rows.Count).ClearContents
    Range(Cells(1, 27), Cells(Rows.Count, Columns.Count)).ClearContents
    
    myShortageFile = Range("B13").Value
    myCfFile = Range("B15").Value
    myDueDate = Range("B17").Value
    
    myTotalAssembly = Range("B" & Rows.Count).End(xlUp).Row
    If myTotalAssembly < 22 Then
        MsgBox "No assembly found!"
        End
    Else
'        Range("A22:A" & myTotalAssembly).Value = "=COUNTIF(B:B,B22)"
'        Range("A22:A" & myTotalAssembly).Value = Range("A22:A" & myTotalAssembly).Value
'        myTotalDuplicate = Application.WorksheetFunction.Sum(Columns("A:A"))
'        If myTotalDuplicate > myTotalAssembly - 21 Then
'            For myA = 22 To myTotalAssembly
'                If Range("A" & myA).Value > 1 Then
'                    Range("B" & myA).Select
'                    Range("A22:A" & myTotalAssembly).ClearContents
'                    Exit For
'                End If
'            Next myA
'            MsgBox "Repeated Assembly number found!"
'            End
'        End If
    End If
'    Range("A22:A" & myTotalAssembly).ClearContents
    
    'Ver1.5: Get Tools number
    Range("AA22:AA" & myTotalAssembly).Value = "=SUBSTITUTE(RC[-26],"" "","""")"
    Range("AA22:AA" & myTotalAssembly).Value = Range("AA22:AA" & myTotalAssembly).Value
    Range("AA22:AA" & myTotalAssembly).TextToColumns Destination:=Range("AA22"), DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, Comma:=True, Space:=False, Other:=False, TrailingMinusNumbers:=True
    
    If myCfFile <> "" Then
        Workbooks.Open myCfFile, , True
        myCfFilename = ActiveWorkbook.Name
        ActiveSheet.Name = "Temp"
        'Part Number
        Set mySearchValue = Cells.Find(What:="Part Number", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
        If mySearchValue Is Nothing Then
            Set mySearchValue = Cells.Find(What:="PartNumber", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
            If mySearchValue Is Nothing Then
                MsgBox "Part Number column not found! The Macro will stop here!"
                End
            Else
                mySearchValue = Cells.Find(What:="PartNumber", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
                If mySearchValue <> 1 Then
                    Cells(1, mySearchValue).EntireColumn.Cut
                    Columns("A:A").Insert
                End If
            End If
        Else
            mySearchValue = Cells.Find(What:="Part Number", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
            If mySearchValue <> 1 Then
                Cells(1, mySearchValue).EntireColumn.Cut
                Columns("A:A").Insert
            End If
        End If
        
        'SPD
        Set mySearchValue = Cells.Find(What:="SPD", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
        If mySearchValue Is Nothing Then
            MsgBox "SPD column not found! The Macro will stop here!"
            End
        Else
            mySearchValue = Cells.Find(What:="SPD", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
            If mySearchValue <> 2 Then
                Cells(1, mySearchValue).EntireColumn.Cut
                Columns("B:B").Insert
            End If
        End If
        
        'Series#
        Set mySearchValue = Cells.Find(What:="Series#", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
        If mySearchValue Is Nothing Then
            MsgBox "Series# column not found! The Macro will stop here!"
            End
        Else
            mySearchValue = Cells.Find(What:="Series#", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
            If mySearchValue <> 1 Then
                Cells(1, mySearchValue).EntireColumn.Cut
                Columns("C:C").Insert
            End If
        End If
        myTempTotal = Range("A" & Rows.Count).End(xlUp).Row
        Columns("A:A").Insert
        'Range("A2:A" & myTempTotal).Value = "=B2&C2"
        'Range("A2:A" & myTempTotal).Value = "=B2&C2&G2&COUNTIFS($B$1:B2,B2,$C$1:C2,C2,$G$1:G2,G2)"
        'PartNumberSPD
        'Range("A2:A" & myTempTotal).Value = "=B2&C2&COUNTIFS($B$1:B2,B2,$C$1:C2,C2)"
        'Range("A2:A" & myTempTotal).Value = Range("A2:A" & myTempTotal).Value
        'PartNumberSeries#
        Range("A2:A" & myTempTotal).Value = "=B2&D2"
        Range("A2:A" & myTempTotal).Value = Range("A2:A" & myTempTotal).Value
        
    End If
    
    Workbooks.Open myShortageFile, , True
    myShortageFilename = ActiveWorkbook.Name
    myShortageSheetname = ActiveSheet.Name
    myShortageSheetIndex = ActiveSheet.Index
        'Ver1.3: Change Shortage Report
        'Delete Due date later than user enter
        myShortage = Range("E" & Rows.Count).End(xlUp).Row
        Range("BI3").Value = myDueDate
        Range("BI4:BI" & myShortage).Value = "=IF(M4>$BI$3,""Delete"",Row(X4))"
        Range("BI4:BI" & myShortage).Value = Range("BI4:BI" & myShortage).Value
        Range("BI3").Value = "Delete"
        ActiveSheet.Range("$A$3:$BI$" & myShortage).RemoveDuplicates Columns:=61, Header:=xlNo
        myShortage = Range("F" & Rows.Count).End(xlUp).Row
            'Ver1.5: Add Priority
            Range("BI3").Value = "Priority"
            Range("BI4:BI" & myShortage).Value = "=IFERROR(VLOOKUP(B2,'[" & myMacroFile & "]Priority'!$A:$B,2,0),"""")"
            Range("BI4:BI" & myShortage).Value = Range("BI4:BI" & myShortage).Value
            'Columns("BI:BI").ClearContents
    'Ver1.3: New version
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
       Rows("3:3").AutoFilter
    Else
       Rows("3:3").AutoFilter
    End If
    Workbooks(myMacroFile).Sheets("Summary_Format").Copy Before:=Sheets(1)
    Sheets("Summary_Format").Visible = True
    Sheets("Summary_Format").Select
    ActiveSheet.Name = "Summary"
    Sheets.Add Before:=Sheets(1)
    ActiveSheet.Name = "Temp"
    
    For myA = 22 To myTotalAssembly
        Sheets("Temp").Select
        Cells.ClearContents
        Range("A1:B" & myShortage).Value = Sheets(myShortageSheetname).Range("E1:F" & myShortage).Value
        Range("C1:C" & myShortage).Value = Sheets(myShortageSheetname).Range("M1:M" & myShortage).Value
        myMaterial = Workbooks(myMacroFile).Sheets("Macro").Range("B" & myA).Value
        'Range("D3").Value = Workbooks(myMacroFile).Sheets("Macro").Range("C" & myA).Value
        Range("D3").Value = Workbooks(myMacroFile).Sheets("Macro").Range("D" & myA).Value
        Range("D4:D" & myShortage).Value = "=IF(AND(A4=""" & myMaterial & """,$D$3=C4),ROW(C4),""Delete"")"
        Range("D4:D" & myShortage).Value = Range("D4:D" & myShortage).Value
        Range("D3").Value = "Delete"
        Range("A3:D" & myShortage).RemoveDuplicates Columns:=4, Header:=xlNo
        myShortageTemp = Range("B" & Rows.Count).End(xlUp).Row
        Range("E4:E" & myShortageTemp).Value = "=IFERROR(LEFT(B4,FIND("":"",B4,6)-1),B4)"
        Range("E4:E" & myShortageTemp).Value = Range("E4:E" & myShortageTemp).Value
        Range("E4:E" & myShortageTemp).RemoveDuplicates Columns:=1, Header:=xlNo
        mySoTotal = Range("E" & Rows.Count).End(xlUp).Row
            For myB = 4 To mySoTotal
                Sheets.Add Before:=Sheets(Sheets.Count)
                myTools = Workbooks(myMacroFile).Sheets("Macro").Cells(myA, myB + 23).Value
                If myTools = "" Then
                    ActiveSheet.Name = Replace(Sheets("Temp").Range("E" & myB).Value, ":", "_")
                Else
                    ActiveSheet.Name = myTools
                End If
                myTempSheet = ActiveSheet.Name
                Sheets(myShortageSheetname).Select
                ClearAllFilter
                ActiveSheet.Range("$A$3:$BI$" & myShortage).AutoFilter Field:=6, Criteria1:="=" & Sheets("Temp").Range("E" & myB).Value & "*", Operator:=xlAnd
                Range("E3:BI" & myShortage).Copy Sheets(myTempSheet).Range("A1")
                Sheets(myTempSheet).Columns("A:BE").AutoFit
                'Update Macro Summary
                Workbooks(myMacroFile).Sheets("Macro").Range("E" & myA).Value = "Done"
                If Workbooks(myMacroFile).Sheets("Macro").Range("F" & myA).Value = "" Then
                    'Workbooks(myMacroFile).Sheets("Macro").Range("F" & myA).Value = myTempSheet
                    Workbooks(myMacroFile).Sheets("Macro").Range("F" & myA).Value = Sheets("Temp").Range("E" & myB).Value
                Else
                    'Workbooks(myMacroFile).Sheets("Macro").Range("F" & myA).Value = Workbooks(myMacroFile).Sheets("Macro").Range("F" & myA).Value & "," & myTempSheet
                    Workbooks(myMacroFile).Sheets("Macro").Range("F" & myA).Value = Workbooks(myMacroFile).Sheets("Macro").Range("F" & myA).Value & "," & Sheets("Temp").Range("E" & myB).Value
                End If
                'Sum Need Qty
                Sheets(myTempSheet).Select
                myTempSheetTotal = Range("AG" & Rows.Count).End(xlUp).Row
                Range("BF2:BF" & myTempSheetTotal).Value = "=SUMIFS(AP:AP,AG:AG,AG2,AI:AI,AI2)"
                Range("BF2:BF" & myTempSheetTotal).Value = Range("BF2:BF" & myTempSheetTotal).Value
                Range("AP2:AP" & myTempSheetTotal).Value = Range("BF2:BF" & myTempSheetTotal).Value
                Columns("BF:BF").ClearContents
                ActiveSheet.Range("$A$1:$BE$" & myTempSheetTotal).RemoveDuplicates Columns:=Array(33, 35), Header:=xlYes
                
                'Top 5 Gated
                'Sheets(myTempSheet).Select
                myTempSheetTotal = Range("AG" & Rows.Count).End(xlUp).Row
                Range("BG1:BG" & myTempSheetTotal).Value = Range("AG1:AG" & myTempSheetTotal).Value
                Range("BH1:BH" & myTempSheetTotal).Value = Range("AQ1:AQ" & myTempSheetTotal).Value
                Range("BI1:BI" & myTempSheetTotal).Value = "=IF(RC[-1]=""Past"",""Delete"",ROW(RC[-1]))"
                Range("BI1:BI" & myTempSheetTotal).Value = Range("BI1:BI" & myTempSheetTotal).Value
                Range("BI1").Value = "Delete"
                ActiveSheet.Range("$BG$1:$BI$" & myTempSheetTotal).RemoveDuplicates Columns:=3, Header:=xlNo
                ActiveWorkbook.Worksheets(myTempSheet).Sort.SortFields.Clear
                ActiveWorkbook.Worksheets(myTempSheet).Sort.SortFields.Add Key:=Range("BH2:BH" & myTempSheetTotal), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
                With ActiveWorkbook.Worksheets(myTempSheet).Sort
                    .SetRange Range("BG1:BI" & myTempSheetTotal)
                    .Header = xlYes
                    .MatchCase = False
                    .Orientation = xlTopToBottom
                    .SortMethod = xlPinYin
                    .Apply
                End With
                ActiveSheet.Range("$BG$1:$BI$" & myTempSheetTotal).RemoveDuplicates Columns:=Array(1, 2), Header:=xlYes
                Columns("BI:BI").ClearContents
                Range("BG7:BH" & Rows.Count).ClearContents
                
'            Next myB
'        If mySoTotal > 3 Then
            'Update Summary Tab
            'myTotalTools = Application.WorksheetFunction.CountIfs(Workbooks(myCfFilename).Sheets("Temp").Columns("B:B"), myMaterial, Workbooks(myCfFilename).Sheets("Temp").Columns("C:C"), Workbooks(myMacroFile).Sheets("Macro").Range("C" & myA).Value, Workbooks(myCfFilename).Sheets("Temp").Columns("G:G"), Sheets(myTempSheet).Range("G4").Value)
            'myTotalTools = Application.WorksheetFunction.CountIfs(Workbooks(myCfFilename).Sheets("Temp").Columns("B:B"), myMaterial, Workbooks(myCfFilename).Sheets("Temp").Columns("C:C"), Workbooks(myMacroFile).Sheets("Macro").Range("C" & myA).Value)
'            For myC = 1 To myTotalTools
                Sheets("Summary").Columns("B:B").Copy
                Sheets("Summary").Columns("B:B").Insert
                'ASM request Date
                'Sheets("Summary").Range("B4").Value = "=VLOOKUP(""" & myMaterial & """&'[" & myMacroFile & "]Macro'!$C$" & myA & "&""" & myC & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,8,0)"
                Sheets("Summary").Range("B4").Value = "=VLOOKUP(""" & myMaterial & myTempSheet & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,8,0)"
                Sheets("Summary").Range("B4").Value = Sheets("Summary").Range("B4").Value
                'WW
                Sheets("Summary").Range("B3").Value = "=" & """WW""" & "&WEEKNUM(B4,1)"
                Sheets("Summary").Range("B3").Value = Sheets("Summary").Range("B3").Value
                'PO#/CF
                'Sheets("Summary").Range("B5").Value = "=VLOOKUP(""" & myMaterial & """&'[" & myMacroFile & "]Macro'!$C$" & myA & "&""" & myC & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,6,0)"
                Sheets("Summary").Range("B5").Value = "=VLOOKUP(""" & myMaterial & myTempSheet & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,6,0)"
                If IsError(Sheets("Summary").Range("B5").Value) Then
                    Sheets("Summary").Range("B5").ClearContents
                Else
                    Sheets("Summary").Range("B5").Value = Sheets("Summary").Range("B5").Value
                End If
                'PO Received Date
                Sheets("Summary").Range("B6").ClearContents
                'Part Number
                Sheets("Summary").Range("B7").Value = myMaterial
                'Model
                'Sheets("Summary").Range("B8").Value = "=VLOOKUP(""" & myMaterial & """&'[" & myMacroFile & "]Macro'!$C$" & myA & "&""" & myC & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,5,0)"
                Sheets("Summary").Range("B8").Value = "=VLOOKUP(""" & myMaterial & myTempSheet & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,5,0)"
                If IsError(Sheets("Summary").Range("B8").Value) Then
                    Sheets("Summary").Range("B8").ClearContents
                Else
                    Sheets("Summary").Range("B8").Value = Sheets("Summary").Range("B8").Value
                End If
                'Quantity
                'Sheets("Summary").Range("B9").Value = "=VLOOKUP(""" & myMaterial & """&'[" & myMacroFile & "]Macro'!$C$" & myA & "&""" & myC & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,7,0)"
                Sheets("Summary").Range("B9").Value = "=VLOOKUP(""" & myMaterial & myTempSheet & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,7,0)"
                If IsError(Sheets("Summary").Range("B9").Value) Then
                    Sheets("Summary").Range("B9").ClearContents
                Else
                    Sheets("Summary").Range("B9").Value = Sheets("Summary").Range("B9").Value
                End If
                'Op ID
                'Sheets("Summary").Range("B10").Value = "=VLOOKUP(""" & myMaterial & """&'[" & myMacroFile & "]Macro'!$C$" & myA & "&""" & myC & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,4,0)"
                Sheets("Summary").Range("B10").Value = "=VLOOKUP(""" & myMaterial & myTempSheet & """,'[" & Replace(myCfFilename, "'", "''", 1) & "]Temp'!$A:$H,4,0)"
                If IsError(Sheets("Summary").Range("B10").Value) Then
                    Sheets("Summary").Range("B10").ClearContents
                Else
                    Sheets("Summary").Range("B10").Value = Sheets("Summary").Range("B10").Value
                End If
                'Target Date to received complete BOM
                Sheets("Summary").Range("B11").ClearContents
                'Plexus Commit Ship Date
                Sheets("Summary").Range("B12").ClearContents
                'Plan Manufacturing Start Date
                Sheets("Summary").Range("B19").Value = "=WORKDAY(B4,-28)"
                'Actual Ship Date
                Sheets("Summary").Range("B23").ClearContents
                'FML
                Sheets("Summary").Range("B24").ClearContents
                'Target/Plan CTB date
                Sheets("Summary").Range("B27").Value = "=WORKDAY(B19,-5)"
                'Actual CTB date
                'Sheets("Summary").Range("B28").Value = "=IF(B37="""","""",INDIRECT(""'"" & B37 &""'!BH2""))"
                Sheets("Summary").Range("B28").Value = "=IFERROR(IF(B37="""","""",INDIRECT(""'"" & B37 &""'!BH2"")),"""")"
                'WO kitting
                Sheets("Summary").Range("B30").ClearContents
                'WO released status
                Sheets("Summary").Range("B31").ClearContents
                'WO released to store date
                Sheets("Summary").Range("B32").ClearContents
                'WO kitting status
                Sheets("Summary").Range("B33").ClearContents
                'Percentage completed
                Sheets("Summary").Range("B34").ClearContents
                'Kit material Status Updateâ€¦
                Sheets("Summary").Range("B36").Value = "=IFERROR(IF(B37="""","""",""Top 5 gated:""" _
                                                        & "& CHAR(10)&INDIRECT(""'"" & B37 &""'!$BG$2"")&""(""&TEXT(INDIRECT(""'"" & B37 &""'!$BH$2""),""m/d/yy"")&"")""" _
                                                        & "& CHAR(10)&INDIRECT(""'"" & B37 &""'!$BG$3"")&""(""&TEXT(INDIRECT(""'"" & B37 &""'!$BH$3""),""m/d/yy"")&"")""" _
                                                        & "& CHAR(10)&INDIRECT(""'"" & B37 &""'!$BG$4"")&""(""&TEXT(INDIRECT(""'"" & B37 &""'!$BH$4""),""m/d/yy"")&"")""" _
                                                        & "& CHAR(10)&INDIRECT(""'"" & B37 &""'!$BG$5"")&""(""&TEXT(INDIRECT(""'"" & B37 &""'!$BH$5""),""m/d/yy"")&"")""" _
                                                        & "& CHAR(10)&INDIRECT(""'"" & B37 &""'!$BG$6"")&""(""&TEXT(INDIRECT(""'"" & B37 &""'!$BH$6""),""m/d/yy"")&"")""),"""")"

                
                'Ver1.5: Add SO Sheetname
                'SO Sheetname
                'Sheets("Summary").Range("B37").Value = Workbooks(myMacroFile).Sheets("Macro").Cells(myA, myC + 26).Value
                Sheets("Summary").Range("B37").Value = myTempSheet
                
                Sheets("Summary").Columns("B:B").Cut
                Sheets("Summary").Cells(1, Sheets("Summary").Range("A7").End(xlToRight).Column + 1).EntireColumn.Insert
'            Next myC
            Next myB
'            End If
    Next myA
'
'    Sheets.Add Before:=Sheets(1)
'    ActiveSheet.Name = "Summary"
'    Range("A1").Value = "Details"
'    Range("B1").Value = "Assembly Number"
'    Range("C1").Value = "Tool Number"
'    Range("D1").Value = "Quantity"
'    Range("E1").Value = "CRD"
'    Range("F1").Value = "CTB"
'    Range("G1").Value = "Last Gated Part"
'    Columns("G:G").ColumnWidth = 100
'
'    Sheets(myShortageSheetname).Select
'    If Range("A1").Value = "" Then
'        Rows("1:1").Delete
'    End If
'    If Range("A1").Value = "" Then
'        Rows("1:1").Delete
'    End If
'    If Range("A1").Value <> "Site" Then
'        MsgBox "Different format detected. Please select correct file. The Macro will end here!"
'        End
'    End If
'    If ActiveSheet.AutoFilterMode = True Then
'       Rows("1:1").AutoFilter
'       Rows("1:1").AutoFilter
'    Else
'       Rows("1:1").AutoFilter
'    End If
'
'    If Range("R3").Value = "Prod. Loading (User)" Then
'        Columns("R:R").Delete
'    End If
'
'    Cells.Font.ThemeColor = xlThemeColorLight1
'    myShortage = Range("F" & Rows.Count).End(xlUp).Row
'
'    'Delete unnecessary column
'    Columns("AK:AM").Delete
'    Columns("AH:AI").Delete
'    Columns("AA:AC").Delete
'    Columns("Y:Y").Delete
'    Columns("P:V").Delete
'    Columns("L:M").Delete
'    Columns("I:J").Delete
'
'    'Delete Due date later than user enter
'    Range("Y1").Value = myDueDate
'    Range("Y2:Y" & myShortage).Value = "=IF(K2>$Y$1,""Delete"",Row(X2))"
'    Range("Y2:Y" & myShortage).Value = Range("Y2:Y" & myShortage).Value
'    Range("Y1").Value = "Delete"
'    ActiveSheet.Range("$A$1:$AC$" & myShortage).RemoveDuplicates Columns:=25, Header:=xlNo
'    myShortage = Range("F" & Rows.Count).End(xlUp).Row
'
'    Range("Y1").Value = "Parent1&Line1"
'    Range("Y2:Y" & myShortage).Value = "=F2&H2"
'    Range("Y2:Y" & myShortage).Value = Range("Y2:Y" & myShortage).Value
'    Range("Z1").Value = "Parent2&Line2"
'    Range("Z2:Z" & myShortage).Value = "=L2&N2"
'    Range("Z2:Z" & myShortage).Value = Range("Z2:Z" & myShortage).Value
'    Range("AD1").Value = "Delete"
'    Range("AB1").Value = "Delete"
'    Range("AE1").Value = "Delete"
'    Range("AI1").Value = "Tools #"
'    'Range("AF1").Value = "Grand Parent Line #"
'    'Application.ScreenUpdating = False
'    For myA = 22 To myTotalAssembly
'        Sheets(myShortageSheetname).Select
'        'ClearAllFilter
'        myAssembly = Workbooks(myMacroFile).Sheets("Macro").Range("B" & myA).Value
'        myCheck = Application.WorksheetFunction.CountIf(Columns("F:F"), myAssembly)
'        If myCheck > 0 Then
'            Range("AA2:AA" & myShortage).Value = "=IF(F2=""" & myAssembly & """,Row(Z2),""Delete"")"
'            Range("AA2:AA" & myShortage).Value = Range("AA2:AA" & myShortage).Value
'            'Remain Assembly and M part
'            Range("AD2:AD" & myShortage).Value = "=IF(AA2=""Delete"",""Delete"",IF(X2=""P"",""Delete"",Z2))"
'            Range("AD2:AD" & myShortage).Value = Range("AD2:AD" & myShortage).Value
'                'Vlookup Grand Parent
'                Range("AE2:AE" & myShortage).Value = "=IF(AA2=""Delete"",""Delete"",IF(X2=""P"",""Delete"",Y2))"
'                Range("AE2:AE" & myShortage).Value = Range("AE2:AE" & myShortage).Value
'                Range("AF2:AF" & myShortage).Value = "=IF(AA2=""Delete"",""Delete"",IF(X2=""P"",""Delete"",F2))"
'                Range("AF2:AF" & myShortage).Value = Range("AF2:AF" & myShortage).Value
'                Range("AG2:AG" & myShortage).Value = "=IF(AA2=""Delete"",""Delete"",IF(X2=""P"",""Delete"",K2))"
'                Range("AG2:AG" & myShortage).Value = Range("AG2:AG" & myShortage).Value
'                Range("AH2:AH" & myShortage).Value = "=IF(AA2=""Delete"",""Delete"",IF(X2=""P"",""Delete"",H2))"
'                Range("AH2:AH" & myShortage).Value = Range("AH2:AH" & myShortage).Value
'                Range("AI2:AI" & myShortage).Value = "=IF(AA2=""Delete"",""Delete"",IF(X2=""P"",""Delete"",I2))"
'                Range("AI2:AI" & myShortage).Value = Range("AI2:AI" & myShortage).Value
'                ActiveSheet.Range("$AE$1:$AI$" & myShortage).RemoveDuplicates Columns:=1, Header:=xlNo
'                Range("AH2:AH" & Range("AF" & Rows.Count).End(xlUp).Row).Value = "=AF2&AG2&AI2&COUNTIFS($AF$1:AF2,AF2,$AG$1:AG2,AG2)"
'                Range("AH2:AH" & Range("AF" & Rows.Count).End(xlUp).Row).Value = Range("AH2:AH" & Range("AF" & Rows.Count).End(xlUp).Row).Value
'                Range("AI2:AI" & myShortage).Value = "=IF(AA2=""Delete"","""",IFERROR(VLOOKUP(VLOOKUP(Y2,AE:AI,4,0),'[" & Replace(myCfFilename, "'", "''") & "]Temp'!$A:$D,4,0),F2&""_""&TEXT(K2,""Dd-Mmm-Yy"")))"
'                Range("AI2:AI" & myShortage).Value = Range("AI2:AI" & myShortage).Value
'                    'Remain only Tool Number to be vlookup
'                    Range("AM1").Value = "Tools number only"
'                    Range("AM2:AM" & myShortage).Value = "=IF(AI2="""",""Tools number only"",Row(AI2))"
'                    Range("AM2:AM" & myShortage).Value = Range("AM2:AM" & myShortage).Value
'                    Range("AN1:AN" & myShortage).Value = Range("Z1:Z" & myShortage).Value
'                    Range("AO1:AO" & myShortage).Value = Range("AI1:AI" & myShortage).Value
'                    ActiveSheet.Range("$AM$1:$AO$" & myShortage).RemoveDuplicates Columns:=1, Header:=xlNo
'            ActiveSheet.Range("$AD$1:$AD$" & myShortage).RemoveDuplicates Columns:=1, Header:=xlNo
'            myTempResult = Range("AD" & Rows.Count).End(xlUp).Row
'            Range("AB2:AB" & myShortage).Value = "=IF(IFERROR(VLOOKUP(Y2,$AD$2:$AD$" & myTempResult & ",1,0),""Delete"")=""Delete"",""Delete"",ROW(Z2))"
'            Range("AB2:AB" & myShortage).Value = Range("AB2:AB" & myShortage).Value
'            myTotalDelete = Application.WorksheetFunction.CountIf(Columns("AB:AB"), "Delete")
'                'Vlookup Grand Parent
'                Range("AJ2:AJ" & myShortage).Value = "=IF(AB2=""Delete"",IF(AI2="""","""",AI2),VLOOKUP(F2&H2,AN:AO,2,0))"
'                Range("AJ2:AJ" & myShortage).Value = Range("AJ2:AJ" & myShortage).Value
'                Range("AI2:AI" & myShortage).Value = Range("AJ2:AJ" & myShortage).Value
'
'            Do Until myTotalDelete = myShortage
'                'Remain only Tool Number to be vlookup
'                Range("AM1").Value = "Tools number only"
'                Range("AM2:AM" & myShortage).Value = "=IF(AI2="""",""Tools number only"",Row(AI2))"
'                Range("AM2:AM" & myShortage).Value = Range("AM2:AM" & myShortage).Value
'                Range("AN1:AN" & myShortage).Value = Range("Z1:Z" & myShortage).Value
'                Range("AO1:AO" & myShortage).Value = Range("AI1:AI" & myShortage).Value
'                ActiveSheet.Range("$AM$1:$AO$" & myShortage).RemoveDuplicates Columns:=1, Header:=xlNo
'
'                Range("AD2:AD" & myShortage).Value = "=IF(AB2=""Delete"",""Delete"",IF(X2=""P"",""Delete"",Z2))"
'                Range("AD2:AD" & myShortage).Value = Range("AD2:AD" & myShortage).Value
'                ActiveSheet.Range("$AD$1:$AD$" & myShortage).RemoveDuplicates Columns:=1, Header:=xlNo
'                myTempResult = Range("AD" & Rows.Count).End(xlUp).Row
'
'                If myTempResult = 1 Then Exit Do
'
'                Range("AC2:AC" & myShortage).Value = "=IF(AA2=""Delete"",AB2,AA2)"
'                Range("AC2:AC" & myShortage).Value = Range("AC2:AC" & myShortage).Value
'                Range("AA2:AA" & myShortage).Value = Range("AC2:AC" & myShortage).Value
'
'                Range("AB2:AB" & myShortage).Value = "=IF(IFERROR(VLOOKUP(Y2,$AD$2:$AD$" & myTempResult & ",1,0),""Delete"")=""Delete"",""Delete"",ROW(Z2))"
'                Range("AB2:AB" & myShortage).Value = Range("AB2:AB" & myShortage).Value
'                myTotalDelete = Application.WorksheetFunction.CountIf(Columns("AB:AB"), "Delete")
'                'Vlookup Grand Parent
'                Range("AJ2:AJ" & myShortage).Value = "=IF(AB2=""Delete"",IF(AI2="""","""",AI2),VLOOKUP(F2&H2,AN:AO,2,0))"
'                Range("AJ2:AJ" & myShortage).Value = Range("AJ2:AJ" & myShortage).Value
'                Range("AI2:AI" & myShortage).Value = Range("AJ2:AJ" & myShortage).Value
'
'
'            Loop
'            Sheets(myShortageSheetname).Copy After:=Sheets(myShortageSheetIndex)
'            ActiveSheet.Name = myAssembly
'            Range("AB2:AB" & myShortage).Value = "=IF(AA2=""Delete"",""Delete"",IF(X2=""P"",Row(AA2),""Delete""))"
'            Range("AB2:AB" & myShortage).Value = Range("AB2:AB" & myShortage).Value
'            ActiveSheet.Range("$A$1:$AO$" & myShortage).RemoveDuplicates Columns:=28, Header:=xlNo
'            Range("E1:E" & myShortage).Value = Range("AI1:AI" & myShortage).Value
'
'            Columns("A:D").Delete
'
'            myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
'            Columns("C:C").Insert
'            Range("C1").Value = "Priority"
'            Range("C2:C" & myTempTotal).Value = "=VLOOKUP(B2,'[" & myMacroFile & "]Priority'!$A:$B,2,0)"
'            Range("C2:C" & myTempTotal).Value = Range("C2:C" & myTempTotal).Value
'            'Columns("A:A").Insert
'            'Range("B1").Copy Range("A1")
'            'Range("A1").Value = "Tool Number"
'            'If myCfFile <> "" Then
'            '    Range("A2:A" & myTempTotal).Value = "=VLOOKUP(B2&G2,'[" & Replace(myCfFilename, "'", "''") & "]Temp'!$A:$D,4,0)"
'            '    Range("A2:A" & myTempTotal).Value = Range("A2:A" & myTempTotal).Value
'            'End If
'
'            'Range("U2:U" & myTempTotal).Value = "=SUMIFS(O:O,I:I,I2,K:K,K2)"
'            'Range("U2:U" & myTempTotal).Value = Range("U2:U" & myTempTotal).Value
'            'Range("O2:O" & myTempTotal).Value = Range("U2:U" & myTempTotal).Value
'            'Range("U2:U" & myTempTotal).ClearContents
'            'ActiveSheet.Range("$A$1:$T$" & myTempTotal).RemoveDuplicates Columns:=Array(9, 11), Header:=xlYes
'            myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
'            Columns("A:U").AutoFit
'            Workbooks(myMacroFile).Sheets("Macro").Range("C" & myA).Value = "Done"
'                '
'                Range("AG1:AG" & myTempTotal).Value = Range("I1:I" & myTempTotal).Value
'                Range("AH1:AH" & myTempTotal).Value = Range("P1:P" & myTempTotal).Value
'                ActiveWorkbook.Worksheets(myAssembly).Sort.SortFields.Clear
'                ActiveWorkbook.Worksheets(myAssembly).Sort.SortFields.Add Key:=Range("AF2:AF" & myTempTotal), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
'                ActiveWorkbook.Worksheets(myAssembly).Sort.SortFields.Add Key:=Range("AH2:AH" & myTempTotal), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
'                ActiveWorkbook.Worksheets(myAssembly).Sort.SetRange Range("AF1:AH" & myTempTotal)
'                ActiveWorkbook.Worksheets(myAssembly).Sort.Header = xlYes
'                ActiveWorkbook.Worksheets(myAssembly).Sort.MatchCase = False
'                ActiveWorkbook.Worksheets(myAssembly).Sort.Orientation = xlTopToBottom
'                ActiveWorkbook.Worksheets(myAssembly).Sort.SortMethod = xlPinYin
'                ActiveWorkbook.Worksheets(myAssembly).Sort.Apply
'                Range("AI2:AI" & myTempTotal).Value = "=IF(AF2=AF1,AI1+1,1)"
'                Range("AI2:AI" & myTempTotal).Value = Range("AI2:AI" & myTempTotal).Value
'                Range("AJ2:AJ" & myTempTotal).Value = "=IF(AI2>5,""Delete"",ROW(AF2))"
'                Range("AJ2:AJ" & myTempTotal).Value = Range("AJ2:AJ" & myTempTotal).Value
'                Range("AJ1").Value = "Delete"
'                ActiveSheet.Range("$AF$1:$AJ$" & myShortage).RemoveDuplicates Columns:=5, Header:=xlNo
'            Rows("1:1").Insert
'            ActiveSheet.Hyperlinks.Add Anchor:=Range("A1"), Address:="", SubAddress:="'Summary'!A1", TextToDisplay:="Summary"
'            myTotalSummary = Range("AF" & Rows.Count).End(xlUp).Row
'            For myCntX = 3 To myTotalSummary
'                myLastSummaryRow = Sheets("Summary").Range("A" & Rows.Count).End(xlUp).Row + 1
'
'                Sheets("Summary").Hyperlinks.Add Anchor:=Sheets("Summary").Range("A" & myLastSummaryRow), Address:="", SubAddress:="'" & myAssembly & "'!A1", TextToDisplay:="Details"
'                Sheets("Summary").Range("B" & myLastSummaryRow).Value = myAssembly
'                Sheets("Summary").Range("C" & myLastSummaryRow).Value = Range("AF" & myCntX).Value
'                Sheets("Summary").Range("D" & myLastSummaryRow).Value = "=VLOOKUP(C" & myLastSummaryRow & ",'[" & Replace(myCfFilename, "'", "''") & "]Temp'!$D:$G,4,0)"
'                Sheets("Summary").Range("D" & myLastSummaryRow).Value = Sheets("Summary").Range("D" & myLastSummaryRow).Value
'                Sheets("Summary").Range("E" & myLastSummaryRow).Value = "=VLOOKUP(C" & myLastSummaryRow & ",'[" & Replace(myCfFilename, "'", "''") & "]Temp'!$D:$H,5,0)"
'                Sheets("Summary").Range("E" & myLastSummaryRow).Value = Sheets("Summary").Range("E" & myLastSummaryRow).Value
'                Sheets("Summary").Range("F" & myLastSummaryRow).Value = Range("AH" & myCntX).Value
'                myGatedPart = ""
'                For myCntY = 1 To 5
'                    myGatedPart = myGatedPart & Range("AG" & myCntX + myCntY - 1).Value & "(" & Format(Range("AH" & myCntX + myCntY - 1).Value, "M/D/YY") & ")," & Chr(10)
'                    If Range("AF" & myCntX + myCntY - 1).Value <> Range("AF" & myCntX + myCntY).Value Then
'                        Exit For
'                    End If
'                Next myCntY
'                myCntX = myCntX + myCntY - 1
'                Sheets("Summary").Range("G" & myLastSummaryRow).Value = Left(myGatedPart, Len(myGatedPart) - 2)
'            Next myCntX
'            Columns("V:AO").Delete
'            Range("A2").Select
'        Else
'            Workbooks(myMacroFile).Sheets("Macro").Range("C" & myA).Value = "Clean"
'        End If
'    Next myA
'    'Application.ScreenUpdating = True
'
'    Sheets("Summary").Select
'    myTotalSummary = Range("A" & Rows.Count).End(xlUp).Row
'    Range("A1:G" & myTotalSummary).Select
'    With Selection
'        .HorizontalAlignment = xlGeneral
'        .VerticalAlignment = xlTop
'        .Orientation = 0
'        .AddIndent = False
'        .IndentLevel = 0
'        .ShrinkToFit = False
'        .ReadingOrder = xlContext
'        .MergeCells = False
'    End With
'    With Selection.Borders(xlEdgeLeft)
'        .LineStyle = xlContinuous
'        .ColorIndex = 0
'        .TintAndShade = 0
'        .Weight = xlThin
'    End With
'    With Selection.Borders(xlEdgeTop)
'        .LineStyle = xlContinuous
'        .ColorIndex = 0
'        .TintAndShade = 0
'        .Weight = xlThin
'    End With
'    With Selection.Borders(xlEdgeBottom)
'        .LineStyle = xlContinuous
'        .ColorIndex = 0
'        .TintAndShade = 0
'        .Weight = xlThin
'    End With
'    With Selection.Borders(xlEdgeRight)
'        .LineStyle = xlContinuous
'        .ColorIndex = 0
'        .TintAndShade = 0
'        .Weight = xlThin
'    End With
'    With Selection.Borders(xlInsideVertical)
'        .LineStyle = xlContinuous
'        .ColorIndex = 0
'        .TintAndShade = 0
'        .Weight = xlThin
'    End With
'    With Selection.Borders(xlInsideHorizontal)
'        .LineStyle = xlContinuous
'        .ColorIndex = 0
'        .TintAndShade = 0
'        .Weight = xlThin
'    End With
'    Columns("G:G").EntireColumn.AutoFit
'    Columns("E:F").NumberFormat = "m/d/yyyy"
'    Columns("C:C").Select
'    With Selection
'        .HorizontalAlignment = xlLeft
'        .WrapText = False
'        .Orientation = 0
'        .AddIndent = False
'        .IndentLevel = 0
'        .ShrinkToFit = False
'        .ReadingOrder = xlContext
'        .MergeCells = False
'    End With
'    Columns("A:G").EntireColumn.AutoFit
    Application.DisplayAlerts = False
    Sheets("Temp").Delete
    Application.DisplayAlerts = True
    If myCfFile <> "" Then
        Workbooks(myCfFilename).Close False
    End If
    Sheets("Summary").Select
    myLastColumn = Cells(3, Columns.Count).End(xlToLeft).Column
    Cells(3, myLastColumn + 1).EntireColumn.Delete
    Range(Cells(1, 1), Cells(1, myLastColumn)).EntireColumn.AutoFit
    myEndTime = Time
    MsgBox "Done in " & Format(myEndTime - myStrTime, "hh:mm:ss")
End Sub
Sub ClearAllFilter()
    On Error Resume Next
    ActiveSheet.ShowAllData
End Sub
Sub PivotBucket()
    On Error GoTo Err1
    Application.DisplayAlerts = False
        Sheets("Details").Delete
    Application.DisplayAlerts = True
    Sheets("Temp").Name = "Details"
    Set mySearchValue = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
    If mySearchValue Is Nothing Then

    Else
        mySearchValue = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
        myBlankCheck = Application.WorksheetFunction.CountBlank(Range(Cells(4, 1), Cells(4, mySearchValue)))
        If myBlankCheck > 1 Then
            Range(Cells(4, 1), Cells(4, mySearchValue)).SpecialCells(xlCellTypeBlanks).EntireColumn.Delete
            myLastCol = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
        End If
        myLastCol = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
        myTempPivot = Range("B" & Rows.Count).End(xlUp).Row
        Sheets.Add
        ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:="Details!R4C1:R" & myTempPivot & "C" & myLastCol, Version:=xlPivotTableVersion15).CreatePivotTable TableDestination:=ActiveSheet.Name & "!R3C1", TableName:="PivotTable1"
        Cells(3, 1).Select
        With ActiveSheet.PivotTables("PivotTable1").PivotFields("MPF")
            .Orientation = xlRowField
            .Position = 1
        End With
        With ActiveSheet.PivotTables("PivotTable1").PivotFields("LT")
            .Orientation = xlPageField
            .Position = 1
        End With
        With ActiveSheet.PivotTables("PivotTable1").PivotFields("Type")
            .Orientation = xlColumnField
            .Position = 1
        End With
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").PivotItems("830G").Position = 1
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").PivotItems("830O").Position = 2
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").PivotItems("(blank)").Position = 3
        Range("B4:D4").Group
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type2").PivotItems("Group1").Caption = "Discrete"
        myLastPivotCol = Cells.SpecialCells(xlCellTypeLastCell).Column - 1
        Range(Cells(5, 5), Cells(5, myLastPivotCol)).Group
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type2").PivotItems("Group2").Caption = "SCM"
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").Orientation = xlHidden
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket1 Shortages $$"), "Sum of Bucket1 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket2 Shortages $$"), "Sum of Bucket2 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket3 Shortages $$"), "Sum of Bucket3 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket4 Shortages $$"), "Sum of Bucket4 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket5 Shortages $$"), "Sum of Bucket5 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket6 Shortages $$"), "Sum of Bucket6 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket7 Shortages $$"), "Sum of Bucket7 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket8 Shortages $$"), "Sum of Bucket8 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket9 Shortages $$"), "Sum of Bucket9 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket10 Shortages $$"), "Sum of Bucket10 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket11 Shortages $$"), "Sum of Bucket11 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket12 Shortages $$"), "Sum of Bucket12 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket13 Shortages $$"), "Sum of Bucket13 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket14 Shortages $$"), "Sum of Bucket14 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket15 Shortages $$"), "Sum of Bucket15 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket16 Shortages $$"), "Sum of Bucket16 Shortages $$", xlSum
        With ActiveSheet.PivotTables("PivotTable1").DataPivotField
            .Orientation = xlColumnField
            .Position = 1
        End With
        Range("B6").Select
        Range(Selection, Selection.End(xlToRight)).Select
        Range(Selection, Selection.End(xlDown)).Select
        Selection.Style = "Currency"
        Selection.NumberFormat = "_($* #,##0_);_($* (#,##0);_($* ""-""??_);_(@_)"
        ActiveSheet.Name = "PV"
        Rows("4:4").RowHeight = 52.5
        Selection.ColumnWidth = 10.67
        Rows("4:4").WrapText = True
        Selection.EntireColumn.AutoFit
        Rows("4:4").EntireRow.AutoFit
        Sheets("Details").Select
    End If
Err1:
End Sub
Sub InventoryProjection1a()
    Workbooks(myProjectedInvFilename).Activate
    Range(Range("CC3"), Range("CC3").End(xlDown).Offset(-1, 0)).Select
    Range(Selection, Selection.End(xlToRight)).Select
        'Ver1.3: Change Sheetname
        'Selection.Value = "=VLOOKUP(TEXT($C3,""000""),'[" & mySalesOnlyFilename & "]My Sales'!$A:$AAB,MATCH(TEXT(CC$2,""Mmm Yy"")&""Total Net Sales excluding Unbilled"",'[" & mySalesOnlyFilename & "]My Sales'!$1:$1,0),0)"
        Selection.Value = "=VLOOKUP(TEXT($C3,""000""),'[" & mySalesOnlyFilename & "]" & mySalesOnlySheetname & "'!$A:$AAB,MATCH(TEXT(CC$2,""Mmm Yy"")&""Total Net Sales excluding Unbilled"",'[" & mySalesOnlyFilename & "]" & mySalesOnlySheetname & "'!$1:$1,0),0)"
    Selection.Value = Selection.Value
    Cells.Find(What:="Material Cost %", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    myStartRow = Selection.End(xlDown).Row
        'Add platform to vlookup
        Sheets("Mat. Cost Calc.").Columns("B:B").Insert
        myLastMatCostCalcTotal = Sheets("Mat. Cost Calc.").Range("A" & Rows.Count).End(xlUp).Row
        Sheets("Mat. Cost Calc.").Range("B1:B" & myLastMatCostCalcTotal).Value = "=Left(Right(A1,4),3)"
    Range("CC" & myStartRow).Select
    Range(Selection, Selection.End(xlDown).Offset(-1, 0)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.Value = "=VLOOKUP(TEXT($C" & myStartRow & ",""000""),'Mat. Cost Calc.'!$B:$AAB,MATCH(""Mat. Cost %"" & TEXT(CC$" & myStartRow - 1 & ",""Mmm Yy""),'Mat. Cost Calc.'!$2:$2,0)-1,0)"
    Selection.Value = Selection.Value
        'Delete column
        Sheets("Mat. Cost Calc.").Columns("B:B").Delete
    
    Workbooks(myCurrentVsBaseFilename).Sheets("Temp").Columns("B:B").Insert
    myLastCurrentVsBase = Workbooks(myCurrentVsBaseFilename).Sheets("Temp").Range("A" & Rows.Count).End(xlUp).Row
    Workbooks(myCurrentVsBaseFilename).Sheets("Temp").Range("B1:B" & myLastCurrentVsBase).Value = "=Left(Right(A1,4),3)"
    
    Sheets("Inventory Projection").Select
    myTotalInvProjection = Range("A" & Rows.Count).End(xlUp).Row - 1

    Range("E1").Value = Date
    Range("E3:I" & myTotalInvProjection).ClearContents
    
    Range("G1").Value = "'" & myInvMth1
    Range("R3:R" & myTotalInvProjection).ClearContents
    Range("V3:V" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("V3:V" & myTotalInvProjection).Value = Range("V3:V" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("S:S"), 0)
    Range("T" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob1 = "" Then
        myInvMthFob1 = 0
    End If
    Range("T" & myPpvOtherRow).Value = Range("T" & myPpvOtherRow).Value - myInvMthFob1
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("S:S"), 0)
    Range("T" & myFobRow).Value = myInvMthFob1
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("S:S"), 0)
    Range("U" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("U" & myEstimatedPlantRow).Value = Range("U" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("S:S"), 0)
    Range("T" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("T" & myTargetRow).Value = Range("T" & myTargetRow).Value
    
    Range("X1").Value = "'" & myInvMth2
    Range("X3:X" & myTotalInvProjection).ClearContents
    Range("AN3:AN" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("AN3:AN" & myTotalInvProjection).Value = Range("AN3:AN" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("AK:AK"), 0)
    Range("AL" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob2 = "" Then
        myInvMthFob2 = 0
    End If
    Range("AL" & myPpvOtherRow).Value = Range("AL" & myPpvOtherRow).Value - myInvMthFob2
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("AK:AK"), 0)
    Range("AL" & myFobRow).Value = myInvMthFob2
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("AK:AK"), 0)
    Range("AM" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("AM" & myEstimatedPlantRow).Value = Range("AM" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("AK:AK"), 0)
    Range("AL" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("AL" & myTargetRow).Value = Range("AL" & myTargetRow).Value
    
    Range("AP1").Value = "'" & myInvMth3
    Range("AP3:AR" & myTotalInvProjection).ClearContents
    Range("BF3:BF" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BF3:BF" & myTotalInvProjection).Value = Range("BF3:BF" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("BC:BC"), 0)
    Range("BD" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob3 = "" Then
        myInvMthFob3 = 0
    End If
    Range("BD" & myPpvOtherRow).Value = Range("BD" & myPpvOtherRow).Value - myInvMthFob3
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("BC:BC"), 0)
    Range("BD" & myFobRow).Value = myInvMthFob3
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("BC:BC"), 0)
    Range("BE" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BE" & myEstimatedPlantRow).Value = Range("BE" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("BC:BC"), 0)
    Range("BD" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BD" & myTargetRow).Value = Range("BD" & myTargetRow).Value
    
    Range("BI1").Value = "'" & myInvMth4
    Range("BI3:BK" & myTotalInvProjection).ClearContents
    Range("BY3:BY" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BY3:BY" & myTotalInvProjection).Value = Range("BY3:BY" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("BV:BV"), 0)
    Range("BW" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob4 = "" Then
        myInvMthFob4 = 0
    End If
    Range("BW" & myPpvOtherRow).Value = Range("BW" & myPpvOtherRow).Value - myInvMthFob4
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("BV:BV"), 0)
    Range("BW" & myFobRow).Value = myInvMthFob4
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("BV:BV"), 0)
    Range("BX" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BX" & myEstimatedPlantRow).Value = Range("BX" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("BV:BV"), 0)
    Range("BW" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BW" & myTargetRow).Value = Range("BW" & myTargetRow).Value
    
    Range("CA1").Value = "'" & myInvMth5
    Range("CA3:CC" & myTotalInvProjection).ClearContents
    If myInvMth5 = "" Then
        Range("CF3:CF" & myTotalInvProjection).ClearContents
        Range("CF3:CF" & myTotalInvProjection).ClearComments
        Range("CJ3:CL" & myTotalInvProjection).ClearContents
        Range("CJ3:CL" & myTotalInvProjection).ClearComments
        Range("CO3:CO" & myTotalInvProjection).ClearContents
        Range("CQ3:CQ" & myTotalInvProjection).ClearContents
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("CN:CN"), 0)
        Range("CO" & myPpvOtherRow).Value = ""
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("CN:CN"), 0)
        Range("CO" & myFobRow).Value = ""
        Range("CP" & myEstimatedPlantRow).Value = ""
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("CN:CN"), 0)
        Range("CO" & myTargetRow).Value = ""
        Columns("CA:CR").Hidden = True
    Else
        Columns("CA:CR").Hidden = False
        Columns("CD:CE").Hidden = True
        Range("CQ3:CQ" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("CQ3:CQ" & myTotalInvProjection).Value = Range("CQ3:CQ" & myTotalInvProjection).Value
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("CN:CN"), 0)
        Range("CO" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        If myInvMthFob5 = "" Then
            myInvMthFob5 = 0
        End If
        Range("CO" & myPpvOtherRow).Value = Range("CO" & myPpvOtherRow).Value - myInvMthFob5
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("CN:CN"), 0)
        Range("CO" & myFobRow).Value = myInvMthFob5
        myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("CN:CN"), 0)
        Range("CP" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("CP" & myEstimatedPlantRow).Value = Range("CP" & myEstimatedPlantRow).Value
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("CN:CN"), 0)
        Range("CO" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("CO" & myTargetRow).Value = Range("CO" & myTargetRow).Value
        If Range("CO3").Value <> "" Then
            Range("CO3:CO" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP($B3,INDIRECT(""COGS!C""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":$XFD$1000000""),MATCH(DATEVALUE(""1 ""&CA$1),INDIRECT(""COGS!""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":""&MATCH(""After Adjustment"",COGS!$B:$B,0)),0)-2,0),"""")"
        End If
    End If
        
    Range("CS1").Value = "'" & myInvMth6
    Range("CS3:CU" & myTotalInvProjection).ClearContents
    If myInvMth6 = "" Then
        Range("CW3:CW" & myTotalInvProjection).ClearContents
        Range("CW3:CW" & myTotalInvProjection).ClearComments
        Range("CY3:CY" & myTotalInvProjection).ClearContents
        Range("CY3:CY" & myTotalInvProjection).ClearComments
        Range("DD3:DD" & myTotalInvProjection).ClearContents
        Range("DF3:DF" & myTotalInvProjection).ClearContents
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("DC:DC"), 0)
        Range("DD" & myPpvOtherRow).Value = ""
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("DC:DC"), 0)
        Range("DD" & myFobRow).Value = ""
        Range("DE" & myEstimatedPlantRow).Value = ""
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("DC:DC"), 0)
        Range("DD" & myTargetRow).Value = ""
        Columns("CS:DG").Hidden = True
    Else
        Columns("CS:DG").Hidden = False
        Columns("CV:CV").Hidden = True
        Range("DF3:DF" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("DF3:DF" & myTotalInvProjection).Value = Range("DF3:DF" & myTotalInvProjection).Value
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("DC:DC"), 0)
        Range("DD" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        If myInvMthFob6 = "" Then
            myInvMthFob6 = 0
        End If
        Range("DD" & myPpvOtherRow).Value = Range("DD" & myPpvOtherRow).Value - myInvMthFob6
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("DC:DC"), 0)
        Range("DD" & myFobRow).Value = myInvMthFob6
        myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("DC:DC"), 0)
        Range("DE" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("DE" & myEstimatedPlantRow).Value = Range("DE" & myEstimatedPlantRow).Value
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("DC:DC"), 0)
        Range("DD" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("DD" & myTargetRow).Value = Range("DD" & myTargetRow).Value
        If Range("DD3").Value <> "" Then
            Range("DD3:DD" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP($B3,INDIRECT(""COGS!C""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":$XFD$1000000""),MATCH(DATEVALUE(""1 ""&CS$1),INDIRECT(""COGS!""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":""&MATCH(""After Adjustment"",COGS!$B:$B,0)),0)-2,0),"""")"
        End If
    End If
  
    Range("DH1").Value = myInvQtr1
    Range("DH3:DJ" & myTotalInvProjection).ClearContents
    Range("DU3:DU" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DU3:DU" & myTotalInvProjection).Value = Range("DU3:DU" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("DR:DR"), 0)
    'Range("DS" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DS" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("DS" & myPpvOtherRow).Value = Range("DS" & myPpvOtherRow).Value - myInvQtrFob1
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("DR:DR"), 0)
    Range("DS" & myFobRow).Value = myInvQtrFob1
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("DR:DR"), 0)
    Range("DT" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DT" & myEstimatedPlantRow).Value = Range("DT" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("DR:DR"), 0)
    Range("DS" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DS" & myTargetRow).Value = Range("DS" & myTargetRow).Value

    Range("DW1").Value = myInvQtr2
    Range("DW3:DY" & myTotalInvProjection).ClearContents
    Range("EJ3:EJ" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EJ3:EJ" & myTotalInvProjection).Value = Range("EJ3:EJ" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("EG:EG"), 0)
    'Range("EH" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EH" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("EH" & myPpvOtherRow).Value = Range("EH" & myPpvOtherRow).Value - myInvQtrFob2
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("EG:EG"), 0)
    Range("EH" & myFobRow).Value = myInvQtrFob2
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("EG:EG"), 0)
    Range("EI" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EI" & myEstimatedPlantRow).Value = Range("EI" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("EG:EG"), 0)
    Range("EH" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EH" & myTargetRow).Value = Range("EH" & myTargetRow).Value

    Range("EL1").Value = myInvQtr3
    Range("EL3:EN" & myTotalInvProjection).ClearContents
    Range("EY3:EY" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EY3:EY" & myTotalInvProjection).Value = Range("EY3:EY" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("EV:EV"), 0)
    'Range("EW" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EW" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("EW" & myPpvOtherRow).Value = Range("EW" & myPpvOtherRow).Value - myInvQtyFob3
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("EV:EV"), 0)
    Range("EW" & myFobRow).Value = myInvQtyFob3
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("EV:EV"), 0)
    Range("EX" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EX" & myEstimatedPlantRow).Value = Range("EX" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("EV:EV"), 0)
    Range("EW" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EW" & myTargetRow).Value = Range("EW" & myTargetRow).Value
    
    Range("FA1").Value = myInvQtr4
    Range("FA3:FC" & myTotalInvProjection).ClearContents
    Range("FN3:FN" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FN3:FN" & myTotalInvProjection).Value = Range("FN3:FN" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("FK:FK"), 0)
    'Range("FL" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FL" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("FL" & myPpvOtherRow).Value = Range("FL" & myPpvOtherRow).Value - myInvQtyFob4
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("FK:FK"), 0)
    Range("FL" & myFobRow).Value = myInvQtyFob4
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("FK:FK"), 0)
    Range("FM" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FM" & myEstimatedPlantRow).Value = Range("FM" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("FK:FK"), 0)
    Range("FL" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FL" & myTargetRow).Value = Range("FL" & myTargetRow).Value

    'Total Inventory(07)
    Range("E3:E" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP(B3,'[" & myWipInventoryFilename & "]PV'!$A:$B,2,0),0)+IFERROR(VLOOKUP(B3,'[" & myRawMaterialFilename & "]Summary'!$A:$F,5,0),0)"
    Range("E3:E" & myTotalInvProjection).Value = Range("E3:E" & myTotalInvProjection).Value
    
    'Total Shipped
    Range("R3:R" & myTotalInvProjection).Value = "=VLOOKUP(B3,'[" & mySrsFilename & "]Summary'!$C:$G,5,0)"
    Range("R3:R" & myTotalInvProjection).Value = Range("R3:R" & myTotalInvProjection).Value
    
    'Projected PO
    'Month
    Range("G3:G" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("G3:G" & myTotalInvProjection).Value = Range("G3:G" & myTotalInvProjection).Value
    Range("X3:X" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("X3:X" & myTotalInvProjection).Value = Range("X3:X" & myTotalInvProjection).Value
    Range("AP3:AP" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("AP3:AP" & myTotalInvProjection).Value = Range("AP3:AP" & myTotalInvProjection).Value
    Range("BI3:BI" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth4, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("BI3:BI" & myTotalInvProjection).Value = Range("BI3:BI" & myTotalInvProjection).Value
    Range("CA3:CA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth5, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CA3:CA" & myTotalInvProjection).Value = Range("CA3:CA" & myTotalInvProjection).Value
    Range("CS3:CS" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth6, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CS3:CS" & myTotalInvProjection).Value = Range("CS3:CS" & myTotalInvProjection).Value
    
    'Quarter1
    If myQtr1_1 <> "" Then
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
    End If
    If myQtr1_2 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
    End If
    If myQtr1_3 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
    End If
    'Quarter2
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
        Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DX3:DX" & myTotalInvProjection).ClearContents
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
        Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DX3:DX" & myTotalInvProjection).ClearContents
    'Quarter3
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
        Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EM3:EM" & myTotalInvProjection).ClearContents
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
        Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EM3:EM" & myTotalInvProjection).ClearContents
    'Quarter4
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+FB3"
        Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        Range("FB3:FB" & myTotalInvProjection).ClearContents
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        'Ver1.5: Refer to wrong cells
        'Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+BF3"
        Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+FB3"
        Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        Range("FB3:FB" & myTotalInvProjection).ClearContents
    
    'Planned Discrete Order & Planned SCM Order (myWeekRemain)
    'Ver1.4: Change logic from Leadtime + today's date to just consider leadtime only
'    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'
'    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
'    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1)-$H3"
'    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
'    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
'    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1)-$Y3"
'    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
'    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
'    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1)-$AQ3"
'    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
'    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
'    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1)-$BJ3"
'    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
'    If myInvMth5 = "" Then
'        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BG:BN").Insert
'        Columns("CA:CR").Hidden = True
'    Else
'        Columns("CA:CR").Hidden = False
'        Columns("CD:CD").Hidden = True
'        Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
'    End If
'    If myInvMth6 = "" Then
'        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BO:BV").Insert
'        Columns("CS:DG").Hidden = True
'    Else
'        Columns("CS:DG").Hidden = False
'        Columns("CV:CV").Hidden = True
'        Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1)-$CB3"
'        Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
'        Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
'        Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1)-$CT3"
'        Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
'    End If
'    'Qtr1
'    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
'    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ") & """)-$DI3"
'    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
'    'Qtr2
'    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
'    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """)-$DX3"
'    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
'    'Qtr3
'    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
'    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """)-$EM3"
'    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
'    'Qtr4
'    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
'    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """)-$FB3"
'    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
    myWeekRemain = myWeekRemain * 7
    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$H3"
    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
    If Month("1 " & myInvMth2) / 3 - Int(Month("1 " & myInvMth2) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$Y3"
    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
    If Month("1 " & myInvMth3) / 3 - Int(Month("1 " & myInvMth3) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$AQ3"
    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
    If Month("1 " & myInvMth4) / 3 - Int(Month("1 " & myInvMth4) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$BJ3"
    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
    If myInvMth5 = "" Then
        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BG:BN").Insert
        Columns("CA:CR").Hidden = True
    Else
        If Month("1 " & myInvMth5) / 3 - Int(Month("1 " & myInvMth5) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Columns("CA:CR").Hidden = False
        Columns("CD:CD").Hidden = True
        Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
        Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CB3"
        Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
    End If
    
    If myInvMth6 = "" Then
        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BO:BV").Insert
        Columns("CS:DG").Hidden = True
    Else
        If Month("1 " & myInvMth6) / 3 - Int(Month("1 " & myInvMth6) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Columns("CS:DG").Hidden = False
        Columns("CV:CV").Hidden = True
        Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
        Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CT3"
        Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
    End If
    'Qtr1
    myWeekRemain = myWeekRemain + 91
    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DI3"
    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
    'Qtr2
    myWeekRemain = myWeekRemain + 91
    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DX3"
    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
    'Qtr3
    myWeekRemain = myWeekRemain + 91
    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$EM3"
    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
    'Qtr4
    myWeekRemain = myWeekRemain + 91
    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$FB3"
    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
End Sub
Sub InvertoryProjection2()
    Sheets("Inv Proj (Product)").Select
    myTotalInvProjection = Range("B2").End(xlDown).Row
    myTotalInvProjectionStr1 = Range("B" & myTotalInvProjection + 2).End(xlDown).Row + 1
    myTotalInvProjectionEnd1 = Range("B" & myTotalInvProjectionStr1).End(xlDown).Row

    Range("E1").Value = Date
    Range("E" & myTotalInvProjectionStr1 - 2).Value = Date
    Range("E3:I" & myTotalInvProjection).ClearContents
    Range("E" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).ClearContents
    
    Range("G1").Value = "'" & myInvMth1
    Range("R3:R" & myTotalInvProjection).ClearContents
    Range("G" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth1
    Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).ClearContents
    
    Range("X1").Value = "'" & myInvMth2
    Range("X3:X" & myTotalInvProjection).ClearContents
    Range("X" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth2
    Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).ClearContents
        
    Range("AP1").Value = "'" & myInvMth3
    Range("AP3:AR" & myTotalInvProjection).ClearContents
    Range("AP" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth3
    Range("AP" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).ClearContents
    
    Range("BI1").Value = "'" & myInvMth4
    Range("BI3:BK" & myTotalInvProjection).ClearContents
    Range("BI" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth4
    Range("BI" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).ClearContents
    
    Range("CA1").Value = "'" & myInvMth5
    Range("CA3:CC" & myTotalInvProjection).ClearContents
    Range("CA" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth5
    Range("CA" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).ClearContents
    If myInvMth5 = "" Then
        Columns("CA:CR").Hidden = True
    Else
        Columns("CA:CR").Hidden = False
        Columns("CD:CE").Hidden = True
    End If
        
    Range("CS1").Value = "'" & myInvMth6
    Range("CS3:CU" & myTotalInvProjection).ClearContents
    Range("CS" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth6
    Range("CS" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).ClearContents
    If myInvMth6 = "" Then
        Columns("CS:DG").Hidden = True
    Else
        Columns("CS:DG").Hidden = False
        Columns("CV:CV").Hidden = True
    End If
  
    Range("DH1").Value = myInvQtr1
    Range("DH3:DJ" & myTotalInvProjection).ClearContents
    Range("DH" & myTotalInvProjectionStr1 - 2).Value = myInvQtr1
    Range("DH" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).ClearContents

    Range("DW1").Value = myInvQtr2
    Range("DW3:DY" & myTotalInvProjection).ClearContents
    Range("DW" & myTotalInvProjectionStr1 - 2).Value = myInvQtr2
    Range("DW" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).ClearContents

    Range("EL1").Value = myInvQtr3
    Range("EL3:EN" & myTotalInvProjection).ClearContents
    Range("EL" & myTotalInvProjectionStr1 - 2).Value = myInvQtr3
    Range("EL" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).ClearContents
    
    Range("FA1").Value = myInvQtr4
    Range("FA3:FC" & myTotalInvProjection).ClearContents
    Range("FA" & myTotalInvProjectionStr1 - 2).Value = myInvQtr4
    Range("FA" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).ClearContents
    
    'Get Micron & Harmonic Product Family
    'myHarmonicProductModelFile = Range("B15").Value
    Workbooks.Open Filename:=myHarmonicProductModelFile, ReadOnly:=True
    myHarmonicProductModelFilename = ActiveWorkbook.Name
    Range("A1:B" & Range("A" & Rows.Count).End(xlUp).Row).Copy
        'myMicronProductFile = Range("B19").Value
        Workbooks.Open Filename:=myMicronProductFile, ReadOnly:=True
        myMicronProductFilename = ActiveWorkbook.Name
        ActiveSheet.Name = "Temp"
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
        Application.DisplayAlerts = False
        Workbooks(myHarmonicProductModelFilename).Close False
        Application.DisplayAlerts = True
        Workbooks(myWipInventoryFilename).Activate
        Sheets("Detail WIP").Select
        myWipInvTotal = Range("G" & Rows.Count).End(xlUp).Row
        Range("C5:C" & myWipInvTotal).Value = "=VLOOKUP(G5,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
        Range("C5:C" & myWipInvTotal).Value = Range("C5:C" & myWipInvTotal).Value
        Sheets("PV").Select
        ActiveSheet.PivotTables("PivotTable9").PivotCache.Refresh
        ActiveSheet.PivotTables("PivotTable9").PivotFields("Plan Fmly").ClearAllFilters
        Workbooks(myRawMaterialFilename).Activate
        Sheets("Detail").Select
        myWipInvTotal = Range("B" & Rows.Count).End(xlUp).Row
        Range("B5:B" & myWipInvTotal).Value = "=VLOOKUP(F5,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
        Range("B5:B" & myWipInvTotal).Value = Range("B5:B" & myWipInvTotal).Value
        Sheets("Summary").Select
        ActiveSheet.PivotTables("PivotTable8").PivotCache.Refresh
        ActiveSheet.PivotTables("PivotTable8").PivotFields("MPF").ClearAllFilters
    Workbooks(myProjectedInvFilename).Activate
    'Total Inventory(07)
    Range("E3:E" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP(B3,'[" & myWipInventoryFilename & "]PV'!$A:$B,2,0),0)+IFERROR(VLOOKUP(B3,'[" & myRawMaterialFilename & "]Summary'!$A:$F,5,0),0)"
    Range("E3:E" & myTotalInvProjection).Value = Range("E3:E" & myTotalInvProjection).Value
    Range("E" & myTotalInvProjectionStr1 & ":E" & myTotalInvProjectionEnd1).Value = "=IFERROR(VLOOKUP(B" & myTotalInvProjectionStr1 & ",'[" & myWipInventoryFilename & "]PV'!$A:$B,2,0),0)+IFERROR(VLOOKUP(B" & myTotalInvProjectionStr1 & ",'[" & myRawMaterialFilename & "]Summary'!$A:$F,5,0),0)"
    Range("E" & myTotalInvProjectionStr1 & ":E" & myTotalInvProjectionEnd1).Value = Range("E" & myTotalInvProjectionStr1 & ":E" & myTotalInvProjectionEnd1).Value

    'Total Shipped
    Workbooks(mySrsFilename).Activate
    Sheets("SRS").Select
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(BD3=""SO"",BD3=""S1"",BD3=""CO""),Row(BD3),""Delete"")"
    Range("BE3:BE" & mySrsTotal).Value = Range("BE3:BE" & mySrsTotal).Value
    Range("A3:BE" & mySrsTotal).RemoveDuplicates Columns:=57, Header:=xlNo
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    'Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(RIGHT(TRIM(H3),3)=""-MF"",RIGHT(TRIM(H3),3)=""-SW"",RIGHT(TRIM(H3),3)=""-CW"",RIGHT(TRIM(H3),2)=""-S"",RIGHT(TRIM(H3),2)=""-W"",RIGHT(TRIM(H3),2)=""-C""),Row(BD3),""Delete"")"
    Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(RIGHT(TRIM(H3),3)=""-MF"",RIGHT(TRIM(H3),3)=""-SW"",RIGHT(TRIM(H3),2)=""-S"",RIGHT(TRIM(H3),2)=""-W"",RIGHT(TRIM(H3),2)=""-C""),Row(BD3),""Delete"")"
    Range("BE3:BE" & mySrsTotal).Value = Range("BE3:BE" & mySrsTotal).Value
    Range("A3:BE" & mySrsTotal).RemoveDuplicates Columns:=57, Header:=xlNo
    Range("G4:G" & mySrsTotal).Value = "=VLOOKUP(B4,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("G4:G" & mySrsTotal).Value = Range("G4:G" & mySrsTotal).Value
    Sheets("Shipped Not Yet Billed Report").Select
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("AB4:AB" & mySrsTotal).Value = "=IF(OR(G4=""SO"",G4=""S1"",G4=""CO""),Row(G4),""Delete"")"
    Range("AB4:AB" & mySrsTotal).Value = Range("AB4:AB" & mySrsTotal).Value
    Range("A4:BE" & mySrsTotal).RemoveDuplicates Columns:=28, Header:=xlNo
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("G4:G" & mySrsTotal).Value = "=VLOOKUP(K4,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("G4:G" & mySrsTotal).Value = Range("G4:G" & mySrsTotal).Value
    Workbooks(myProjectedInvFilename).Activate
    Range("R3:R" & myTotalInvProjection).Value = "=SUMIF('[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$G:$G,B3,'[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$V:$V)+SUMIF('[" & mySrsFilename & "]SRS'!$G:$G,B3,'[" & mySrsFilename & "]SRS'!$Z:$Z)"
    Range("R3:R" & myTotalInvProjection).Value = Range("R3:R" & myTotalInvProjection).Value
    Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).Value = "=SUMIF('[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$G:$G,B" & myTotalInvProjectionStr1 & ",'[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$V:$V)+SUMIF('[" & mySrsFilename & "]SRS'!$G:$G,B" & myTotalInvProjectionStr1 & ",'[" & mySrsFilename & "]SRS'!$Z:$Z)"
    Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).Value = Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).Value
    
    'Projected PO
    Workbooks(myProjectedPoFilename).Activate
    Sheets("PO").Select
    myProPoTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("B4:B" & myProPoTotal).Value = "=VLOOKUP(Q4,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("B4:B" & myProPoTotal).Value = Range("B4:B" & myProPoTotal).Value
    Sheets("PV").Select
    ActiveSheet.PivotTables("PivotTable2").PivotCache.Refresh
    ActiveSheet.PivotTables("PivotTable2").PivotFields("Family").ClearAllFilters
    Workbooks(myProjectedInvFilename).Activate
    'Month
    Range("G3:G" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("G3:G" & myTotalInvProjection).Value = Range("G3:G" & myTotalInvProjection).Value
    Range("X3:X" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("X3:X" & myTotalInvProjection).Value = Range("X3:X" & myTotalInvProjection).Value
    Range("AP3:AP" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("AP3:AP" & myTotalInvProjection).Value = Range("AP3:AP" & myTotalInvProjection).Value
    Range("BI3:BI" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth4, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("BI3:BI" & myTotalInvProjection).Value = Range("BI3:BI" & myTotalInvProjection).Value
    Range("CA3:CA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth5, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CA3:CA" & myTotalInvProjection).Value = Range("CA3:CA" & myTotalInvProjection).Value
    Range("CS3:CS" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth6, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CS3:CS" & myTotalInvProjection).Value = Range("CS3:CS" & myTotalInvProjection).Value
    Range("G" & myTotalInvProjectionStr1 & ":G" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("G" & myTotalInvProjectionStr1 & ":G" & myTotalInvProjectionEnd1).Value = Range("G" & myTotalInvProjectionStr1 & ":G" & myTotalInvProjectionEnd1).Value
    Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).Value = Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).Value
    Range("AP" & myTotalInvProjectionStr1 & ":AP" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("AP" & myTotalInvProjectionStr1 & ":AP" & myTotalInvProjectionEnd1).Value = Range("AP" & myTotalInvProjectionStr1 & ":AP" & myTotalInvProjectionEnd1).Value
    Range("BI" & myTotalInvProjectionStr1 & ":BI" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth4, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("BI" & myTotalInvProjectionStr1 & ":BI" & myTotalInvProjectionEnd1).Value = Range("BI" & myTotalInvProjectionStr1 & ":BI" & myTotalInvProjectionEnd1).Value
    Range("CA" & myTotalInvProjectionStr1 & ":CA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth5, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("CA" & myTotalInvProjectionStr1 & ":CA" & myTotalInvProjectionEnd1).Value = Range("CA" & myTotalInvProjectionStr1 & ":CA" & myTotalInvProjectionEnd1).Value
    Range("CS" & myTotalInvProjectionStr1 & ":CS" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth6, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("CS" & myTotalInvProjectionStr1 & ":CS" & myTotalInvProjectionEnd1).Value = Range("CS" & myTotalInvProjectionStr1 & ":CS" & myTotalInvProjectionEnd1).Value
        
    'Quarter1
    If myQtr1_1 <> "" Then
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
    End If
    If myQtr1_2 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DI" & myTotalInvProjectionStr1
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).ClearContents
    End If
    If myQtr1_3 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DI" & myTotalInvProjectionStr1
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).ClearContents
    End If
    'Quarter2
    If Range("DK2").Value <> "FOB" Then
        Range("DK2").Value = "FOB"
        Columns("DK:DK").Insert
        Columns("DK:DK").Hidden = True
    End If
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).ClearContents
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).ClearContents
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DX" & myTotalInvProjectionStr1
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).ClearContents
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DX" & myTotalInvProjectionStr1
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).ClearContents
    'Quarter3
    If Range("DZ2").Value <> "FOB" Then
        Range("DZ2").Value = "FOB"
        Columns("DZ:DZ").Insert
        Columns("DZ:DZ").Hidden = True
    End If
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).ClearContents
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).ClearContents
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+EM" & myTotalInvProjectionStr1
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).ClearContents
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+EM" & myTotalInvProjectionStr1
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).ClearContents
    'Quarter4
    If Range("EO2").Value <> "FOB" Then
        Range("EO2").Value = "FOB"
        Columns("EO:EO").Insert
        Columns("EO:EO").Hidden = True
    End If
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+FB3"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).ClearContents
    'Range("FB3:BF" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+BF3"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).ClearContents
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+FB" & myTotalInvProjectionStr1
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).ClearContents
        'Range("FB" & myTotalInvProjectionStr1 & ":BF" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+BF" & myTotalInvProjectionStr1
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).ClearContents
    
    'Planned Discrete Order & Planned SCM Order
    Workbooks(myPoYetToPlaceFilename).Activate
        'Ver2.3: No longer using Po Yet to Place
        Sheets("Details").Copy After:=Sheets(Sheets.Count)
        ActiveSheet.Name = "Temp"
    Sheets("Details").Select
    myProPoTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("D5:D" & myProPoTotal).Value = "=VLOOKUP(B5,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("D5:D" & myProPoTotal).Value = Range("D5:D" & myProPoTotal).Value
    'Sheets("PV").Select
    'ActiveSheet.PivotTables("PivotTable1").PivotCache.Refresh
    'ActiveSheet.PivotTables("PivotTable1").PivotFields("LeadTime").ClearAllFilters
    Workbooks(myProjectedInvFilename).Activate
    'Ver1.4: Change logic from Leadtime + today's date to just consider leadtime only
'    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
'    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1)-$H3"
'    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
'    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
'    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1)-$Y3"
'    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
'    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
'    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1)-$AQ3"
'    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
'    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
'    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1)-$BJ3"
'    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
'
'    Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
'
'    Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1)-$CB3"
'    Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
'    Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
'    Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1)-$CT3"
'    Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
'
'    'Qtr1
'    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
'    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ") & """)-$DI3"
'    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
'    'Qtr2
'    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
'    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """)-$DX3"
'    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
'    'Qtr3
'    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
'    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """)-$EM3"
'    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
'    'Qtr4
'    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
'    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """)-$FB3"
'    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
'    'Product Family 2nd table
'    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value
'    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1)-$H" & myTotalInvProjectionStr1
'    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value
'    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value
'    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1)-$Y" & myTotalInvProjectionStr1
'    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value
'    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value
'    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1)-$AQ" & myTotalInvProjectionStr1
'    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value
'    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value
'    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1)-$BJ" & myTotalInvProjectionStr1
'    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value
'
'    Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value
'    Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1)-$CB" & myTotalInvProjectionStr1
'        Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value
'        Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value
'        Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1)-$CT" & myTotalInvProjectionStr1
'        Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value
'
'    'Qtr1
'    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value
'    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ") & """)-$DI" & myTotalInvProjectionStr1
'    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value
'    'Qtr2
'    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value
'    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """)-$DX" & myTotalInvProjectionStr1
'    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value
'    'Qtr3
'    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value
'    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """)-$EM" & myTotalInvProjectionStr1
'    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value
'    'Qtr4
'    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value
'    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """)-$FB" & myTotalInvProjectionStr1
'    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value
    
    myWeekRemain = Workbooks(myMacroFile).Sheets("Macro").Range("K61").Value
    myWeekRemain = myWeekRemain * 7
    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$H3"
    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
    
    If Month("1 " & myInvMth2) / 3 - Int(Month("1 " & myInvMth2) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$Y3"
    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
    
    If Month("1 " & myInvMth3) / 3 - Int(Month("1 " & myInvMth3) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$AQ3"
    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
    
    If Month("1 " & myInvMth4) / 3 - Int(Month("1 " & myInvMth4) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$BJ3"
    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
    
    If myInvMth5 = "" Then
        Columns("CA:CR").Hidden = True
    Else
        If Month("1 " & myInvMth5) / 3 - Int(Month("1 " & myInvMth5) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
        Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CB3"
        Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
    End If
    
    If myInvMth6 = "" Then
        Columns("CA:DG").Hidden = True
    Else
        If Month("1 " & myInvMth6) / 3 - Int(Month("1 " & myInvMth6) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
        Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CT3"
        Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
    End If
    'Qtr1
    myWeekRemain = myWeekRemain + 91
    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DI3"
    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
    'Qtr2
    myWeekRemain = myWeekRemain + 91
    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DX3"
    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
    'Qtr3
    myWeekRemain = myWeekRemain + 91
    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$EM3"
    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
    'Qtr4
    myWeekRemain = myWeekRemain + 91
    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$FB3"
    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
    'Product Family 2nd table
    myWeekRemain = Workbooks(myMacroFile).Sheets("Macro").Range("K61").Value
    myWeekRemain = myWeekRemain * 7
    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value
    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$H" & myTotalInvProjectionStr1
    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value
    
    If Month("1 " & myInvMth2) / 3 - Int(Month("1 " & myInvMth2) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value
    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$Y" & myTotalInvProjectionStr1
    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value
    
    If Month("1 " & myInvMth3) / 3 - Int(Month("1 " & myInvMth3) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value
    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$AQ" & myTotalInvProjectionStr1
    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value
    
    If Month("1 " & myInvMth4) / 3 - Int(Month("1 " & myInvMth4) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value
    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$BJ" & myTotalInvProjectionStr1
    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value
    
    If myInvMth5 = "" Then
        
    Else
        If Month("1 " & myInvMth5) / 3 - Int(Month("1 " & myInvMth5) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                         & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
            Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value
        Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CB" & myTotalInvProjectionStr1
            Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value
    End If
    
    If myInvMth6 = "" Then
        
    Else
        If Month("1 " & myInvMth6) / 3 - Int(Month("1 " & myInvMth6) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
            Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                         & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
            Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value
            Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CT" & myTotalInvProjectionStr1
            Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value
    End If
    
    'Qtr1
    myWeekRemain = myWeekRemain + 91
    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value
    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DI" & myTotalInvProjectionStr1
    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value
    'Qtr2
    myWeekRemain = myWeekRemain + 91
    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value
    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DX" & myTotalInvProjectionStr1
    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value
    'Qtr3
    myWeekRemain = myWeekRemain + 91
    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value
    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$EM" & myTotalInvProjectionStr1
    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value
    'Qtr4
    myWeekRemain = myWeekRemain + 91
    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value
    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$FB" & myTotalInvProjectionStr1
    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value
End Sub
Sub ProductModelCheck()
    myMacroFile = ActiveWorkbook.Name
    myMacroPath = ActiveWorkbook.Path
    myStrTime = Time
    Range("A54:F" & Rows.Count).ClearContents
    Application.DisplayAlerts = False
    myBucketReportFile = Range("B13").Value
    myHarmonicProductModelFile = Range("B15").Value
    myMicronProductFile = Range("B19").Value
    myOpenPoFile = Range("B27").Value
    myRawMaterialFile = Range("B29").Value
    mySrsFile = Range("B33").Value
    myWipInventoryFile = Range("B35").Value
    
    Workbooks.Open Filename:=myHarmonicProductModelFile, ReadOnly:=True
    myHarmonicProductModelFilename = ActiveWorkbook.Name
    Range("A1:B" & Range("A" & Rows.Count).End(xlUp).Row).Copy
        Workbooks.Open Filename:=myMicronProductFile, ReadOnly:=True
        myMicronProductFilename = ActiveWorkbook.Name
        ActiveSheet.Name = "Temp"
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    Workbooks.Open Filename:=myBucketReportFile, ReadOnly:=True
    myBucketReportFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("A" & Rows.Count).End(xlUp).Row
        'Ver1.6: Format change afte JDE upgrade
        'Range("A1:DK" & myTempTotal).RemoveDuplicates Columns:=2, Header:=xlNo
        Range("A1:DK" & myTempTotal).RemoveDuplicates Columns:=5, Header:=xlNo
        Columns("E:F").Cut
        Columns("B:B").Insert
        myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
        'Range("A1:A" & myTempTotal).Value = "=IF(OR(D1=148,D1=321,D1=586),IF(DB1>0,IFERROR(VLOOKUP(B1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),""""),"""")"
        Range("A1:A" & myTempTotal).Value = "=IF(OR(D1=""148"",D1=""321"",D1=""586""),IF(DS1>0,IFERROR(VLOOKUP(B1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),""""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:DK" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myBucketTotal = Range("B" & Rows.Count).End(xlUp).Row
    If myBucketTotal > 1 Then
        Range("B2:B" & myBucketTotal).Copy
        Workbooks(myMacroFile).Activate
        Range("A54").PasteSpecial xlPasteValues
    End If
    Workbooks(myBucketReportFilename).Close False
    
    Workbooks.Open Filename:=myOpenPoFile, ReadOnly:=True
    myOpenPoFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("Q" & Rows.Count).End(xlUp).Row
    Range("A1:BG" & myTempTotal).RemoveDuplicates Columns:=17, Header:=xlNo
    myTempTotal = Range("Q" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(B1=148,B1=321,B1=586),IFERROR(VLOOKUP(Q1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:BG" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myTempTotal = Range("Q" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("Q2:Q" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("B54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(myOpenPoFilename).Close False
    
    Workbooks.Open Filename:=myRawMaterialFile, ReadOnly:=True
    Sheets("Detail").Select
    myRawMaterialFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("F" & Rows.Count).End(xlUp).Row
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=6, Header:=xlNo
    myTempTotal = Range("F" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(B1=148,B1=321,B1=586),IFERROR(VLOOKUP(F1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myTempTotal = Range("F" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("F2:F" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("C54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(myRawMaterialFilename).Close False
    
    Workbooks.Open Filename:=mySrsFile, ReadOnly:=True
    Sheets("SRS").Select
    mySrsFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=2, Header:=xlNo
    myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(G1=148,G1=321,G1=586),IFERROR(VLOOKUP(B1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("B2:B" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("D54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(mySrsFilename).Activate
        Sheets("Shipped Not Yet Billed Report").Select
        If ActiveSheet.AutoFilterMode = True Then
           Rows("3:3").AutoFilter
        End If
        ActiveSheet.Name = "Temp1"
            If Range("B3").Value = "" Then
                Rows("3:3").Delete
            End If
            If Range("B2").Value = "" Then
                Rows("2:2").Delete
            End If
            If Range("B1").Value = "" Then
                Rows("1:1").Delete
            End If
        myTempTotal = Range("K" & Rows.Count).End(xlUp).Row
        Range("A1:AA" & myTempTotal).RemoveDuplicates Columns:=11, Header:=xlNo
        myTempTotal = Range("K" & Rows.Count).End(xlUp).Row
        Range("A1:A" & myTempTotal).Value = "=IF(OR(X1=148,X1=321,X1=586),IFERROR(VLOOKUP(K1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
        Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
        Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
        Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
        Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
        myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
        If myTempTotal > 1 Then
            Range("B2:B" & myTempTotal).Copy
            Workbooks(myMacroFile).Activate
            'Range("E54").PasteSpecial xlPasteValues
            Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
        End If
    Workbooks(mySrsFilename).Close False
    
    Workbooks.Open Filename:=myWipInventoryFile, ReadOnly:=True
    Sheets("Detail WIP").Select
    myWipInventoryFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("G" & Rows.Count).End(xlUp).Row
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=7, Header:=xlNo
    myTempTotal = Range("G" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(C1=148,C1=321,C1=586),IFERROR(VLOOKUP(G1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("B1:B" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("B1:B" & myTempTotal).Value = Range("B1:B" & myTempTotal).Value
    Range("A1:M" & myTempTotal).RemoveDuplicates Columns:=2, Header:=xlNo
    myTempTotal = Range("G" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("G2:G" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("F54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(myWipInventoryFilename).Close False
    Workbooks(myHarmonicProductModelFilename).Close False
    Workbooks(myMicronProductFilename).Close False
    Workbooks(myMacroFile).Activate
    If Range("A" & Rows.Count).End(xlUp).Row > 53 Then
        Range("A53:A" & Range("A" & Rows.Count).End(xlUp).Row).RemoveDuplicates Columns:=1, Header:=xlNo
    End If
    Columns("A:F").EntireColumn.AutoFit
    Application.DisplayAlerts = True
    myEndTime = Time
    Range("A1").Select
    MsgBox "Done in " & Format(myEndTime - myStrTime, "hh:mm:ss")
End Sub
Sub ErrHnd1()
    On Error GoTo Err1
    Sheets("Aging Parts Details (ISL)").Select
    ActiveSheet.Name = "Aging Parts Details (ISL)2"
    Exit Sub
Err1:
End Sub
Sub ErrHnd2()
    On Error GoTo Err2
    Sheets("PV").Select
    ActiveSheet.Name = "PV_2"
    Exit Sub
Err2:
End Sub
    
