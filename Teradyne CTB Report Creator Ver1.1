Sub FileSelect()
    myRow = ActiveSheet.Shapes(Application.Caller).BottomRightCell.Row
    myGetFile = Application.GetOpenFilename(, , "Please select " & Range("A" & myRow).Value & " file:")
        If myGetFile = False Then
            End
        Else
            mySelect = myGetFile
            Range("B" & myRow).Value = mySelect
        End If
End Sub
Sub FileSelect1()
    myMacroFile = ActiveWorkbook.Name
    myRow = ActiveSheet.Shapes(Application.Caller).BottomRightCell.Row
    myGetFile = Application.GetOpenFilename(, , "Please select " & Range("A" & myRow).Value & " file:")
        If myGetFile = False Then
            End
        Else
            mySelect = myGetFile
            Range("B" & myRow).Value = mySelect
        End If
    Range("B22:F" & Rows.Count).ClearContents
    Workbooks.Open Range("B13").Value, , True
    myShortageFile = ActiveWorkbook.Name
    Sheets("Detail Shortages by Parent Ord").Select
    myTempLast = Range("E" & Rows.Count).End(xlUp).Row
    myEmptyCheck = Application.WorksheetFunction.CountIf(Range("D3:D" & myTempLast), "")
    If myEmptyCheck > 0 Then
        Range("C1:C" & myTempLast).Value = "=IF(D1=0,Row(D1),""Delete"")"
        Range("C1:C" & myTempLast).Value = Range("C1:C" & myTempLast).Value
        Range("C2:E" & myTempLast).RemoveDuplicates Columns:=1, Header:=xlNo
        myTempLast = Range("E" & Rows.Count).End(xlUp).Row
        Range("E3:E" & myTempLast).RemoveDuplicates Columns:=1, Header:=xlNo
        myTempLast = Range("E" & Rows.Count).End(xlUp).Row
        Range("E3:E" & myTempLast).Copy
        Workbooks(myMacroFile).Activate
        Sheets("Macro").Select
        Range("F22").PasteSpecial xlPasteValues
        Workbooks(myShortageFile).Close False
        MsgBox "Part without Product Group found! Please update it in Shortage List Peg Report!"
    Else
        Range("D3").Value = ""
        Range("D3:D" & myTempLast).RemoveDuplicates Columns:=1, Header:=xlNo
        myTempLast = Range("D" & Rows.Count).End(xlUp).Row
        Range("D4:D" & myTempLast).Copy
        Workbooks(myMacroFile).Activate
        Sheets("Macro").Select
        Range("B22").PasteSpecial xlPasteValues
        Workbooks(myShortageFile).Close False
    End If
    
    
    
'    myPullPath = Replace(Range("B13").Value, Dir(Range("B13").Value), "[" & Dir(Range("B13").Value))
'    Sheets("Temp").Select
'    myCounter = 0
'    myCheck = 1
'    For myA = 1 To 50
'        Range("D" & myCounter + 1 & ":D" & myCounter + 20000).Value = "='" & myPullPath & "]Detail Shortages by Parent Orde'!$E" & myCounter + 1
'        Range("D" & myCounter + 1 & ":D" & myCounter + 20000).Value = Range("D" & myCounter + 1 & ":D" & myCounter + 20000).Value
'        If Range("D" & myCounter + 20000).Value = 0 Then
'            Range("D" & myCounter + 1 & ":D" & myCounter + 20000).Replace What:="0", Replacement:="", LookAt:=xlWhole, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
'            myTempLast = Range("D" & Rows.Count).End(xlUp).Row
'            Range("C1:C" & myTempLast).Value = "='" & myPullPath & "]Detail Shortages by Parent Orde'!$D1"
'            Range("C1:C" & myTempLast).Value = Range("C1:C" & myTempLast).Value
'            myEmptyCheck = Application.WorksheetFunction.CountIf(Range("C3:C" & myTempLast), 0)
'            If myEmptyCheck > 0 Then
'                Range("B1:B" & myTempLast).Value = "=IF(C1=0,Row(C1),""Delete"")"
'                Range("B1:B" & myTempLast).Value = Range("B1:B" & myTempLast).Value
'                Range("B1:D" & myTempLast).RemoveDuplicates Columns:=1, Header:=xlNo
'                myTempLast = Range("D" & Rows.Count).End(xlUp).Row
'                Range("D3:D" & myTempLast).RemoveDuplicates Columns:=1, Header:=xlNo
'                myTempLast = Range("D" & Rows.Count).End(xlUp).Row
'                Range("D3:D" & myTempLast).Copy
'                Sheets("Macro").Select
'                Range("F22").PasteSpecial xlPasteValues
'            Else
'
'            End If
'            Exit For
'        End If
'        myCounter = myCounter + 20000
'    Next myA
    
End Sub
Sub MPF318_CTB()
    myMacroFile = ActiveWorkbook.Name
    myMacroPath = ActiveWorkbook.Path
    
    myStrTime = Time
    myEtsMoFile = Range("B11").Value
    myShortagesFile = Range("B13").Value
    myGatedFile = Range("B15").Value
    myWoFile = Range("B17").Value
    
    'Workbooks.Open Filename:=myEtsMoFile
    'myEtsMoFilename = ActiveWorkbook.Name
    'Sheets("Detail Shortages by Parent Orde").Select
    
    Workbooks.Open Filename:=myGatedFile
    myGatedFilename = ActiveWorkbook.Name
    myGatedSheetname = ActiveSheet.Name
    myGatedTotal = Range("F" & Rows.Count).End(xlUp).Row
    If Range("AI3").Value <> "" Then
        Columns("AI:AI").Insert Shift:=xlToRight
        Range("AI4:AI" & myGatedTotal).Value = "=F4&H4&W4&Z4"
    End If
    
    Workbooks.Open Filename:=myShortagesFile
    myShortagesFilename = ActiveWorkbook.Name
    myShortagesSheetname = ActiveSheet.Name
    myShortagesTotal = Range("E" & Rows.Count).End(xlUp).Row
    
    Columns("A:A").Insert Shift:=xlToRight
    Range("A3").Value = "Num"
    Range("A4:A" & myShortagesTotal).Value = "=Row(B1)"
    Range("A4:A" & myShortagesTotal).Value = Range("A4:A" & myShortagesTotal).Value
    Columns("U:U").ColumnWidth = 2
    Columns("V:V").Insert Shift:=xlToRight
    Range("U3").Value = "Key1"
    Range("V3").Value = "Key2"
    Range("AL3").Value = "Key3"
    Rows("3:3").AutoFilter
    ActiveSheet.Range("$A$3:$BL$" & myShortagesTotal).AutoFilter Field:=59, Criteria1:="=M", Operator:=xlOr, Criteria2:="=S" 'Column BG
    Range("A1:BL" & myShortagesTotal).Copy
    Workbooks.Add
    myNewWorkbook = ActiveWorkbook.Name
    Range("A1").PasteSpecial xlPasteAll
    Windows(myShortagesFilename).Activate
    Application.CutCopyMode = False
    ActiveSheet.Range("$A$3:$BL$" & myShortagesTotal).AutoFilter Field:=59, Criteria1:="P" 'Column BG (STK Type)
    ActiveSheet.Range("$A$3:$BL$" & myShortagesTotal).AutoFilter Field:=51, Criteria1:="<>Past" 'Column AY (Available)
    Range("A4:BL" & myShortagesTotal).Copy
    Windows(myNewWorkbook).Activate
    Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteAll
    
    Windows(myShortagesFilename).Activate
    Application.CutCopyMode = False
    ActiveSheet.Range("$A$3:$BL$" & myShortagesTotal).AutoFilter Field:=51, Criteria1:="Past" 'Column AY (Available)
    ActiveSheet.Range("$A$3:$BL$" & myShortagesTotal).AutoFilter Field:=39, Criteria1:="=*pcb*", Operator:=xlAnd 'Column AM (Part)
    Range("A4:BL" & myShortagesTotal).Copy
    Windows(myNewWorkbook).Activate
    Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteAll
    Application.DisplayAlerts = False
    Windows(myShortagesFilename).Close False
    Application.DisplayAlerts = True
    Columns("B:P").Font.ColorIndex = xlAutomatic
    ActiveWindow.Zoom = 80
    Columns("M:P").EntireColumn.AutoFit
    Columns("R:BO").Font.ColorIndex = xlAutomatic
    Columns("AY:BA").EntireColumn.AutoFit
    
    Rows("3:3").AutoFilter
    'Sort NUM
    ActiveWorkbook.Worksheets("Sheet1").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Sheet1").AutoFilter.Sort.SortFields.Add Key:=Range("A3"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("Sheet1").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    myNewTotal = Range("A" & Rows.Count).End(xlUp).Row
    Range("U4:U" & myNewTotal).Value = "=W4&X4" 'Assy Part & Number:Line
    Range("V4:V" & myNewTotal).Value = "=W4&X4&AM4&AP4" 'Assy Part & Number:Line & Part & OrderId:Line
    Range("AL4:AL" & myNewTotal).Value = "=AM4&AP4" 'Part & OrderId:Line
    
    Columns("AY:AY").Insert Shift:=xlToRight
    Range("AY3").Value = "CumShort"
    Columns("BA:BB").Insert Shift:=xlToRight
    Range("BA3").Value = "Revised Available"
    Range("BB3").Value = "Late"
    Columns("AZ:BA").Select
    'Columns("AZ:AZ").ColumnWidth = 11.29
    Columns("AY:AY").ColumnWidth = 12.86
    Range("AY4:AY" & myNewTotal).Value = "=IFERROR(VLOOKUP(V4,'[" & myGatedFilename & "]" & myGatedSheetname & "'!AI:AJ,2,0),"""")"
    Range("AY4:AY" & myNewTotal).Value = Range("AY4:AY" & myNewTotal).Value
    Range("BA4:BA" & myNewTotal).Value = "=IF(BJ4=""P"",AZ4,"""")"
    Range("BA4:BA" & myNewTotal).Value = Range("BA4:BA" & myNewTotal).Value
    Sheets.Add
    ActiveSheet.Name = "Pv"
    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:="Sheet1!R3C1:R" & myNewTotal & "C67", Version:=xlPivotTableVersion15).CreatePivotTable TableDestination:="Pv!R3C1", TableName:="PivotTable1", DefaultVersion:=xlPivotTableVersion15
    Cells(3, 1).Select
    Sheets("Sheet1").Name = "Detail Shortages"
    
    For Each pvtFld In ActiveSheet.PivotTables("PivotTable1").PivotFields
        pvtFld.Subtotals(1) = Array(True, True, True, True, True, True, True, True, True, True, True, True)
        pvtFld.Subtotals(1) = Array(False, False, False, False, False, False, False, False, False, False, False, False)
    Next pvtFld
    
    With ActiveSheet.PivotTables("PivotTable1")
        .ColumnGrand = False
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("PivotTable1").RowAxisLayout xlTabularRow
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Assy Part")
        .Orientation = xlRowField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Due2")
        .Orientation = xlRowField
        .Position = 2
    End With
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Number:Line2")
        .Orientation = xlRowField
        .Position = 3
    End With
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Type3")
        .Orientation = xlRowField
        .Position = 4
    End With
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Open")
        .Orientation = xlRowField
        .Position = 5
    End With
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Key1")
        .Orientation = xlRowField
        .Position = 6
    End With
    ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Revised Available"), "Count of Revised Available", xlCount
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Count of Revised Available")
        .Caption = "Max of Revised Available"
        .Function = xlMax
    End With
    Columns("G:G").NumberFormat = "m/d/yyyy"
    ActiveWindow.Zoom = 80
    
    Workbooks.Open Filename:=myWoFile
    myWoFilename = ActiveWorkbook.Name
    myWoSheetname = ActiveSheet.Name
    If ActiveSheet.AutoFilterMode = True Then
       Rows("2:2").AutoFilter
       Rows("2:2").AutoFilter
    Else
        Rows("2:2").AutoFilter
    End If
    myWoTotal = Range("C" & Rows.Count).End(xlUp).Row
    Columns("E:G").Insert Shift:=xlToRight
    Range("E3:E" & myWoTotal).Value = "=C3&D3" ' Part Number & Number:Line
    Range("F3:F" & myWoTotal).Value = "=IFERROR(VLOOKUP(E3,'[" & myNewWorkbook & "]Detail Shortages'!$U:$U,1,0),""NA"")"
    Range("F3:F" & myWoTotal).Value = Range("F3:F" & myWoTotal).Value
    Range("G3:G" & myWoTotal).Value = "=IFERROR(VLOOKUP(E3,'[" & myNewWorkbook & "]Detail Shortages'!$AL:$AL,1,0),""NA"")"
    Range("G3:G" & myWoTotal).Value = Range("G3:G" & myWoTotal).Value
    Cells.Find(What:="Matl Start", After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    myMatlStart = ActiveCell.Column
    ActiveSheet.Range("$A$2:$X$" & myWoTotal).AutoFilter Field:=6, Criteria1:="NA"
    ActiveSheet.Range("$A$2:$X$" & myWoTotal).AutoFilter Field:=7, Criteria1:="<>NA", Operator:=xlAnd
    ActiveSheet.Range("$A$2:$X$" & myWoTotal).AutoFilter Field:=myMatlStart, Criteria1:="<>Past"
    'ActiveSheet.Range("$A$2:$X$" & myWoTotal).AutoFilter Field:=myMatlStart, Operator:=xlFilterValues, Criteria2:=Array(0, "9/10/2019") 'Matl Start
    Range("E3:E" & myWoTotal).Copy
    
    Windows(myNewWorkbook).Activate
    Sheets("Pv").Select
    Range("F" & Range("E" & Rows.Count).End(xlUp).Row + 4).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Windows(myWoFilename).Activate
    Range(Cells(3, myMatlStart), Cells(myWoTotal, myMatlStart)).Copy
    Windows(myNewWorkbook).Activate
    Range("G" & Range("E" & Rows.Count).End(xlUp).Row + 4).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

    Windows(myWoFilename).Activate
    ActiveSheet.Range("$A$2:$X$" & myWoTotal).AutoFilter Field:=myMatlStart, Criteria1:="Past"
    Range("E3:E" & myWoTotal).Copy
    Windows(myNewWorkbook).Activate
    Range("F" & Range("F" & Rows.Count).End(xlUp).Row + 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Range("G" & Range("G" & Rows.Count).End(xlUp).Row + 1 & ":G" & Range("F" & Rows.Count).End(xlUp).Row).Value = Date
    Sheets("Detail Shortages").Select
    'ClearAllFilter
    'Range("CA4:CA" & myNewTotal).Value = "=IF(OR(BJ4=""M"",BJ4=""S""),IF(AZ4=""Past"",Today(),VLOOKUP(AL4,Pv!F:G,2,0)),BA4)"
    'Range("AU17").Select
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=62, Criteria1:="=M", Operator:=xlOr, Criteria2:="=S" 'Column BJ (STK Type)
    Range("BA4:BA" & myNewTotal).Value = "=VLOOKUP(AL4,Pv!F:G,2,0)"
    
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=52, Criteria1:="Past" 'Column AZ (Available)
    Range("BA4:BA" & myNewTotal).Value = Date
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=52 'Column AZ (Available)
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=53, Criteria1:="#N/A" 'Column BA (Revised Available)
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=39, Criteria1:="=x-act*", Operator:=xlAnd 'Column AM (Part)
    Range("BA4:BA" & myNewTotal).Value = Date
    
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=53
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=39
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=62
    'Range("BA4:BA" & myNewTotal).Value = Range("BA4:BA" & myNewTotal).Value
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=62, Criteria1:="P" 'Column BJ (STK Type)
    Range("BB4:BB" & myNewTotal).Value = "=RC[-1]>RC[2]+4"
    
    
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=56, Criteria1:="Past" 'Column BD (Need)
    Range("BD4:BD" & myNewTotal).Value = Date
    
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=56
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=62

    Sheets.Add
    ActiveWorkbook.Worksheets("Pv").PivotTables("PivotTable1").PivotCache.CreatePivotTable TableDestination:="Sheet3!R3C1", TableName:="PivotTable2", DefaultVersion:=xlPivotTableVersion15
    ActiveSheet.Name = "CF CTB"
    Cells(3, 1).Select
    For Each pvtFld In ActiveSheet.PivotTables("PivotTable2").PivotFields
        pvtFld.Subtotals(1) = Array(True, True, True, True, True, True, True, True, True, True, True, True)
        pvtFld.Subtotals(1) = Array(False, False, False, False, False, False, False, False, False, False, False, False)
    Next pvtFld
    With ActiveSheet.PivotTables("PivotTable2")
        .ColumnGrand = False
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("PivotTable2").RowAxisLayout xlTabularRow
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Part")
        .Orientation = xlRowField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Due")
        .Orientation = xlRowField
        .Position = 2
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Number:Line")
        .Orientation = xlRowField
        .Position = 3
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Qty")
        .Orientation = xlRowField
        .Position = 4
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Part2")
        .Orientation = xlRowField
        .Position = 5
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("OrderId:Line")
        .Orientation = xlRowField
        .Position = 6
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Status3")
        .Orientation = xlRowField
        .Position = 7
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Supply")
        .Orientation = xlRowField
        .Position = 8
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Needed")
        .Orientation = xlRowField
        .Position = 9
    End With
    ActiveSheet.PivotTables("PivotTable2").AddDataField ActiveSheet.PivotTables("PivotTable2").PivotFields("Revised Available"), "Count of Revised Available", xlCount
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Count of Revised Available")
        .Caption = "Max of Revised Available"
        .Function = xlMax
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Type6")
        .Orientation = xlPageField
        .Position = 1
    End With
    ActiveSheet.PivotTables("PivotTable2").PivotFields("Type6").CurrentPage = "(All)"
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Type6")
        .PivotItems("P").Visible = False
    End With
    ActiveSheet.PivotTables("PivotTable2").PivotFields("Type6").EnableMultiplePageItems = True
    ActiveWindow.Zoom = 80
    Range("I2").Select
    Columns("B:B").EntireColumn.AutoFit
    Range("J8").Select
    ActiveSheet.PivotTables("PivotTable2").PivotCache.Refresh
    Columns("J:J").NumberFormat = "m/d/yyyy"
    Sheets("Detail Shortages").Select
    Sheets.Add
    ActiveWorkbook.Worksheets("Pv").PivotTables("PivotTable1").PivotCache.CreatePivotTable TableDestination:="Sheet4!R3C1", TableName:="PivotTable3", DefaultVersion:=xlPivotTableVersion15
    Cells(3, 1).Select
    ActiveSheet.Name = "WO CTB"
    Sheets("WO CTB").Move Before:=Sheets(2)
    
    Range("C10").Select
    For Each pvtFld In ActiveSheet.PivotTables("PivotTable3").PivotFields
        pvtFld.Subtotals(1) = Array(True, True, True, True, True, True, True, True, True, True, True, True)
        pvtFld.Subtotals(1) = Array(False, False, False, False, False, False, False, False, False, False, False, False)
    Next pvtFld
    With ActiveSheet.PivotTables("PivotTable3")
        .ColumnGrand = False
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("PivotTable3").RowAxisLayout xlTabularRow
    With ActiveSheet.PivotTables("PivotTable3").PivotFields("Part2")
        .Orientation = xlRowField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable3").PivotFields("OrderId:Line")
        .Orientation = xlRowField
        .Position = 2
    End With
    With ActiveSheet.PivotTables("PivotTable3").PivotFields("Status3")
        .Orientation = xlRowField
        .Position = 3
    End With
    With ActiveSheet.PivotTables("PivotTable3").PivotFields("Supply")
        .Orientation = xlRowField
        .Position = 4
    End With
    ActiveSheet.PivotTables("PivotTable3").AddDataField ActiveSheet.PivotTables("PivotTable3").PivotFields("Available3"), "Count of Available3", xlCount
    With ActiveSheet.PivotTables("PivotTable3").PivotFields("Count of Available3")
        .Caption = "Max of Available3"
        .Function = xlMax
    End With
    ActiveSheet.PivotTables("PivotTable3").AddDataField ActiveSheet.PivotTables("PivotTable3").PivotFields("Revised Available"), "Count of Revised Available", xlCount
    With ActiveSheet.PivotTables("PivotTable3").PivotFields("Count of Revised Available")
        .Caption = "Max of Revised Available"
        .Function = xlMax
    End With
    
    Columns("E:F").NumberFormat = "m/d/yyyy"
    Range("E7").Select
    With ActiveSheet.PivotTables("PivotTable3").PivotFields("Type6")
        .Orientation = xlPageField
        .Position = 1
    End With
    ActiveSheet.PivotTables("PivotTable3").PivotFields("Type6").CurrentPage = "(All)"
    With ActiveSheet.PivotTables("PivotTable3").PivotFields("Type6")
        .PivotItems("P").Visible = False
    End With
    ActiveSheet.PivotTables("PivotTable3").PivotFields("Type6").EnableMultiplePageItems = True
    ActiveWindow.Zoom = 80
    ActiveSheet.PivotTables("PivotTable3").PivotFields("OrderId:Line").AutoSort xlAscending, "Max of Revised Available"
    With ActiveSheet.PivotTables("PivotTable3").PivotFields("Type5")
        .Orientation = xlRowField
        .Position = 3
    End With
    
    'Add in Type 5 after OerderID Line
    'Add in Available 3 after Supply at values then change to Max
    
    Sheets("Detail Shortages").Select
    Sheets.Add
    ActiveWorkbook.Worksheets("Pv").PivotTables("PivotTable1").PivotCache.CreatePivotTable TableDestination:="Sheet5!R3C1", TableName:="PivotTable4", DefaultVersion:=xlPivotTableVersion15
    ActiveSheet.Name = "Late Parts"
    Cells(3, 1).Select
    Sheets("Late Parts").Move Before:=Sheets(1)
    For Each pvtFld In ActiveSheet.PivotTables("PivotTable4").PivotFields
        pvtFld.Subtotals(1) = Array(True, True, True, True, True, True, True, True, True, True, True, True)
        pvtFld.Subtotals(1) = Array(False, False, False, False, False, False, False, False, False, False, False, False)
    Next pvtFld
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Assy Part")
        .Orientation = xlRowField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable4")
        .ColumnGrand = False
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("PivotTable4").RowAxisLayout xlTabularRow
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Time2")
        .Orientation = xlRowField
        .Position = 2
    End With
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Due2")
        .Orientation = xlRowField
        .Position = 3
    End With
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Number:Line2")
        .Orientation = xlRowField
        .Position = 4
    End With
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Key1")
        .Orientation = xlRowField
        .Position = 5
    End With
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Part2")
        .Orientation = xlRowField
        .Position = 6
    End With
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Part Description")
        .Orientation = xlRowField
        .Position = 7
    End With
    ActiveSheet.PivotTables("PivotTable4").AddDataField ActiveSheet.PivotTables("PivotTable4").PivotFields("CumShort"), "Count of CumShort", xlCount
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Count of CumShort")
        .Caption = "Max of CumShort"
        .Function = xlMax
    End With
    ActiveSheet.PivotTables("PivotTable4").AddDataField ActiveSheet.PivotTables("PivotTable4").PivotFields("Revised Available"), "Count of Revised Available", xlCount
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Count of Revised Available")
        .Caption = "Max of Revised Available"
        .Function = xlMax
    End With
    With ActiveSheet.PivotTables("PivotTable4").PivotFields("Late2")
        .Orientation = xlPageField
        .Position = 1
    End With
    ActiveSheet.PivotTables("PivotTable4").PivotFields("Late2").ClearAllFilters
    ActiveSheet.PivotTables("PivotTable4").PivotFields("Late2").CurrentPage = "TRUE"
    ActiveWindow.Zoom = 80
    Range("E2").Select
    Columns("C:C").EntireColumn.AutoFit
    Columns("I:I").NumberFormat = "m/d/yyyy"
    ActiveSheet.PivotTables("PivotTable4").PivotCache.Refresh
    Sheets("Detail Shortages").Select
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=53, Criteria1:="Past" 'Column BA (Revised Available)
    Range("BA4:BA" & myNewTotal).Value = Date
    
    ActiveSheet.Range("$A$3:$BO$" & myNewTotal).AutoFilter Field:=53
    Sheets("Late Parts").Select
    Range("G12").Select
    ActiveSheet.PivotTables("PivotTable4").PivotCache.Refresh
    Sheets("Detail Shortages").Select
    Range("A3:BO" & myNewTotal).Select
    Sheets.Add
    ActiveWorkbook.Worksheets("Late Parts").PivotTables("PivotTable4").PivotCache.CreatePivotTable TableDestination:="Sheet6!R3C1", TableName:="PivotTable5", DefaultVersion:=xlPivotTableVersion15
    ActiveSheet.Name = "SO Gated"
    Cells(3, 1).Select
    Sheets("SO Gated").Move Before:=Sheets(1)
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Due")
        .Orientation = xlRowField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Group")
        .Orientation = xlRowField
        .Position = 2
    End With
    For Each pvtFld In ActiveSheet.PivotTables("PivotTable5").PivotFields
        pvtFld.Subtotals(1) = Array(True, True, True, True, True, True, True, True, True, True, True, True)
        pvtFld.Subtotals(1) = Array(False, False, False, False, False, False, False, False, False, False, False, False)
    Next pvtFld
    With ActiveSheet.PivotTables("PivotTable5")
        .ColumnGrand = False
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("PivotTable5").RowAxisLayout xlTabularRow
    ActiveWindow.Zoom = 80
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Part")
        .Orientation = xlRowField
        .Position = 3
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Assy Part")
        .Orientation = xlRowField
        .Position = 4
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Type3")
        .Orientation = xlRowField
        .Position = 5
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Number:Line2")
        .Orientation = xlRowField
        .Position = 6
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Status2")
        .Orientation = xlRowField
        .Position = 7
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Part2")
        .Orientation = xlRowField
        .Position = 8
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Part Description")
        .Orientation = xlRowField
        .Position = 9
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("OrderId:Line")
        .Orientation = xlRowField
        .Position = 10
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Status3")
        .Orientation = xlRowField
        .Position = 11
    End With
    ActiveSheet.PivotTables("PivotTable5").AddDataField ActiveSheet.PivotTables("PivotTable5").PivotFields("CumShort"), "Count of CumShort", xlCount
    ActiveSheet.PivotTables("PivotTable5").AddDataField ActiveSheet.PivotTables("PivotTable5").PivotFields("Revised Available"), "Count of Revised Available", xlCount
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Count of CumShort")
        .Caption = "Max of CumShort"
        .Function = xlMax
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Count of Revised Available")
        .Caption = "Max of Revised Available"
        .Function = xlMax
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Late2")
        .Orientation = xlPageField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable5").PivotFields("Type")
        .Orientation = xlPageField
        .Position = 1
    End With
    ActiveSheet.PivotTables("PivotTable5").PivotFields("Late2").ClearAllFilters
    ActiveSheet.PivotTables("PivotTable5").PivotFields("Late2").CurrentPage = "TRUE"
    ActiveSheet.PivotTables("PivotTable5").PivotFields("Type").ClearAllFilters
    For Each myPivotItem In ActiveSheet.PivotTables("PivotTable5").PivotFields("Type").PivotItems
        If myPivotItem.Name = "SO" Or myPivotItem.Name = "S1" Then
        Else
            ActiveSheet.PivotTables("PivotTable5").PivotFields("Type").PivotItems(myPivotItem.Name).Visible = False
        End If
    Next
    ActiveSheet.PivotTables("PivotTable5").PivotFields("Type").EnableMultiplePageItems = True
    'Select SO and S1 if available
    
    Range("H3").Select
    Columns("M:M").NumberFormat = "m/d/yyyy"
    Workbooks(myGatedFilename).Close False
    Workbooks(myWoFilename).Close False
    
    Sheets("Detail Shortages").Select
    myEndTime = Time
    MsgBox "Done in " & Format(myEndTime - myStrTime, "hh:mm:ss")
End Sub
Sub Ctb()
    Set FSO = New Scripting.FileSystemObject
    myMacroFile = ActiveWorkbook.Name
    myMacroPath = ActiveWorkbook.Path
    
    myStrTime = Time
    Range("C22:C" & Rows.Count).ClearContents
    
    myShortageFile = Range("B13").Value
    myOpenPoFile = Range("B15").Value
    myWmsFile = Range("B17").Value
    
    myTotalProductGroup = Range("B" & Rows.Count).End(xlUp).Row
    If myTotalProductGroup < 22 Then
        MsgBox "No Product Group found!"
        End
    Else
        Range("B21").Value = ""
        Range("B21:B" & myTotalProductGroup).RemoveDuplicates Columns:=1, Header:=xlNo
        Range("B21").Value = "Product Group"
        myTotalProductGroup = Range("B" & Rows.Count).End(xlUp).Row
    End If
    
    myOverallProductGroup = ""
    For myA = 22 To myTotalProductGroup
        myOverallProductGroup = myOverallProductGroup & "RC[3]=""" & Range("B" & myA).Value & ""","
    Next myA
    myOverallProductGroup = "=IF(OR(" & Left(myOverallProductGroup, Len(myOverallProductGroup) - 1) & "),ROW(RC[-1]),""Delete"")"

    Workbooks.Open myShortageFile, , True
    myShortageFile = ActiveWorkbook.Name
    Sheets("Detail Shortages by Parent Ord").Select
    myTempLast = Range("E" & Rows.Count).End(xlUp).Row
    myEmptyCheck = Application.WorksheetFunction.CountIf(Range("D3:D" & myTempLast), "")
    If myEmptyCheck > 0 Then
        MsgBox "Part without Product Group found! Please update it in Shortage List Peg Report!"
        End
    End If
    Workbooks.Open myOpenPoFile, , True
    myOpenPoFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Open PO"
    Range("BH3").Value = "OrderId:Line"
    myTotalOpo = Range("B" & Rows.Count).End(xlUp).Row
    Range("BH4:BH" & myTotalOpo).Value = "=L4&"":""&P4"
    Range("BH4:BH" & myTotalOpo).Value = Range("BH4:BH" & myTotalOpo).Value
    
    Workbooks.Open myWmsFile, False, True
    myWmsFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Expiry"
    
    If Dir(myMacroPath & "\CTB Shortage.xlsm") = "" Then
        Call FSO.CopyFile(myMacroPath & "\" & myMacroFile, myMacroPath & "\CTB Shortage.xlsm", OverWrite)
    End If
    Workbooks.Open myMacroPath & "\CTB Shortage.xlsm"
    
    Workbooks(myShortageFile).Activate
    'Delete unwanted product group
    Columns("A:BJ").Font.ColorIndex = xlAutomatic
    Range("A3:A" & myTempLast).Value = myOverallProductGroup
    Range("A3:A" & myTempLast).Value = Range("A3:A" & myTempLast).Value
    Range("A3:BJ" & myTempLast).RemoveDuplicates Columns:=1, Header:=xlNo
    myTempLast = Range("E" & Rows.Count).End(xlUp).Row
    Range("A1:BJ" & myTempLast).Copy
    Workbooks("CTB Shortage.xlsm").Activate
    Sheets("Shortages").Select
    Range("A1").PasteSpecial xlPasteAll
    Rows("4:4").Select
    ActiveWindow.FreezePanes = True
    Columns("A:A").Delete
    Cells.RowHeight = 11.25
    Range("A1:R1").Merge
    Range("A1").Value = "Driver Order (Sales Order)"
    Columns("A:BI").AutoFit
    Columns("S:S").ColumnWidth = 0.45
    Columns("AI:AI").ColumnWidth = 0.45
    ClearAllFilter
    ActiveSheet.Range("$A$3:$BG$" & myTempLast).AutoFilter Field:=36, Criteria1:="=*PCB*", Operator:=xlAnd
    Range("AJ4:AJ" & myTempLast).Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        '.TintAndShade = 0.399975585192419
        '.PatternTintAndShade = 0
    End With
    ActiveSheet.ShowAllData
    
    Workbooks(myWmsFilename).Sheets("Expiry").Copy After:=Workbooks("CTB Shortage.xlsm").Sheets(Sheets.Count)
    Workbooks(myOpenPoFilename).Sheets("Open PO").Copy After:=Workbooks("CTB Shortage.xlsm").Sheets(Sheets.Count)
    
    Application.DisplayAlerts = False
    Sheets("Cover").Delete
    Sheets("Macro").Delete
    Sheets("Temp").Delete
    Application.DisplayAlerts = True
    Sheets("Shortages").Select
    Sheets("Shortages").Copy After:=Sheets("Shortages")
    ActiveSheet.Name = "PCB"
    Range("AI3").Value = "Delete"
    Range("AI3:AI" & myTempLast).Value = "=IF(COUNTIF(AJ3,""*PCB*"")>0,ROW(AJ3),""Delete"")"
    Range("AI3:AI" & myTempLast).Value = Range("AI3:AI" & myTempLast).Value
    Range("A3:BI" & myTempLast).RemoveDuplicates Columns:=35, Header:=xlNo
    Columns("AI:AI").ClearContents
    
    Workbooks(myOpenPoFilename).Close False
    Workbooks(myWmsFilename).Close False
    Workbooks(myShortageFile).Close False
    
    myEndTime = Time
    MsgBox "Done in " & Format(myEndTime - myStrTime, "hh:mm:ss")
End Sub
Sub ClearAllFilter()
    On Error Resume Next
    ActiveSheet.ShowAllData
End Sub
Sub PivotBucket()
    On Error GoTo Err1
    Application.DisplayAlerts = False
        Sheets("Details").Delete
    Application.DisplayAlerts = True
    Sheets("Temp").Name = "Details"
    Set mySearchValue = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
    If mySearchValue Is Nothing Then

    Else
        mySearchValue = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
        myBlankCheck = Application.WorksheetFunction.CountBlank(Range(Cells(4, 1), Cells(4, mySearchValue)))
        If myBlankCheck > 1 Then
            Range(Cells(4, 1), Cells(4, mySearchValue)).SpecialCells(xlCellTypeBlanks).EntireColumn.Delete
            myLastCol = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
        End If
        myLastCol = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
        myTempPivot = Range("B" & Rows.Count).End(xlUp).Row
        Sheets.Add
        ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:="Details!R4C1:R" & myTempPivot & "C" & myLastCol, Version:=xlPivotTableVersion15).CreatePivotTable TableDestination:=ActiveSheet.Name & "!R3C1", TableName:="PivotTable1"
        Cells(3, 1).Select
        With ActiveSheet.PivotTables("PivotTable1").PivotFields("MPF")
            .Orientation = xlRowField
            .Position = 1
        End With
        With ActiveSheet.PivotTables("PivotTable1").PivotFields("LT")
            .Orientation = xlPageField
            .Position = 1
        End With
        With ActiveSheet.PivotTables("PivotTable1").PivotFields("Type")
            .Orientation = xlColumnField
            .Position = 1
        End With
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").PivotItems("830G").Position = 1
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").PivotItems("830O").Position = 2
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").PivotItems("(blank)").Position = 3
        Range("B4:D4").Group
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type2").PivotItems("Group1").Caption = "Discrete"
        myLastPivotCol = Cells.SpecialCells(xlCellTypeLastCell).Column - 1
        Range(Cells(5, 5), Cells(5, myLastPivotCol)).Group
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type2").PivotItems("Group2").Caption = "SCM"
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").Orientation = xlHidden
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket1 Shortages $$"), "Sum of Bucket1 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket2 Shortages $$"), "Sum of Bucket2 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket3 Shortages $$"), "Sum of Bucket3 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket4 Shortages $$"), "Sum of Bucket4 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket5 Shortages $$"), "Sum of Bucket5 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket6 Shortages $$"), "Sum of Bucket6 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket7 Shortages $$"), "Sum of Bucket7 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket8 Shortages $$"), "Sum of Bucket8 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket9 Shortages $$"), "Sum of Bucket9 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket10 Shortages $$"), "Sum of Bucket10 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket11 Shortages $$"), "Sum of Bucket11 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket12 Shortages $$"), "Sum of Bucket12 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket13 Shortages $$"), "Sum of Bucket13 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket14 Shortages $$"), "Sum of Bucket14 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket15 Shortages $$"), "Sum of Bucket15 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket16 Shortages $$"), "Sum of Bucket16 Shortages $$", xlSum
        With ActiveSheet.PivotTables("PivotTable1").DataPivotField
            .Orientation = xlColumnField
            .Position = 1
        End With
        Range("B6").Select
        Range(Selection, Selection.End(xlToRight)).Select
        Range(Selection, Selection.End(xlDown)).Select
        Selection.Style = "Currency"
        Selection.NumberFormat = "_($* #,##0_);_($* (#,##0);_($* ""-""??_);_(@_)"
        ActiveSheet.Name = "PV"
        Rows("4:4").RowHeight = 52.5
        Selection.ColumnWidth = 10.67
        Rows("4:4").WrapText = True
        Selection.EntireColumn.AutoFit
        Rows("4:4").EntireRow.AutoFit
        Sheets("Details").Select
    End If
Err1:
End Sub
Sub InventoryProjection1a()
    Workbooks(myProjectedInvFilename).Activate
    Range(Range("CC3"), Range("CC3").End(xlDown).Offset(-1, 0)).Select
    Range(Selection, Selection.End(xlToRight)).Select
        'Ver1.3: Change Sheetname
        'Selection.Value = "=VLOOKUP(TEXT($C3,""000""),'[" & mySalesOnlyFilename & "]My Sales'!$A:$AAB,MATCH(TEXT(CC$2,""Mmm Yy"")&""Total Net Sales excluding Unbilled"",'[" & mySalesOnlyFilename & "]My Sales'!$1:$1,0),0)"
        Selection.Value = "=VLOOKUP(TEXT($C3,""000""),'[" & mySalesOnlyFilename & "]" & mySalesOnlySheetname & "'!$A:$AAB,MATCH(TEXT(CC$2,""Mmm Yy"")&""Total Net Sales excluding Unbilled"",'[" & mySalesOnlyFilename & "]" & mySalesOnlySheetname & "'!$1:$1,0),0)"
    Selection.Value = Selection.Value
    Cells.Find(What:="Material Cost %", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    myStartRow = Selection.End(xlDown).Row
        'Add platform to vlookup
        Sheets("Mat. Cost Calc.").Columns("B:B").Insert
        myLastMatCostCalcTotal = Sheets("Mat. Cost Calc.").Range("A" & Rows.Count).End(xlUp).Row
        Sheets("Mat. Cost Calc.").Range("B1:B" & myLastMatCostCalcTotal).Value = "=Left(Right(A1,4),3)"
    Range("CC" & myStartRow).Select
    Range(Selection, Selection.End(xlDown).Offset(-1, 0)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.Value = "=VLOOKUP(TEXT($C" & myStartRow & ",""000""),'Mat. Cost Calc.'!$B:$AAB,MATCH(""Mat. Cost %"" & TEXT(CC$" & myStartRow - 1 & ",""Mmm Yy""),'Mat. Cost Calc.'!$2:$2,0)-1,0)"
    Selection.Value = Selection.Value
        'Delete column
        Sheets("Mat. Cost Calc.").Columns("B:B").Delete
    
    Workbooks(myCurrentVsBaseFilename).Sheets("Temp").Columns("B:B").Insert
    myLastCurrentVsBase = Workbooks(myCurrentVsBaseFilename).Sheets("Temp").Range("A" & Rows.Count).End(xlUp).Row
    Workbooks(myCurrentVsBaseFilename).Sheets("Temp").Range("B1:B" & myLastCurrentVsBase).Value = "=Left(Right(A1,4),3)"
    
    Sheets("Inventory Projection").Select
    myTotalInvProjection = Range("A" & Rows.Count).End(xlUp).Row - 1

    Range("E1").Value = Date
    Range("E3:I" & myTotalInvProjection).ClearContents
    
    Range("G1").Value = "'" & myInvMth1
    Range("R3:R" & myTotalInvProjection).ClearContents
    Range("V3:V" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("V3:V" & myTotalInvProjection).Value = Range("V3:V" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("S:S"), 0)
    Range("T" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob1 = "" Then
        myInvMthFob1 = 0
    End If
    Range("T" & myPpvOtherRow).Value = Range("T" & myPpvOtherRow).Value - myInvMthFob1
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("S:S"), 0)
    Range("T" & myFobRow).Value = myInvMthFob1
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("S:S"), 0)
    Range("U" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("U" & myEstimatedPlantRow).Value = Range("U" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("S:S"), 0)
    Range("T" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("T" & myTargetRow).Value = Range("T" & myTargetRow).Value
    
    Range("X1").Value = "'" & myInvMth2
    Range("X3:X" & myTotalInvProjection).ClearContents
    Range("AN3:AN" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("AN3:AN" & myTotalInvProjection).Value = Range("AN3:AN" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("AK:AK"), 0)
    Range("AL" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob2 = "" Then
        myInvMthFob2 = 0
    End If
    Range("AL" & myPpvOtherRow).Value = Range("AL" & myPpvOtherRow).Value - myInvMthFob2
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("AK:AK"), 0)
    Range("AL" & myFobRow).Value = myInvMthFob2
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("AK:AK"), 0)
    Range("AM" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("AM" & myEstimatedPlantRow).Value = Range("AM" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("AK:AK"), 0)
    Range("AL" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("AL" & myTargetRow).Value = Range("AL" & myTargetRow).Value
    
    Range("AP1").Value = "'" & myInvMth3
    Range("AP3:AR" & myTotalInvProjection).ClearContents
    Range("BF3:BF" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BF3:BF" & myTotalInvProjection).Value = Range("BF3:BF" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("BC:BC"), 0)
    Range("BD" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob3 = "" Then
        myInvMthFob3 = 0
    End If
    Range("BD" & myPpvOtherRow).Value = Range("BD" & myPpvOtherRow).Value - myInvMthFob3
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("BC:BC"), 0)
    Range("BD" & myFobRow).Value = myInvMthFob3
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("BC:BC"), 0)
    Range("BE" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BE" & myEstimatedPlantRow).Value = Range("BE" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("BC:BC"), 0)
    Range("BD" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BD" & myTargetRow).Value = Range("BD" & myTargetRow).Value
    
    Range("BI1").Value = "'" & myInvMth4
    Range("BI3:BK" & myTotalInvProjection).ClearContents
    Range("BY3:BY" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BY3:BY" & myTotalInvProjection).Value = Range("BY3:BY" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("BV:BV"), 0)
    Range("BW" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob4 = "" Then
        myInvMthFob4 = 0
    End If
    Range("BW" & myPpvOtherRow).Value = Range("BW" & myPpvOtherRow).Value - myInvMthFob4
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("BV:BV"), 0)
    Range("BW" & myFobRow).Value = myInvMthFob4
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("BV:BV"), 0)
    Range("BX" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BX" & myEstimatedPlantRow).Value = Range("BX" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("BV:BV"), 0)
    Range("BW" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BW" & myTargetRow).Value = Range("BW" & myTargetRow).Value
    
    Range("CA1").Value = "'" & myInvMth5
    Range("CA3:CC" & myTotalInvProjection).ClearContents
    If myInvMth5 = "" Then
        Range("CF3:CF" & myTotalInvProjection).ClearContents
        Range("CF3:CF" & myTotalInvProjection).ClearComments
        Range("CJ3:CL" & myTotalInvProjection).ClearContents
        Range("CJ3:CL" & myTotalInvProjection).ClearComments
        Range("CO3:CO" & myTotalInvProjection).ClearContents
        Range("CQ3:CQ" & myTotalInvProjection).ClearContents
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("CN:CN"), 0)
        Range("CO" & myPpvOtherRow).Value = ""
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("CN:CN"), 0)
        Range("CO" & myFobRow).Value = ""
        Range("CP" & myEstimatedPlantRow).Value = ""
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("CN:CN"), 0)
        Range("CO" & myTargetRow).Value = ""
        Columns("CA:CR").Hidden = True
    Else
        Columns("CA:CR").Hidden = False
        Columns("CD:CE").Hidden = True
        Range("CQ3:CQ" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("CQ3:CQ" & myTotalInvProjection).Value = Range("CQ3:CQ" & myTotalInvProjection).Value
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("CN:CN"), 0)
        Range("CO" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        If myInvMthFob5 = "" Then
            myInvMthFob5 = 0
        End If
        Range("CO" & myPpvOtherRow).Value = Range("CO" & myPpvOtherRow).Value - myInvMthFob5
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("CN:CN"), 0)
        Range("CO" & myFobRow).Value = myInvMthFob5
        myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("CN:CN"), 0)
        Range("CP" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("CP" & myEstimatedPlantRow).Value = Range("CP" & myEstimatedPlantRow).Value
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("CN:CN"), 0)
        Range("CO" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("CO" & myTargetRow).Value = Range("CO" & myTargetRow).Value
        If Range("CO3").Value <> "" Then
            Range("CO3:CO" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP($B3,INDIRECT(""COGS!C""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":$XFD$1000000""),MATCH(DATEVALUE(""1 ""&CA$1),INDIRECT(""COGS!""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":""&MATCH(""After Adjustment"",COGS!$B:$B,0)),0)-2,0),"""")"
        End If
    End If
        
    Range("CS1").Value = "'" & myInvMth6
    Range("CS3:CU" & myTotalInvProjection).ClearContents
    If myInvMth6 = "" Then
        Range("CW3:CW" & myTotalInvProjection).ClearContents
        Range("CW3:CW" & myTotalInvProjection).ClearComments
        Range("CY3:CY" & myTotalInvProjection).ClearContents
        Range("CY3:CY" & myTotalInvProjection).ClearComments
        Range("DD3:DD" & myTotalInvProjection).ClearContents
        Range("DF3:DF" & myTotalInvProjection).ClearContents
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("DC:DC"), 0)
        Range("DD" & myPpvOtherRow).Value = ""
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("DC:DC"), 0)
        Range("DD" & myFobRow).Value = ""
        Range("DE" & myEstimatedPlantRow).Value = ""
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("DC:DC"), 0)
        Range("DD" & myTargetRow).Value = ""
        Columns("CS:DG").Hidden = True
    Else
        Columns("CS:DG").Hidden = False
        Columns("CV:CV").Hidden = True
        Range("DF3:DF" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("DF3:DF" & myTotalInvProjection).Value = Range("DF3:DF" & myTotalInvProjection).Value
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("DC:DC"), 0)
        Range("DD" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        If myInvMthFob6 = "" Then
            myInvMthFob6 = 0
        End If
        Range("DD" & myPpvOtherRow).Value = Range("DD" & myPpvOtherRow).Value - myInvMthFob6
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("DC:DC"), 0)
        Range("DD" & myFobRow).Value = myInvMthFob6
        myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("DC:DC"), 0)
        Range("DE" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("DE" & myEstimatedPlantRow).Value = Range("DE" & myEstimatedPlantRow).Value
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("DC:DC"), 0)
        Range("DD" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("DD" & myTargetRow).Value = Range("DD" & myTargetRow).Value
        If Range("DD3").Value <> "" Then
            Range("DD3:DD" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP($B3,INDIRECT(""COGS!C""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":$XFD$1000000""),MATCH(DATEVALUE(""1 ""&CS$1),INDIRECT(""COGS!""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":""&MATCH(""After Adjustment"",COGS!$B:$B,0)),0)-2,0),"""")"
        End If
    End If
  
    Range("DH1").Value = myInvQtr1
    Range("DH3:DJ" & myTotalInvProjection).ClearContents
    Range("DU3:DU" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DU3:DU" & myTotalInvProjection).Value = Range("DU3:DU" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("DR:DR"), 0)
    'Range("DS" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DS" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("DS" & myPpvOtherRow).Value = Range("DS" & myPpvOtherRow).Value - myInvQtrFob1
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("DR:DR"), 0)
    Range("DS" & myFobRow).Value = myInvQtrFob1
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("DR:DR"), 0)
    Range("DT" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DT" & myEstimatedPlantRow).Value = Range("DT" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("DR:DR"), 0)
    Range("DS" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DS" & myTargetRow).Value = Range("DS" & myTargetRow).Value

    Range("DW1").Value = myInvQtr2
    Range("DW3:DY" & myTotalInvProjection).ClearContents
    Range("EJ3:EJ" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EJ3:EJ" & myTotalInvProjection).Value = Range("EJ3:EJ" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("EG:EG"), 0)
    'Range("EH" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EH" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("EH" & myPpvOtherRow).Value = Range("EH" & myPpvOtherRow).Value - myInvQtrFob2
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("EG:EG"), 0)
    Range("EH" & myFobRow).Value = myInvQtrFob2
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("EG:EG"), 0)
    Range("EI" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EI" & myEstimatedPlantRow).Value = Range("EI" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("EG:EG"), 0)
    Range("EH" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EH" & myTargetRow).Value = Range("EH" & myTargetRow).Value

    Range("EL1").Value = myInvQtr3
    Range("EL3:EN" & myTotalInvProjection).ClearContents
    Range("EY3:EY" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EY3:EY" & myTotalInvProjection).Value = Range("EY3:EY" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("EV:EV"), 0)
    'Range("EW" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EW" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("EW" & myPpvOtherRow).Value = Range("EW" & myPpvOtherRow).Value - myInvQtyFob3
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("EV:EV"), 0)
    Range("EW" & myFobRow).Value = myInvQtyFob3
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("EV:EV"), 0)
    Range("EX" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EX" & myEstimatedPlantRow).Value = Range("EX" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("EV:EV"), 0)
    Range("EW" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EW" & myTargetRow).Value = Range("EW" & myTargetRow).Value
    
    Range("FA1").Value = myInvQtr4
    Range("FA3:FC" & myTotalInvProjection).ClearContents
    Range("FN3:FN" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FN3:FN" & myTotalInvProjection).Value = Range("FN3:FN" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("FK:FK"), 0)
    'Range("FL" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FL" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("FL" & myPpvOtherRow).Value = Range("FL" & myPpvOtherRow).Value - myInvQtyFob4
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("FK:FK"), 0)
    Range("FL" & myFobRow).Value = myInvQtyFob4
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("FK:FK"), 0)
    Range("FM" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FM" & myEstimatedPlantRow).Value = Range("FM" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("FK:FK"), 0)
    Range("FL" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FL" & myTargetRow).Value = Range("FL" & myTargetRow).Value

    'Total Inventory(07)
    Range("E3:E" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP(B3,'[" & myWipInventoryFilename & "]PV'!$A:$B,2,0),0)+IFERROR(VLOOKUP(B3,'[" & myRawMaterialFilename & "]Summary'!$A:$F,5,0),0)"
    Range("E3:E" & myTotalInvProjection).Value = Range("E3:E" & myTotalInvProjection).Value
    
    'Total Shipped
    Range("R3:R" & myTotalInvProjection).Value = "=VLOOKUP(B3,'[" & mySrsFilename & "]Summary'!$C:$G,5,0)"
    Range("R3:R" & myTotalInvProjection).Value = Range("R3:R" & myTotalInvProjection).Value
    
    'Projected PO
    'Month
    Range("G3:G" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("G3:G" & myTotalInvProjection).Value = Range("G3:G" & myTotalInvProjection).Value
    Range("X3:X" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("X3:X" & myTotalInvProjection).Value = Range("X3:X" & myTotalInvProjection).Value
    Range("AP3:AP" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("AP3:AP" & myTotalInvProjection).Value = Range("AP3:AP" & myTotalInvProjection).Value
    Range("BI3:BI" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth4, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("BI3:BI" & myTotalInvProjection).Value = Range("BI3:BI" & myTotalInvProjection).Value
    Range("CA3:CA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth5, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CA3:CA" & myTotalInvProjection).Value = Range("CA3:CA" & myTotalInvProjection).Value
    Range("CS3:CS" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth6, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CS3:CS" & myTotalInvProjection).Value = Range("CS3:CS" & myTotalInvProjection).Value
    
    'Quarter1
    If myQtr1_1 <> "" Then
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
    End If
    If myQtr1_2 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
    End If
    If myQtr1_3 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
    End If
    'Quarter2
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
        Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DX3:DX" & myTotalInvProjection).ClearContents
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
        Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DX3:DX" & myTotalInvProjection).ClearContents
    'Quarter3
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
        Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EM3:EM" & myTotalInvProjection).ClearContents
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
        Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EM3:EM" & myTotalInvProjection).ClearContents
    'Quarter4
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+FB3"
        Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        Range("FB3:FB" & myTotalInvProjection).ClearContents
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        'Ver1.5: Refer to wrong cells
        'Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+BF3"
        Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+FB3"
        Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        Range("FB3:FB" & myTotalInvProjection).ClearContents
    
    'Planned Discrete Order & Planned SCM Order (myWeekRemain)
    'Ver1.4: Change logic from Leadtime + today's date to just consider leadtime only
'    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'
'    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
'    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1)-$H3"
'    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
'    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
'    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1)-$Y3"
'    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
'    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
'    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1)-$AQ3"
'    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
'    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
'    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1)-$BJ3"
'    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
'    If myInvMth5 = "" Then
'        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BG:BN").Insert
'        Columns("CA:CR").Hidden = True
'    Else
'        Columns("CA:CR").Hidden = False
'        Columns("CD:CD").Hidden = True
'        Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
'    End If
'    If myInvMth6 = "" Then
'        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BO:BV").Insert
'        Columns("CS:DG").Hidden = True
'    Else
'        Columns("CS:DG").Hidden = False
'        Columns("CV:CV").Hidden = True
'        Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1)-$CB3"
'        Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
'        Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
'        Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1)-$CT3"
'        Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
'    End If
'    'Qtr1
'    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
'    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ") & """)-$DI3"
'    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
'    'Qtr2
'    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
'    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """)-$DX3"
'    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
'    'Qtr3
'    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
'    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """)-$EM3"
'    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
'    'Qtr4
'    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
'    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """)-$FB3"
'    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
    myWeekRemain = myWeekRemain * 7
    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$H3"
    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
    If Month("1 " & myInvMth2) / 3 - Int(Month("1 " & myInvMth2) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$Y3"
    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
    If Month("1 " & myInvMth3) / 3 - Int(Month("1 " & myInvMth3) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$AQ3"
    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
    If Month("1 " & myInvMth4) / 3 - Int(Month("1 " & myInvMth4) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$BJ3"
    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
    If myInvMth5 = "" Then
        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BG:BN").Insert
        Columns("CA:CR").Hidden = True
    Else
        If Month("1 " & myInvMth5) / 3 - Int(Month("1 " & myInvMth5) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Columns("CA:CR").Hidden = False
        Columns("CD:CD").Hidden = True
        Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
        Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CB3"
        Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
    End If
    
    If myInvMth6 = "" Then
        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BO:BV").Insert
        Columns("CS:DG").Hidden = True
    Else
        If Month("1 " & myInvMth6) / 3 - Int(Month("1 " & myInvMth6) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Columns("CS:DG").Hidden = False
        Columns("CV:CV").Hidden = True
        Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
        Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CT3"
        Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
    End If
    'Qtr1
    myWeekRemain = myWeekRemain + 91
    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DI3"
    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
    'Qtr2
    myWeekRemain = myWeekRemain + 91
    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DX3"
    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
    'Qtr3
    myWeekRemain = myWeekRemain + 91
    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$EM3"
    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
    'Qtr4
    myWeekRemain = myWeekRemain + 91
    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$FB3"
    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
End Sub
Sub InvertoryProjection2()
    Sheets("Inv Proj (Product)").Select
    myTotalInvProjection = Range("B2").End(xlDown).Row
    myTotalInvProjectionStr1 = Range("B" & myTotalInvProjection + 2).End(xlDown).Row + 1
    myTotalInvProjectionEnd1 = Range("B" & myTotalInvProjectionStr1).End(xlDown).Row

    Range("E1").Value = Date
    Range("E" & myTotalInvProjectionStr1 - 2).Value = Date
    Range("E3:I" & myTotalInvProjection).ClearContents
    Range("E" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).ClearContents
    
    Range("G1").Value = "'" & myInvMth1
    Range("R3:R" & myTotalInvProjection).ClearContents
    Range("G" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth1
    Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).ClearContents
    
    Range("X1").Value = "'" & myInvMth2
    Range("X3:X" & myTotalInvProjection).ClearContents
    Range("X" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth2
    Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).ClearContents
        
    Range("AP1").Value = "'" & myInvMth3
    Range("AP3:AR" & myTotalInvProjection).ClearContents
    Range("AP" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth3
    Range("AP" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).ClearContents
    
    Range("BI1").Value = "'" & myInvMth4
    Range("BI3:BK" & myTotalInvProjection).ClearContents
    Range("BI" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth4
    Range("BI" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).ClearContents
    
    Range("CA1").Value = "'" & myInvMth5
    Range("CA3:CC" & myTotalInvProjection).ClearContents
    Range("CA" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth5
    Range("CA" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).ClearContents
    If myInvMth5 = "" Then
        Columns("CA:CR").Hidden = True
    Else
        Columns("CA:CR").Hidden = False
        Columns("CD:CE").Hidden = True
    End If
        
    Range("CS1").Value = "'" & myInvMth6
    Range("CS3:CU" & myTotalInvProjection).ClearContents
    Range("CS" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth6
    Range("CS" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).ClearContents
    If myInvMth6 = "" Then
        Columns("CS:DG").Hidden = True
    Else
        Columns("CS:DG").Hidden = False
        Columns("CV:CV").Hidden = True
    End If
  
    Range("DH1").Value = myInvQtr1
    Range("DH3:DJ" & myTotalInvProjection).ClearContents
    Range("DH" & myTotalInvProjectionStr1 - 2).Value = myInvQtr1
    Range("DH" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).ClearContents

    Range("DW1").Value = myInvQtr2
    Range("DW3:DY" & myTotalInvProjection).ClearContents
    Range("DW" & myTotalInvProjectionStr1 - 2).Value = myInvQtr2
    Range("DW" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).ClearContents

    Range("EL1").Value = myInvQtr3
    Range("EL3:EN" & myTotalInvProjection).ClearContents
    Range("EL" & myTotalInvProjectionStr1 - 2).Value = myInvQtr3
    Range("EL" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).ClearContents
    
    Range("FA1").Value = myInvQtr4
    Range("FA3:FC" & myTotalInvProjection).ClearContents
    Range("FA" & myTotalInvProjectionStr1 - 2).Value = myInvQtr4
    Range("FA" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).ClearContents
    
    'Get Micron & Harmonic Product Family
    'myHarmonicProductModelFile = Range("B15").Value
    Workbooks.Open Filename:=myHarmonicProductModelFile, ReadOnly:=True
    myHarmonicProductModelFilename = ActiveWorkbook.Name
    Range("A1:B" & Range("A" & Rows.Count).End(xlUp).Row).Copy
        'myMicronProductFile = Range("B19").Value
        Workbooks.Open Filename:=myMicronProductFile, ReadOnly:=True
        myMicronProductFilename = ActiveWorkbook.Name
        ActiveSheet.Name = "Temp"
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
        Application.DisplayAlerts = False
        Workbooks(myHarmonicProductModelFilename).Close False
        Application.DisplayAlerts = True
        Workbooks(myWipInventoryFilename).Activate
        Sheets("Detail WIP").Select
        myWipInvTotal = Range("G" & Rows.Count).End(xlUp).Row
        Range("C5:C" & myWipInvTotal).Value = "=VLOOKUP(G5,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
        Range("C5:C" & myWipInvTotal).Value = Range("C5:C" & myWipInvTotal).Value
        Sheets("PV").Select
        ActiveSheet.PivotTables("PivotTable9").PivotCache.Refresh
        ActiveSheet.PivotTables("PivotTable9").PivotFields("Plan Fmly").ClearAllFilters
        Workbooks(myRawMaterialFilename).Activate
        Sheets("Detail").Select
        myWipInvTotal = Range("B" & Rows.Count).End(xlUp).Row
        Range("B5:B" & myWipInvTotal).Value = "=VLOOKUP(F5,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
        Range("B5:B" & myWipInvTotal).Value = Range("B5:B" & myWipInvTotal).Value
        Sheets("Summary").Select
        ActiveSheet.PivotTables("PivotTable8").PivotCache.Refresh
        ActiveSheet.PivotTables("PivotTable8").PivotFields("MPF").ClearAllFilters
    Workbooks(myProjectedInvFilename).Activate
    'Total Inventory(07)
    Range("E3:E" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP(B3,'[" & myWipInventoryFilename & "]PV'!$A:$B,2,0),0)+IFERROR(VLOOKUP(B3,'[" & myRawMaterialFilename & "]Summary'!$A:$F,5,0),0)"
    Range("E3:E" & myTotalInvProjection).Value = Range("E3:E" & myTotalInvProjection).Value
    Range("E" & myTotalInvProjectionStr1 & ":E" & myTotalInvProjectionEnd1).Value = "=IFERROR(VLOOKUP(B" & myTotalInvProjectionStr1 & ",'[" & myWipInventoryFilename & "]PV'!$A:$B,2,0),0)+IFERROR(VLOOKUP(B" & myTotalInvProjectionStr1 & ",'[" & myRawMaterialFilename & "]Summary'!$A:$F,5,0),0)"
    Range("E" & myTotalInvProjectionStr1 & ":E" & myTotalInvProjectionEnd1).Value = Range("E" & myTotalInvProjectionStr1 & ":E" & myTotalInvProjectionEnd1).Value

    'Total Shipped
    Workbooks(mySrsFilename).Activate
    Sheets("SRS").Select
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(BD3=""SO"",BD3=""S1"",BD3=""CO""),Row(BD3),""Delete"")"
    Range("BE3:BE" & mySrsTotal).Value = Range("BE3:BE" & mySrsTotal).Value
    Range("A3:BE" & mySrsTotal).RemoveDuplicates Columns:=57, Header:=xlNo
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    'Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(RIGHT(TRIM(H3),3)=""-MF"",RIGHT(TRIM(H3),3)=""-SW"",RIGHT(TRIM(H3),3)=""-CW"",RIGHT(TRIM(H3),2)=""-S"",RIGHT(TRIM(H3),2)=""-W"",RIGHT(TRIM(H3),2)=""-C""),Row(BD3),""Delete"")"
    Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(RIGHT(TRIM(H3),3)=""-MF"",RIGHT(TRIM(H3),3)=""-SW"",RIGHT(TRIM(H3),2)=""-S"",RIGHT(TRIM(H3),2)=""-W"",RIGHT(TRIM(H3),2)=""-C""),Row(BD3),""Delete"")"
    Range("BE3:BE" & mySrsTotal).Value = Range("BE3:BE" & mySrsTotal).Value
    Range("A3:BE" & mySrsTotal).RemoveDuplicates Columns:=57, Header:=xlNo
    Range("G4:G" & mySrsTotal).Value = "=VLOOKUP(B4,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("G4:G" & mySrsTotal).Value = Range("G4:G" & mySrsTotal).Value
    Sheets("Shipped Not Yet Billed Report").Select
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("AB4:AB" & mySrsTotal).Value = "=IF(OR(G4=""SO"",G4=""S1"",G4=""CO""),Row(G4),""Delete"")"
    Range("AB4:AB" & mySrsTotal).Value = Range("AB4:AB" & mySrsTotal).Value
    Range("A4:BE" & mySrsTotal).RemoveDuplicates Columns:=28, Header:=xlNo
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("G4:G" & mySrsTotal).Value = "=VLOOKUP(K4,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("G4:G" & mySrsTotal).Value = Range("G4:G" & mySrsTotal).Value
    Workbooks(myProjectedInvFilename).Activate
    Range("R3:R" & myTotalInvProjection).Value = "=SUMIF('[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$G:$G,B3,'[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$V:$V)+SUMIF('[" & mySrsFilename & "]SRS'!$G:$G,B3,'[" & mySrsFilename & "]SRS'!$Z:$Z)"
    Range("R3:R" & myTotalInvProjection).Value = Range("R3:R" & myTotalInvProjection).Value
    Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).Value = "=SUMIF('[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$G:$G,B" & myTotalInvProjectionStr1 & ",'[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$V:$V)+SUMIF('[" & mySrsFilename & "]SRS'!$G:$G,B" & myTotalInvProjectionStr1 & ",'[" & mySrsFilename & "]SRS'!$Z:$Z)"
    Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).Value = Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).Value
    
    'Projected PO
    Workbooks(myProjectedPoFilename).Activate
    Sheets("PO").Select
    myProPoTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("B4:B" & myProPoTotal).Value = "=VLOOKUP(Q4,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("B4:B" & myProPoTotal).Value = Range("B4:B" & myProPoTotal).Value
    Sheets("PV").Select
    ActiveSheet.PivotTables("PivotTable2").PivotCache.Refresh
    ActiveSheet.PivotTables("PivotTable2").PivotFields("Family").ClearAllFilters
    Workbooks(myProjectedInvFilename).Activate
    'Month
    Range("G3:G" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("G3:G" & myTotalInvProjection).Value = Range("G3:G" & myTotalInvProjection).Value
    Range("X3:X" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("X3:X" & myTotalInvProjection).Value = Range("X3:X" & myTotalInvProjection).Value
    Range("AP3:AP" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("AP3:AP" & myTotalInvProjection).Value = Range("AP3:AP" & myTotalInvProjection).Value
    Range("BI3:BI" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth4, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("BI3:BI" & myTotalInvProjection).Value = Range("BI3:BI" & myTotalInvProjection).Value
    Range("CA3:CA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth5, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CA3:CA" & myTotalInvProjection).Value = Range("CA3:CA" & myTotalInvProjection).Value
    Range("CS3:CS" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth6, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CS3:CS" & myTotalInvProjection).Value = Range("CS3:CS" & myTotalInvProjection).Value
    Range("G" & myTotalInvProjectionStr1 & ":G" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("G" & myTotalInvProjectionStr1 & ":G" & myTotalInvProjectionEnd1).Value = Range("G" & myTotalInvProjectionStr1 & ":G" & myTotalInvProjectionEnd1).Value
    Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).Value = Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).Value
    Range("AP" & myTotalInvProjectionStr1 & ":AP" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("AP" & myTotalInvProjectionStr1 & ":AP" & myTotalInvProjectionEnd1).Value = Range("AP" & myTotalInvProjectionStr1 & ":AP" & myTotalInvProjectionEnd1).Value
    Range("BI" & myTotalInvProjectionStr1 & ":BI" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth4, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("BI" & myTotalInvProjectionStr1 & ":BI" & myTotalInvProjectionEnd1).Value = Range("BI" & myTotalInvProjectionStr1 & ":BI" & myTotalInvProjectionEnd1).Value
    Range("CA" & myTotalInvProjectionStr1 & ":CA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth5, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("CA" & myTotalInvProjectionStr1 & ":CA" & myTotalInvProjectionEnd1).Value = Range("CA" & myTotalInvProjectionStr1 & ":CA" & myTotalInvProjectionEnd1).Value
    Range("CS" & myTotalInvProjectionStr1 & ":CS" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth6, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("CS" & myTotalInvProjectionStr1 & ":CS" & myTotalInvProjectionEnd1).Value = Range("CS" & myTotalInvProjectionStr1 & ":CS" & myTotalInvProjectionEnd1).Value
        
    'Quarter1
    If myQtr1_1 <> "" Then
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
    End If
    If myQtr1_2 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DI" & myTotalInvProjectionStr1
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).ClearContents
    End If
    If myQtr1_3 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DI" & myTotalInvProjectionStr1
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).ClearContents
    End If
    'Quarter2
    If Range("DK2").Value <> "FOB" Then
        Range("DK2").Value = "FOB"
        Columns("DK:DK").Insert
        Columns("DK:DK").Hidden = True
    End If
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).ClearContents
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).ClearContents
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DX" & myTotalInvProjectionStr1
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).ClearContents
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DX" & myTotalInvProjectionStr1
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).ClearContents
    'Quarter3
    If Range("DZ2").Value <> "FOB" Then
        Range("DZ2").Value = "FOB"
        Columns("DZ:DZ").Insert
        Columns("DZ:DZ").Hidden = True
    End If
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).ClearContents
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).ClearContents
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+EM" & myTotalInvProjectionStr1
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).ClearContents
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+EM" & myTotalInvProjectionStr1
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).ClearContents
    'Quarter4
    If Range("EO2").Value <> "FOB" Then
        Range("EO2").Value = "FOB"
        Columns("EO:EO").Insert
        Columns("EO:EO").Hidden = True
    End If
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+FB3"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).ClearContents
    'Range("FB3:BF" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+BF3"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).ClearContents
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+FB" & myTotalInvProjectionStr1
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).ClearContents
        'Range("FB" & myTotalInvProjectionStr1 & ":BF" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+BF" & myTotalInvProjectionStr1
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).ClearContents
    
    'Planned Discrete Order & Planned SCM Order
    Workbooks(myPoYetToPlaceFilename).Activate
        'Ver2.3: No longer using Po Yet to Place
        Sheets("Details").Copy After:=Sheets(Sheets.Count)
        ActiveSheet.Name = "Temp"
    Sheets("Details").Select
    myProPoTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("D5:D" & myProPoTotal).Value = "=VLOOKUP(B5,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("D5:D" & myProPoTotal).Value = Range("D5:D" & myProPoTotal).Value
    'Sheets("PV").Select
    'ActiveSheet.PivotTables("PivotTable1").PivotCache.Refresh
    'ActiveSheet.PivotTables("PivotTable1").PivotFields("LeadTime").ClearAllFilters
    Workbooks(myProjectedInvFilename).Activate
    'Ver1.4: Change logic from Leadtime + today's date to just consider leadtime only
'    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
'    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1)-$H3"
'    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
'    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
'    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1)-$Y3"
'    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
'    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
'    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1)-$AQ3"
'    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
'    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
'    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1)-$BJ3"
'    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
'
'    Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
'
'    Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1)-$CB3"
'    Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
'    Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
'    Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1)-$CT3"
'    Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
'
'    'Qtr1
'    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
'    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ") & """)-$DI3"
'    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
'    'Qtr2
'    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
'    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """)-$DX3"
'    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
'    'Qtr3
'    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
'    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """)-$EM3"
'    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
'    'Qtr4
'    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
'    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """)-$FB3"
'    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
'    'Product Family 2nd table
'    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value
'    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1)-$H" & myTotalInvProjectionStr1
'    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value
'    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value
'    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1)-$Y" & myTotalInvProjectionStr1
'    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value
'    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value
'    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1)-$AQ" & myTotalInvProjectionStr1
'    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value
'    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value
'    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1)-$BJ" & myTotalInvProjectionStr1
'    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value
'
'    Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value
'    Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1)-$CB" & myTotalInvProjectionStr1
'        Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value
'        Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value
'        Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1)-$CT" & myTotalInvProjectionStr1
'        Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value
'
'    'Qtr1
'    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value
'    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ") & """)-$DI" & myTotalInvProjectionStr1
'    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value
'    'Qtr2
'    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value
'    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """)-$DX" & myTotalInvProjectionStr1
'    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value
'    'Qtr3
'    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value
'    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """)-$EM" & myTotalInvProjectionStr1
'    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value
'    'Qtr4
'    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value
'    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """)-$FB" & myTotalInvProjectionStr1
'    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value
    
    myWeekRemain = Workbooks(myMacroFile).Sheets("Macro").Range("K61").Value
    myWeekRemain = myWeekRemain * 7
    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$H3"
    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
    
    If Month("1 " & myInvMth2) / 3 - Int(Month("1 " & myInvMth2) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$Y3"
    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
    
    If Month("1 " & myInvMth3) / 3 - Int(Month("1 " & myInvMth3) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$AQ3"
    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
    
    If Month("1 " & myInvMth4) / 3 - Int(Month("1 " & myInvMth4) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$BJ3"
    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
    
    If myInvMth5 = "" Then
        Columns("CA:CR").Hidden = True
    Else
        If Month("1 " & myInvMth5) / 3 - Int(Month("1 " & myInvMth5) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
        Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CB3"
        Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
    End If
    
    If myInvMth6 = "" Then
        Columns("CA:DG").Hidden = True
    Else
        If Month("1 " & myInvMth6) / 3 - Int(Month("1 " & myInvMth6) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
        Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CT3"
        Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
    End If
    'Qtr1
    myWeekRemain = myWeekRemain + 91
    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DI3"
    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
    'Qtr2
    myWeekRemain = myWeekRemain + 91
    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DX3"
    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
    'Qtr3
    myWeekRemain = myWeekRemain + 91
    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$EM3"
    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
    'Qtr4
    myWeekRemain = myWeekRemain + 91
    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$FB3"
    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
    'Product Family 2nd table
    myWeekRemain = Workbooks(myMacroFile).Sheets("Macro").Range("K61").Value
    myWeekRemain = myWeekRemain * 7
    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value
    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$H" & myTotalInvProjectionStr1
    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value
    
    If Month("1 " & myInvMth2) / 3 - Int(Month("1 " & myInvMth2) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value
    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$Y" & myTotalInvProjectionStr1
    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value
    
    If Month("1 " & myInvMth3) / 3 - Int(Month("1 " & myInvMth3) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value
    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$AQ" & myTotalInvProjectionStr1
    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value
    
    If Month("1 " & myInvMth4) / 3 - Int(Month("1 " & myInvMth4) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value
    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$BJ" & myTotalInvProjectionStr1
    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value
    
    If myInvMth5 = "" Then
        
    Else
        If Month("1 " & myInvMth5) / 3 - Int(Month("1 " & myInvMth5) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                         & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
            Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value
        Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CB" & myTotalInvProjectionStr1
            Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value
    End If
    
    If myInvMth6 = "" Then
        
    Else
        If Month("1 " & myInvMth6) / 3 - Int(Month("1 " & myInvMth6) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
            Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                         & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
            Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value
            Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CT" & myTotalInvProjectionStr1
            Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value
    End If
    
    'Qtr1
    myWeekRemain = myWeekRemain + 91
    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value
    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DI" & myTotalInvProjectionStr1
    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value
    'Qtr2
    myWeekRemain = myWeekRemain + 91
    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value
    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DX" & myTotalInvProjectionStr1
    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value
    'Qtr3
    myWeekRemain = myWeekRemain + 91
    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value
    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$EM" & myTotalInvProjectionStr1
    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value
    'Qtr4
    myWeekRemain = myWeekRemain + 91
    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value
    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$FB" & myTotalInvProjectionStr1
    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value
End Sub
Sub ProductModelCheck()
    myMacroFile = ActiveWorkbook.Name
    myMacroPath = ActiveWorkbook.Path
    myStrTime = Time
    Range("A54:F" & Rows.Count).ClearContents
    Application.DisplayAlerts = False
    myBucketReportFile = Range("B13").Value
    myHarmonicProductModelFile = Range("B15").Value
    myMicronProductFile = Range("B19").Value
    myOpenPoFile = Range("B27").Value
    myRawMaterialFile = Range("B29").Value
    mySrsFile = Range("B33").Value
    myWipInventoryFile = Range("B35").Value
    
    Workbooks.Open Filename:=myHarmonicProductModelFile, ReadOnly:=True
    myHarmonicProductModelFilename = ActiveWorkbook.Name
    Range("A1:B" & Range("A" & Rows.Count).End(xlUp).Row).Copy
        Workbooks.Open Filename:=myMicronProductFile, ReadOnly:=True
        myMicronProductFilename = ActiveWorkbook.Name
        ActiveSheet.Name = "Temp"
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    Workbooks.Open Filename:=myBucketReportFile, ReadOnly:=True
    myBucketReportFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("A" & Rows.Count).End(xlUp).Row
        'Ver1.6: Format change afte JDE upgrade
        'Range("A1:DK" & myTempTotal).RemoveDuplicates Columns:=2, Header:=xlNo
        Range("A1:DK" & myTempTotal).RemoveDuplicates Columns:=5, Header:=xlNo
        Columns("E:F").Cut
        Columns("B:B").Insert
        myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
        'Range("A1:A" & myTempTotal).Value = "=IF(OR(D1=148,D1=321,D1=586),IF(DB1>0,IFERROR(VLOOKUP(B1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),""""),"""")"
        Range("A1:A" & myTempTotal).Value = "=IF(OR(D1=""148"",D1=""321"",D1=""586""),IF(DS1>0,IFERROR(VLOOKUP(B1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),""""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:DK" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myBucketTotal = Range("B" & Rows.Count).End(xlUp).Row
    If myBucketTotal > 1 Then
        Range("B2:B" & myBucketTotal).Copy
        Workbooks(myMacroFile).Activate
        Range("A54").PasteSpecial xlPasteValues
    End If
    Workbooks(myBucketReportFilename).Close False
    
    Workbooks.Open Filename:=myOpenPoFile, ReadOnly:=True
    myOpenPoFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("Q" & Rows.Count).End(xlUp).Row
    Range("A1:BG" & myTempTotal).RemoveDuplicates Columns:=17, Header:=xlNo
    myTempTotal = Range("Q" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(B1=148,B1=321,B1=586),IFERROR(VLOOKUP(Q1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:BG" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myTempTotal = Range("Q" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("Q2:Q" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("B54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(myOpenPoFilename).Close False
    
    Workbooks.Open Filename:=myRawMaterialFile, ReadOnly:=True
    Sheets("Detail").Select
    myRawMaterialFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("F" & Rows.Count).End(xlUp).Row
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=6, Header:=xlNo
    myTempTotal = Range("F" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(B1=148,B1=321,B1=586),IFERROR(VLOOKUP(F1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myTempTotal = Range("F" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("F2:F" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("C54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(myRawMaterialFilename).Close False
    
    Workbooks.Open Filename:=mySrsFile, ReadOnly:=True
    Sheets("SRS").Select
    mySrsFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=2, Header:=xlNo
    myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(G1=148,G1=321,G1=586),IFERROR(VLOOKUP(B1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("B2:B" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("D54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(mySrsFilename).Activate
        Sheets("Shipped Not Yet Billed Report").Select
        If ActiveSheet.AutoFilterMode = True Then
           Rows("3:3").AutoFilter
        End If
        ActiveSheet.Name = "Temp1"
            If Range("B3").Value = "" Then
                Rows("3:3").Delete
            End If
            If Range("B2").Value = "" Then
                Rows("2:2").Delete
            End If
            If Range("B1").Value = "" Then
                Rows("1:1").Delete
            End If
        myTempTotal = Range("K" & Rows.Count).End(xlUp).Row
        Range("A1:AA" & myTempTotal).RemoveDuplicates Columns:=11, Header:=xlNo
        myTempTotal = Range("K" & Rows.Count).End(xlUp).Row
        Range("A1:A" & myTempTotal).Value = "=IF(OR(X1=148,X1=321,X1=586),IFERROR(VLOOKUP(K1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
        Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
        Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
        Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
        Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
        myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
        If myTempTotal > 1 Then
            Range("B2:B" & myTempTotal).Copy
            Workbooks(myMacroFile).Activate
            'Range("E54").PasteSpecial xlPasteValues
            Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
        End If
    Workbooks(mySrsFilename).Close False
    
    Workbooks.Open Filename:=myWipInventoryFile, ReadOnly:=True
    Sheets("Detail WIP").Select
    myWipInventoryFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("G" & Rows.Count).End(xlUp).Row
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=7, Header:=xlNo
    myTempTotal = Range("G" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(C1=148,C1=321,C1=586),IFERROR(VLOOKUP(G1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("B1:B" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("B1:B" & myTempTotal).Value = Range("B1:B" & myTempTotal).Value
    Range("A1:M" & myTempTotal).RemoveDuplicates Columns:=2, Header:=xlNo
    myTempTotal = Range("G" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("G2:G" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("F54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(myWipInventoryFilename).Close False
    Workbooks(myHarmonicProductModelFilename).Close False
    Workbooks(myMicronProductFilename).Close False
    Workbooks(myMacroFile).Activate
    If Range("A" & Rows.Count).End(xlUp).Row > 53 Then
        Range("A53:A" & Range("A" & Rows.Count).End(xlUp).Row).RemoveDuplicates Columns:=1, Header:=xlNo
    End If
    Columns("A:F").EntireColumn.AutoFit
    Application.DisplayAlerts = True
    myEndTime = Time
    Range("A1").Select
    MsgBox "Done in " & Format(myEndTime - myStrTime, "hh:mm:ss")
End Sub
Sub ErrHnd1()
    On Error GoTo Err1
    Sheets("Aging Parts Details (ISL)").Select
    ActiveSheet.Name = "Aging Parts Details (ISL)2"
    Exit Sub
Err1:
End Sub
Sub ErrHnd2()
    On Error GoTo Err2
    Sheets("PV").Select
    ActiveSheet.Name = "PV_2"
    Exit Sub
Err2:
End Sub
    
