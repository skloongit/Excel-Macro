    Dim myMacroFile As String
    Dim myInvMth1  As String
    Dim myInvMth2  As String
    Dim myInvMth3  As String
    Dim myInvMth4  As String
    Dim myInvMth5  As String
    Dim myInvMth6  As String
    Dim myInvMthFob1  As String
    Dim myInvMthFob2  As String
    Dim myInvMthFob3  As String
    Dim myInvMthFob4  As String
    Dim myInvMthFob5  As String
    Dim myInvMthFob6  As String
    Dim myInvQtr1  As String
    Dim myInvQtr2  As String
    Dim myInvQtr3  As String
    Dim myInvQtr4  As String
    Dim myInvQtrFob1  As String
    Dim myInvQtrFob2  As String
    Dim myInvQtrFob3  As String
    Dim myInvQtrFob4  As String
    Dim myQtr1_1  As String
    Dim myQtr1_2  As String
    Dim myQtr1_3  As String
    Dim myQtr2_1  As String
    Dim myQtr2_2  As String
    Dim myQtr2_3  As String
    Dim myQtr3_1  As String
    Dim myQtr3_2  As String
    Dim myQtr3_3  As String
    Dim myQtr4_1  As String
    Dim myQtr4_2  As String
    Dim myQtr4_3  As String
    Dim myPoYetToStartDate As String
    Dim myBucketReportFilename  As String
    Dim myHarmonicProductModelFilename As String
    Dim myHarmonicRevenueFilename As String
    Dim myMicronProductFilename As String
    Dim myMicronRevenueFilename As String
    Dim myHarmonicProductModelFile As String
    Dim myHarmonicRevenueFile As String
    Dim myMicronProductFile As String
    Dim myMicronRevenueFile As String
    Dim myCurrentVsBaseFilename  As String
    Dim mySalesFilename  As String
    Dim myOpenPoFilename  As String
    Dim myRawMaterialFilename  As String
    Dim mySmiAgingFilename  As String
    Dim mySrsFilename As String
    Dim myWipInventoryFilename  As String
    Dim myPoYetToPlaceFilename As String
    Dim myPurchasingDataFilename  As String
    Dim myProjectedPoFilename  As String
    Dim myProjectedInvFilename  As String
    Dim mySalesOnlyFilename  As String
    Dim myCognosTrendFilename  As String
    Dim mySalesOnlySheetname As String
    Dim myWeekRemain As String
    
Sub FileSelect()
    myRow = ActiveSheet.Shapes(Application.Caller).BottomRightCell.Row
    myGetFile = Application.GetOpenFilename(, , "Please select " & Range("A" & myRow).Value & " file:")
        If myGetFile = False Then
            End
        Else
            mySelect = myGetFile
            Range("B" & myRow).Value = mySelect
        End If
End Sub
Sub InventoryProjection1()
    myMacroFile = ActiveWorkbook.Name
    myMacroPath = ActiveWorkbook.Path
    myStrTime = Time
    
    myInvMth1 = Range("J54").Value
    myInvMth2 = Range("J55").Value
    myInvMth3 = Range("J56").Value
    myInvMth4 = Range("J57").Value
    myInvMth5 = Range("J58").Value
    myInvMth6 = Range("J59").Value
    myInvMthFob1 = Range("K54").Value
    myInvMthFob2 = Range("K55").Value
    myInvMthFob3 = Range("K56").Value
    myInvMthFob4 = Range("K57").Value
    myInvMthFob5 = Range("K58").Value
    myInvMthFob6 = Range("K59").Value
    myInvQtr1 = Range("L54").Value
    myInvQtr2 = Range("L55").Value
    myInvQtr3 = Range("L56").Value
    myInvQtr4 = Range("L57").Value
    myInvQtrFob1 = Range("M54").Value
    myInvQtrFob2 = Range("M55").Value
    myInvQtrFob3 = Range("M56").Value
    myInvQtrFob4 = Range("M57").Value
    
    'Ver2.8:
    If InStr(1, myQtr1_1, " ") > 0 Then
        myQtr1_1 = Replace(Range("N54").Value, " ", "'")
    Else
        myQtr1_1 = Format(Range("N54").Value, "Mmm'Yy")
    End If
    'myQtr1_1 = Replace(Range("N54").Value, " ", "'")
    myQtr1_2 = Format(Range("O54").Value, "Mmm'Yy")
    myQtr1_3 = Format(Range("P54").Value, "Mmm'Yy")
    myQtr2_1 = Format(Range("N55").Value, "Mmm'Yy")
    myQtr2_2 = Format(Range("O55").Value, "Mmm'Yy")
    myQtr2_3 = Format(Range("P55").Value, "Mmm'Yy")
    myQtr3_1 = Format(Range("N56").Value, "Mmm'Yy")
    myQtr3_2 = Format(Range("O56").Value, "Mmm'Yy")
    myQtr3_3 = Format(Range("P56").Value, "Mmm'Yy")
    myQtr4_1 = Format(Range("N57").Value, "Mmm'Yy")
    myQtr4_2 = Format(Range("O57").Value, "Mmm'Yy")
    myQtr4_3 = Format(Range("P57").Value, "Mmm'Yy")

    'myPoYetToStartDate = Range("Q37").Value
    myBucketReportFile = Range("B13").Value
    myHarmonicProductModelFile = Range("B15").Value
    myHarmonicRevenueFile = Range("B17").Value
    myMicronProductFile = Range("B19").Value
    myMicronRevenueFile = Range("B21").Value
    myCurrentVsBaseFile = Range("B23").Value
    mySalesFile = Range("B25").Value
    myOpenPoFile = Range("B27").Value
    myRawMaterialFile = Range("B29").Value
    mySmiAgingFile = Range("B31").Value
    mySrsFile = Range("B33").Value
    myWipInventoryFile = Range("B35").Value
    myPoYetToPlaceFile = Range("B37").Value
    myPurchasingDataFile = Range("B39").Value
    myProjectedPoFile = Range("B41").Value
    myProjectedInvFile = Range("B43").Value
    mySalesOnlyFile = Range("B45").Value
    myCognosTrendFile = Range("B47").Value
    'Ver1.4: Add in week remain for month 1
    myWeekRemain = Range("K61").Value
    
    '16 Weeks Bucket MPF/Open PO
    myTotalBucketMpf = Sheets("Configuration").Range("A" & Rows.Count).End(xlUp).Row
    For myA = 2 To myTotalBucketMpf
        'Ver2.0: 16 bucket file format change
        '''Ver1.8: 1
        ''myOverallBucketMpf = myOverallBucketMpf & "RC[-1]&""""=""" & Sheets("Configuration").Range("A" & myA).Value & ""","
        'myOverallBucketMpf = myOverallBucketMpf & "RC[-1]&""""=""" & Format(Sheets("Configuration").Range("A" & myA).Value, "000") & ""","
        myOverallBucketMpf = myOverallBucketMpf & "TEXT(RC[-1],""000"")=""" & Format(Sheets("Configuration").Range("A" & myA).Value, "000") & ""","
    Next myA
    myOverallOpenMpf = "=IF(OR(" & Left(myOverallBucketMpf, Len(myOverallBucketMpf) - 1) & "),ROW(RC[-1]),""Delete"")"
    myOverallBucketMpf = "=IF(OR(" & Left(myOverallBucketMpf, Len(myOverallBucketMpf) - 1) & "),""Delete"",ROW(RC[-1]))"
    
    'Open PO: Order Type
    myTotalOrderType = Sheets("Configuration").Range("C" & Rows.Count).End(xlUp).Row
    For myA = 2 To myTotalOrderType
        myOverallOrderType = myOverallOrderType & "RC[-1]&""""=""" & Sheets("Configuration").Range("C" & myA).Value & ""","
    Next myA
    myOverallOrderType = "=IF(OR(" & Left(myOverallOrderType, Len(myOverallOrderType) - 1) & "),ROW(RC[-1]),""Delete"")"

    Workbooks.Open myRawMaterialFile, , True
    myRawMaterialFilename = ActiveWorkbook.Name
    myRawMaterialSheetname = ActiveSheet.Name
    
    Workbooks.Open Filename:=myWipInventoryFile, ReadOnly:=True
    'Sheets("Detail WIP").Select
    myWipInventoryFilename = ActiveWorkbook.Name
    
    Workbooks.Open mySrsFile, , True
    mySrsFilename = ActiveWorkbook.Name
        'Ver2.6:
        Sheets("SRS").Select
        mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
            'Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(BD3=""SO"",BD3=""S1"",BD3=""CO""),Row(BD3),""Delete"")"
            Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(L3=""SO"",L3=""S1"",L3=""CO""),Row(L3),""Delete"")"
        Range("BE3:BE" & mySrsTotal).Value = Range("BE3:BE" & mySrsTotal).Value
        Range("A3:BE" & mySrsTotal).RemoveDuplicates Columns:=57, Header:=xlNo
        mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
        'Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(RIGHT(TRIM(H3),3)=""-MF"",RIGHT(TRIM(H3),3)=""-SW"",RIGHT(TRIM(H3),3)=""-CW"",RIGHT(TRIM(H3),2)=""-S"",RIGHT(TRIM(H3),2)=""-W"",RIGHT(TRIM(H3),2)=""-C""),Row(BD3),""Delete"")"
            'Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(RIGHT(TRIM(H3),3)=""-MF"",RIGHT(TRIM(H3),3)=""-SW"",RIGHT(TRIM(H3),2)=""-S"",RIGHT(TRIM(H3),2)=""-W"",RIGHT(TRIM(H3),2)=""-C""),Row(BD3),""Delete"")"
            Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(TRIM(J3)=""MF"",TRIM(J3)=""SW"",TRIM(J3)=""S"",TRIM(J3)=""W"",TRIM(J3)=""C""),Row(J3),""Delete"")"
        Range("BE3:BE" & mySrsTotal).Value = Range("BE3:BE" & mySrsTotal).Value
        Range("A3:BE" & mySrsTotal).RemoveDuplicates Columns:=57, Header:=xlNo
        
        Sheets("Shipped Not Yet Billed Report").Select
        mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
        Range("AB4:AB" & mySrsTotal).Value = "=IF(OR(G4=""SO"",G4=""S1"",G4=""CO""),Row(G4),""Delete"")"
        Range("AB4:AB" & mySrsTotal).Value = Range("AB4:AB" & mySrsTotal).Value
        Range("A4:BE" & mySrsTotal).RemoveDuplicates Columns:=28, Header:=xlNo
        mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    
        'Refresh Pivot Table at Summary Sheet & PV
        Sheets("Summary").Select
            'ActiveSheet.PivotTables("PivotTable5").PivotCache.Refresh
            ActiveSheet.PivotTables("PivotTable2").PivotCache.Refresh
        Sheets("PV").Select
            'ActiveSheet.PivotTables("PivotTable10").PivotCache.Refresh
            ActiveSheet.PivotTables("PivotTable3").PivotCache.Refresh
        Sheets("Summary").Select
            Columns("D:D").Copy
            Columns("C:C").PasteSpecial xlValues
    
    Workbooks.Open Filename:=myProjectedPoFile, ReadOnly:=True
    myProjectedPoFilename = ActiveWorkbook.Name
    
    'Ver2.3: Eliminate PO Yet to place
    'Workbooks.Open myPoYetToPlaceFile, , True
    'myPoYetToPlaceFilename = ActiveWorkbook.Name
    ''myPoYetToPlacetSheetname = ActiveSheet.Name
    'Sheets.Add After:=ActiveSheet
    'Sheets("Details").Select
    ''Range("O1").Value = myPoYetToStartDate
    'myPoYetToPlaceTotal = Range("A" & Rows.Count).End(xlUp).Row
    'Range("N4").Value = "Today + Lead time"
    'Range("N5:N" & myPoYetToPlaceTotal).Value = "=M5+$O$1"
    'Range("N5:N" & myPoYetToPlaceTotal).Value = Range("N5:N" & myPoYetToPlaceTotal).Value
    'Range("O4").Value = "Mmm Yy"
    'Range("O5:O" & myPoYetToPlaceTotal).Value = "=SUBSTITUTE(IFERROR(VLOOKUP(N5,'[" & myProjectedPoFilename & "]Calendar'!$A:$B,2,0),0),""'"","" "")"
    ''Range("O5:O" & myPoYetToPlaceTotal).Value = Range("M5:M" & myPoYetToPlaceTotal).Value
    'Range("H5:H" & myPoYetToPlaceTotal).Value = "=TRIM(I5)"
    'Range("H5:H" & myPoYetToPlaceTotal).Value = Range("H5:H" & myPoYetToPlaceTotal).Value
    'Range("I5:I" & myPoYetToPlaceTotal).Value = Range("H5:H" & myPoYetToPlaceTotal).Value
    'Columns("EY:FI").ClearContents
    
    Workbooks.Open myPurchasingDataFile, ReadOnly:=True
    myPurchasingDataFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    
    Workbooks.Open myBucketReportFile, , True
    myBucketReportFilename = ActiveWorkbook.Name
        'Ver2.3: Eliminate PO Yet to place
        myPoYetToPlaceFilename = ActiveWorkbook.Name
        'myBucketReportSheetname = ActiveSheet.Name
        ActiveSheet.Name = "Details"
    
    myTotal = Range("B" & Rows.Count).End(xlUp).Row
        'Ver1.6: Change format due to JDE upgrade
        'Columns("E:E").Insert
        'Range("E4").Value = "Delete"
        'Range("E5:E" & myTotal).Value = myOverallOpenMpf
        'Range("E5:E" & myTotal).Value = Range("E5:E" & myTotal).Value
        'Range("A4:DL" & myTotal).RemoveDuplicates Columns:=5, Header:=xlNo
        'myTotal = Range("B" & Rows.Count).End(xlUp).Row
        'Columns("E:E").Delete
        Columns("C:C").Insert
        Range("C3").Value = "Delete"
        Range("C4:C" & myTotal).Value = myOverallOpenMpf
        Range("C4:C" & myTotal).Value = Range("C4:C" & myTotal).Value
            'Ver1.8: 16 bucket format change after JDE upgrade
            'Range("A3:DL" & myTotal).RemoveDuplicates Columns:=3, Header:=xlNo
            Range("A3:EG" & myTotal).RemoveDuplicates Columns:=3, Header:=xlNo
        myTotal = Range("B" & Rows.Count).End(xlUp).Row
        Columns("C:C").Delete
    ActiveSheet.Name = "Details"
    
    Application.ScreenUpdating = False
    'Ver1.6: Change format after JDE upgrade
'    Columns("Y:Y").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("AF:AH").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("AN:AP").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("AV:AX").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("BD:BF").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("BL:BN").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("BT:BV").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("CB:CD").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("CJ:CL").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("CR:CT").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("CZ:DB").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("DH:DJ").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("DP:DR").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("DX:DZ").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("EF:EH").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("EN:EP").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Columns("EV:EX").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
'    Range("Y4").Value = "EC"
'    Range("Y4").Font.Color = 16777215 'White
'    Range("Y4").Interior.Color = 9851952 'Dark Blue
'    'Application.ScreenUpdating = False
'    For myA = 1 To 16
'        Cells(4, myA * 8 + 24).Value = "Bucket" & myA & " Shortages Qty"
'        Cells(4, myA * 8 + 25).Value = "Bucket" & myA & " Shortages Qty(SPQ)"
'        Cells(4, myA * 8 + 26).Value = "Bucket" & myA & " Shortages $$"
'        Range(Cells(4, myA * 8 + 24), Cells(4, myA * 8 + 26)).Interior.Color = 65535
'        If myA = 1 Then
'            Range(Cells(5, myA * 8 + 24), Cells(myTotal, myA * 8 + 24)).Value = "=RC[-11]-RC[-10]+RC[-5]+RC[-4]-RC[-3]-RC[-22]"
'            Range(Cells(5, myA * 8 + 25), Cells(myTotal, myA * 8 + 25)).Value = "=IF(AND((RC18>0),(RC[-1]<0)),CEILING(-RC[-1],RC18),(RC[-1]*(-1)))"
'            Range(Cells(5, myA * 8 + 26), Cells(myTotal, myA * 8 + 26)).Value = "=IF(RC[-1]>0,(RC[-1]*RC25),0)"
'        Else
'            Range(Cells(5, myA * 8 + 24), Cells(myTotal, myA * 8 + 24)).Value = "=IF(RC[-8]<0,RC[-7]+RC[-8]+RC[-5]+RC[-4]-RC[-3],RC[-8]+RC[-5]+RC[-4]-RC[-3])"
'            Range(Cells(5, myA * 8 + 25), Cells(myTotal, myA * 8 + 25)).Value = "=IF(AND((RC18>0),(RC[-1]<0)),CEILING(-RC[-1],RC18),(RC[-1]*(-1)))"
'            Range(Cells(5, myA * 8 + 26), Cells(myTotal, myA * 8 + 26)).Value = "=IF(RC[-1]>0,(RC[-1]*RC25),0)"
'        End If
'        Range(Cells(5, myA * 8 + 24), Cells(myTotal, myA * 8 + 25)).NumberFormat = "_(* #,##0_);_(* (#,##0);_(* ""-""??_);_(@_)"
'        Range(Cells(5, myA * 8 + 26), Cells(myTotal, myA * 8 + 26)).NumberFormat = "_($* #,##0_);_($* (#,##0);_($* ""-""??_);_(@_)"
'    Next myA
'    Application.ScreenUpdating = True
'
'    'Windows(myBucketReportFilename).Activate
'    Range("Y5:Y" & myTotal).Value = "=VLOOKUP(B5,'[" & myPurchasingDataFilename & "]Temp'!$F:$AD,25,0)"
'    Range("Y5:Y" & myTotal).Value = Range("Y5:Y" & myTotal).Value
'    Columns("Y:Y").Style = "Currency"
    Rows("1:1").Insert
    Columns("E:E").Cut
    Columns("B:B").Insert
    Columns("F:F").Cut
    Columns("C:C").Insert
    Columns("H:H").Cut
    Columns("F:F").Insert
    Columns("I:J").Cut
    Columns("G:G").Insert
    Columns("L:N").Cut
    Columns("I:I").Insert
    Range("O2:P3").UnMerge
    Columns("P:T").Cut
    Columns("L:L").Insert
    Columns("X:Y").Cut
    Columns("Q:Q").Insert
    'Previously is known as LSS
    Columns("S:S").Insert
    Range("S4").Value = "LSS"
    Columns("AA:AA").Cut
    Columns("T:T").Insert
    Range("AB2:AD3").UnMerge
    Columns("AB:AC").Cut
    Columns("U:U").Insert
    Columns("AE:AG").Cut
    Columns("W:W").Insert
        'Ver2.3: Refresh Total Value
        myTotal = Range("B" & Rows.Count).End(xlUp).Row
        'Ver1.8: Add Past Due into first bucket
        myTotalItem = Range("B" & Rows.Count).End(xlUp).Row
        Columns("AI:AJ").Insert
        Range("AH5:AJ" & myTotalItem).Value = "=AK5+AP5"
        Range("AH5:AJ" & myTotalItem).Value = Range("AH5:AJ" & myTotalItem).Value
        Range("AP5:AR" & myTotalItem).Value = Range("AH5:AJ" & myTotalItem).Value
        Columns("AH:AI").Delete
        Columns("AH:AH").ClearContents
        Columns("AI:AM").Cut
        Columns("EH:EH").Insert
        'Columns("Z:AL").Cut
        'Columns("EG:EG").Insert
    Columns("Y:Y").Insert
    Range("Y4").Value = "EC"
    Range("Y4").Font.Color = 16777215 'White
    Range("Y4").Interior.Color = 9851952 'Dark Blue
    Columns("AA:AI").Cut
    Columns("EI").Insert
        'Ver1.9: Remain first bucket
        'Ver1.7: Past Due no need
        'Columns("AA:AE").Delete
    Columns("AF:AH").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("AN:AP").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("AV:AX").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("BD:BF").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("BL:BN").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("BT:BV").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("CB:CD").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("CJ:CL").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("CR:CT").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("CZ:DB").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("DH:DJ").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("DP:DR").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("DX:DZ").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("EF:EH").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("EN:EP").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("EV:EX").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    For myA = 1 To 16
        Cells(4, myA * 8 + 24).Value = "Bucket" & myA & " Shortages Qty"
        Cells(4, myA * 8 + 25).Value = "Bucket" & myA & " Shortages Qty(SPQ)"
        Cells(4, myA * 8 + 26).Value = "Bucket" & myA & " Shortages $$"
        Range(Cells(4, myA * 8 + 24), Cells(4, myA * 8 + 26)).Interior.Color = 65535
        If myA = 1 Then
            Range(Cells(5, myA * 8 + 24), Cells(myTotal, myA * 8 + 24)).Value = "=RC[-11]-RC[-10]+RC[-5]+RC[-4]-RC[-3]-RC[-22]"
            Range(Cells(5, myA * 8 + 25), Cells(myTotal, myA * 8 + 25)).Value = "=IF(AND((RC18>0),(RC[-1]<0)),CEILING(-RC[-1],RC18),(RC[-1]*(-1)))"
            Range(Cells(5, myA * 8 + 26), Cells(myTotal, myA * 8 + 26)).Value = "=IF(RC[-1]>0,(RC[-1]*RC25),0)"
        Else
            Range(Cells(5, myA * 8 + 24), Cells(myTotal, myA * 8 + 24)).Value = "=IF(RC[-8]<0,RC[-7]+RC[-8]+RC[-5]+RC[-4]-RC[-3],RC[-8]+RC[-5]+RC[-4]-RC[-3])"
            Range(Cells(5, myA * 8 + 25), Cells(myTotal, myA * 8 + 25)).Value = "=IF(AND((RC18>0),(RC[-1]<0)),CEILING(-RC[-1],RC18),(RC[-1]*(-1)))"
            Range(Cells(5, myA * 8 + 26), Cells(myTotal, myA * 8 + 26)).Value = "=IF(RC[-1]>0,(RC[-1]*RC25),0)"
        End If
        Range(Cells(5, myA * 8 + 24), Cells(myTotal, myA * 8 + 25)).NumberFormat = "_(* #,##0_);_(* (#,##0);_(* ""-""??_);_(@_)"
        Range(Cells(5, myA * 8 + 26), Cells(myTotal, myA * 8 + 26)).NumberFormat = "_($* #,##0_);_($* (#,##0);_($* ""-""??_);_(@_)"
    Next myA
    Application.ScreenUpdating = True

    'Windows(myBucketReportFilename).Activate
    Range("Y5:Y" & myTotal).Value = "=VLOOKUP(B5,'[" & myPurchasingDataFilename & "]Temp'!$F:$AD,25,0)"
    Range("Y5:Y" & myTotal).Value = Range("Y5:Y" & myTotal).Value
    Columns("Y:Y").Style = "Currency"

    Workbooks.Open Filename:=myOpenPoFile, ReadOnly:=True
    myOpenPoFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
    myTotalOpenPo = Range("Q" & Rows.Count).End(xlUp).Row
    Columns("C:C").Insert
    Range("C3:C" & myTotalOpenPo).Value = myOverallOpenMpf
    Range("C3:C" & myTotalOpenPo).Value = Range("C3:C" & myTotalOpenPo).Value
    'Range("C3").Value = "Delete"
    Range("A3:BH" & myTotalOpenPo).RemoveDuplicates Columns:=3, Header:=xlNo
    Columns("C:C").Delete
    myTotalOpenPo = Range("Q" & Rows.Count).End(xlUp).Row
    Columns("O:O").Insert
    Range("O3:O" & myTotalOpenPo).Value = myOverallOrderType
    Range("O3:O" & myTotalOpenPo).Value = Range("O3:O" & myTotalOpenPo).Value
    Range("O3").Value = "Delete"
    Range("A3:BH" & myTotalOpenPo).RemoveDuplicates Columns:=15, Header:=xlNo
    Columns("O:O").Delete
    myTotalOpenPo = Range("Q" & Rows.Count).End(xlUp).Row
    
    'Workbooks.Open Filename:=myOpenPoFile, ReadOnly:=True
    'Windows("Projected PO report 15-Apr-2019.xlsx").Activate
    Workbooks(myProjectedPoFilename).Activate
        'Ver2.9: Get Pivot Table title
        myPvTitle = Sheets("PV").Range("A5").Value
    Sheets("PO").Select
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
    Cells.ClearContents
    Workbooks(myOpenPoFilename).Sheets("Temp").Range("A1:BG" & myTotalOpenPo).Copy
    Range("A1").PasteSpecial xlPasteAll
        
    Rows("3:3").Select
    Application.CutCopyMode = False
    Selection.AutoFilter
    Columns("BH:BH").Delete Shift:=xlToLeft
    Columns("AI:AI").TextToColumns Destination:=Range("AI1"), DataType:=xlFixedWidth, FieldInfo:=Array(0, 1), TrailingMinusNumbers:=True
    Columns("AJ:AJ").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    myTotalProjectedPo = Range("Q" & Rows.Count).End(xlUp).Row
    Range("AJ3").Value = "By Month"
    Range("AJ4:AJ" & myTotalProjectedPo).Value = "=VLOOKUP(IF(AI4<Today(),Today(),AI4),Calendar!A:B,2,0)"
    Range("AJ4:AJ" & myTotalProjectedPo).Value = Range("AJ4:AJ" & myTotalProjectedPo).Value
    Columns("AD:AD").NumberFormat = "_($* #,##0_);_($* (#,##0);_($* ""-""??_);_(@_)"
    Range("AD3").Select
    ActiveWorkbook.Worksheets("PO").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("PO").AutoFilter.Sort.SortFields.Add Key:=Range("AD3:AD" & myTotalProjectedPo), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("PO").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
        'Ver2.9: Rename Pivot Table title
        Range("B3").Value = myPvTitle
    Sheets("PV").Select
    Application.DisplayAlerts = False
    ActiveSheet.PivotTables("PivotTable2").PivotCache.Refresh
    Application.DisplayAlerts = True
    myLastPivotRow = ActiveSheet.PivotTables("PivotTable2").TableRange1.Rows.Count
    myLastPivotColumn = ActiveSheet.PivotTables("PivotTable2").TableRange1.Columns.Count
    Range(Cells(1, myLastPivotColumn + 1), Cells(1, myLastPivotColumn + 10)).EntireColumn.ClearContents
    Rows(myLastPivotRow + 4 & ":" & Rows.Count).ClearContents
        'Ver1.4: Sort Pivot Table
        Sheets.Add
        ActiveSheet.Name = "TempPivot"
        Sheets("PO").Range("AJ3:AJ" & myTotalProjectedPo).Copy
        Range("A1").PasteSpecial xlPasteValues
        Range("A1:A" & myTotalProjectedPo).RemoveDuplicates Columns:=1, Header:=xlNo
        myTotalPivot = Range("A" & Rows.Count).End(xlUp).Row
        Range("B2:B" & myTotalPivot).Value = "=MATCH(A2,Calendar!B:B,0)"
        Range("B2:B" & myTotalPivot).Value = Range("B2:B" & myTotalPivot).Value
        Rows("1:1").AutoFilter
        ActiveWorkbook.Worksheets("TempPivot").AutoFilter.Sort.SortFields.Clear
        ActiveWorkbook.Worksheets("TempPivot").AutoFilter.Sort.SortFields.Add Key:=Range("B1:B" & myTotalPivot), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        ActiveWorkbook.Worksheets("TempPivot").AutoFilter.Sort.Header = xlYes
        ActiveWorkbook.Worksheets("TempPivot").AutoFilter.Sort.MatchCase = False
        ActiveWorkbook.Worksheets("TempPivot").AutoFilter.Sort.Orientation = xlTopToBottom
        ActiveWorkbook.Worksheets("TempPivot").AutoFilter.Sort.Apply
        Sheets("PV").Select
        'Ver2.4: Check last column
        myLastColumn = Cells(5, Columns.Count).End(xlToLeft).Column - 2
        'For myA = 1 To 24
        For myA = 1 To myLastColumn
            ActiveSheet.PivotTables("PivotTable2").PivotFields("By Month").PivotItems(Sheets("TempPivot").Range("A" & myA + 1).Value).Position = myA
            ActiveSheet.PivotTables("PivotTable2").PivotFields("By Month").PivotItems(Sheets("TempPivot").Range("A" & myA + 1).Value).Visible = True
        Next myA
        Application.DisplayAlerts = False
        Sheets("TempPivot").Delete
        Application.DisplayAlerts = True
    Workbooks(myOpenPoFilename).Close False
    
    Workbooks.Open mySalesFile
    mySalesFilename = ActiveWorkbook.Name

    Cells.Find(What:="Total Unbilled COGS", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    myFindRow = ActiveCell.Row
    myLastColTemp = Cells(myFindRow, Columns.Count).End(xlToLeft).Column
    myTempLastRow = Range("A" & Rows.Count).End(xlUp).Row
    For myA = myLastColTemp To 1 Step -1
        If Cells(myFindRow, myA) = "Total Unbilled COGS" Then
            Cells(myFindRow, myA + 1).EntireColumn.Insert
            Cells(myFindRow, myA + 1).Value = "Mat. Cost %"
            Range(Cells(myFindRow + 1, myA + 1), Cells(myTempLastRow, myA + 1)).Value = "=IFERROR((RC[-2]-RC[-1])/RC[-3],""-"")"
            Range(Cells(myFindRow + 1, myA + 1), Cells(myTempLastRow, myA + 1)).Style = "Percent"
            Range(Cells(myFindRow + 1, myA + 1), Cells(myTempLastRow, myA + 1)).EntireColumn.Interior.ThemeColor = xlThemeColorAccent5
            Range(Cells(myFindRow + 1, myA + 1), Cells(myTempLastRow, myA + 1)).EntireColumn.Interior.TintAndShade = 0.799981688894314
        End If
    Next myA
    Application.ScreenUpdating = True
    
    Workbooks.Open mySmiAgingFile
    mySmiAgingFilename = ActiveWorkbook.Name
    ErrHnd1
    Sheets("Aging Parts Details").Copy Before:=Sheets(4)
    ActiveSheet.Name = "Aging Parts Details (ISL)"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
    mySmiAgingTotal = Range("A" & Rows.Count).End(xlUp).Row
    Columns("F:F").Insert
    Range("F1:F" & mySmiAgingTotal).Value = "=IF(E1=830,Row(E1),""Delete"")"
    Range("F1:F" & mySmiAgingTotal).Value = Range("F1:F" & mySmiAgingTotal).Value
    Range("A1:U" & mySmiAgingTotal).RemoveDuplicates Columns:=6, Header:=xlNo
    mySmiAgingTotal = Range("A" & Rows.Count).End(xlUp).Row
    Columns("F:F").Delete
    Columns("G:I").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("G1").Value = "Date take in inv."
    Range("H1").Value = "Month"
    Range("I1").Value = "Amount in EC"
    Range("G1:I1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
    Range("G2:G" & mySmiAgingTotal).Value = "=RC[-1]+RC[7]"
    Range("H2:H" & mySmiAgingTotal).Value = "=VLOOKUP(IF(G2<Today(),Today(),G2),'[" & myProjectedPoFilename & "]Calendar'!A:B,2,0)"
    Range("H2:H" & mySmiAgingTotal).Value = Range("H2:H" & mySmiAgingTotal).Value
    Range("I2:I" & mySmiAgingTotal).Value = "=VLOOKUP(D2,'[" & myPurchasingDataFilename & "]Temp'!$F:$AD,25,0)*J2"
    Range("I2:I" & mySmiAgingTotal).Value = Range("I2:I" & mySmiAgingTotal).Value
    Range("I2:I" & mySmiAgingTotal).NumberFormat = "_($* #,##0_);_($* (#,##0);_($* ""-""??_);_(@_)"
    ErrHnd2
    Sheets.Add After:=ActiveSheet
    ActiveSheet.Name = "PV"
    Range("A3").Select
    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:="Aging Parts Details (ISL)!R1C1:R" & mySmiAgingTotal & "C21", Version:=xlPivotTableVersion15).CreatePivotTable TableDestination:="PV!R3C1", TableName:="PivotTable2", DefaultVersion:=xlPivotTableVersion15
    Sheets("PV").Select
    Cells(3, 1).Select
    Range("C10").Select
    With ActiveSheet.PivotTables("PivotTable2")
        .InGridDropZones = True
        .ShowDrillIndicators = False
        .RowAxisLayout xlTabularRow
    End With

    With ActiveSheet.PivotTables("PivotTable2").PivotFields("MPF")
        .Orientation = xlRowField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable2").PivotFields("Month")
        .Orientation = xlColumnField
        .Position = 1
    End With
    ActiveSheet.PivotTables("PivotTable2").AddDataField ActiveSheet.PivotTables("PivotTable2").PivotFields("Amount in EC"), "Sum of Amount in EC", xlSum
    
    Range(Cells(4, 2), Cells(4, Range("A4").End(xlToRight).Column - 1)).Copy
    Range("Z1").PasteSpecial xlPasteValues, , , True
    myLastPivot = Range("Z" & Rows.Count).End(xlUp).Row
    Range("AA1:AA" & myLastPivot).Value = "=Match(Z1,'[" & myProjectedPoFilename & "]Calendar'!B:B,0)"
    Range("AA1:AA" & myLastPivot).Value = Range("AA1:AA" & myLastPivot).Value
    
    ActiveWorkbook.Worksheets("PV").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("PV").Sort.SortFields.Add Key:=Range("AA1:AA" & myLastPivot), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    ActiveWorkbook.Worksheets("PV").Sort.SetRange Range("Z1:AA" & myLastPivot)
    ActiveWorkbook.Worksheets("PV").Sort.Header = xlGuess
    ActiveWorkbook.Worksheets("PV").Sort.MatchCase = False
    ActiveWorkbook.Worksheets("PV").Sort.Orientation = xlTopToBottom
    ActiveWorkbook.Worksheets("PV").Sort.SortMethod = xlPinYin
    ActiveWorkbook.Worksheets("PV").Sort.Apply
    
    For myA = 1 To myLastPivot
        ActiveSheet.PivotTables("PivotTable2").PivotFields("Month").PivotItems(Range("Z" & myA).Value).Position = myA
    Next myA
    Columns("Z:AA").ClearContents
    Range("A1").Select
    
    Workbooks.Open myProjectedInvFile, False
    myProjectedInvFilename = ActiveWorkbook.Name
    
    Application.DisplayAlerts = False
    If ThisWorkbook.MultiUserEditing Then
        ActiveWorkbook.ExclusiveAccess
    End If
    Application.DisplayAlerts = True
    Sheets("Mat. Cost Calc.").Select
    If ActiveSheet.AutoFilterMode = True Then
        Rows("1:1").AutoFilter
    End If
    Cells.ClearContents
    Cells.ClearFormats
    'Workbooks.Open myPath & "My Sales20190415005630.xlsx"
    'Windows("My Sales_ori 20190409081354").Activate
    Workbooks(mySalesFilename).Activate
    Range(Cells(1, 1), Cells.SpecialCells(xlCellTypeLastCell)).Copy
    Workbooks(myProjectedInvFilename).Activate
    Range("A1").PasteSpecial xlAll
        Range(Cells(2, 2), Cells(2, Cells.SpecialCells(xlCellTypeLastCell).Column)).Value = "=B7&A6"
        Range(Cells(2, 2), Cells(2, Cells.SpecialCells(xlCellTypeLastCell).Column)).Value = Range(Cells(2, 2), Cells(2, Cells.SpecialCells(xlCellTypeLastCell).Column)).Value
    Sheets("Cash deposit").Select
    Workbooks.Open myCurrentVsBaseFile
    myCurrentVsBaseFilename = ActiveWorkbook.Name
    
    ActiveSheet.Name = "Temp"
    Range(Cells(1, 1), Cells(1, Cells.SpecialCells(xlCellTypeLastCell).Column)).Value = "=SUBSTITUTE(A5,"" "","""")&A7"
    Range(Cells(1, 1), Cells(1, Cells.SpecialCells(xlCellTypeLastCell).Column)).Value = Range(Cells(1, 1), Cells(1, Cells.SpecialCells(xlCellTypeLastCell).Column)).Value
    myCurrentQtr = Application.WorksheetFunction.VLookup(CLng(CDate(Date)), Workbooks(myProjectedPoFilename).Sheets("Calendar").Columns("A:G"), 7, 0)
    myColumn = Application.WorksheetFunction.Match(myCurrentQtr & "Customer deposits", Rows("1:1"), 0)
    Workbooks(myProjectedInvFilename).Activate
    Range("J7:J" & Range("B" & Rows.Count).End(xlUp).Row).Value = "=VLOOKUP(B7,'[" & myCurrentVsBaseFilename & "]Temp'!$A:$XAA," & myColumn & ",0)"
    Range("J7:J" & Range("B" & Rows.Count).End(xlUp).Row).Value = Range("J7:J" & Range("B" & Rows.Count).End(xlUp).Row).Value
    
    Sheets("COGS").Select
    Range(Range("CC3"), Range("CC3").End(xlDown).Offset(-1, 0)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Application.CutCopyMode = False
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    Workbooks.Open mySalesOnlyFile
    mySalesOnlyFilename = ActiveWorkbook.Name
        'Ver1.3: Add Sheetname
        mySalesOnlySheetname = ActiveSheet.Name
    Range(Cells(1, 1), Cells(1, Cells.SpecialCells(xlCellTypeLastCell).Column)).Value = "=A6&A7"
    Range(Cells(1, 1), Cells(1, Cells.SpecialCells(xlCellTypeLastCell).Column)).Value = Range(Cells(1, 1), Cells(1, Cells.SpecialCells(xlCellTypeLastCell).Column)).Value
    mySalesOnlyTotal = Range("A" & Rows.Count).End(xlUp).Row
    Columns("A:A").Insert
    Range("A1:A" & mySalesOnlyTotal).Value = "=Left(Right(B1,4),3)"
    'Range("I10:I20").Select
    'Selection.Copy
    'Windows("Penang Projected Inv as at 15-Apr-2019_16 wks.xlsx").Activate
    InventoryProjection1a
    
    InvertoryProjection2
    'Ver2.3: Eliminate PO Yet to place
    'Workbooks(myPoYetToPlaceFilename).Close False
    'Ver1.4: No need to close
    'Workbooks(myProjectedPoFilename).Close False
    Workbooks(mySrsFilename).Close False
    Workbooks(myRawMaterialFilename).Close False
    Workbooks(myWipInventoryFilename).Close False
    Workbooks(myMicronProductFilename).Close False
    Workbooks(myCurrentVsBaseFilename).Close False
    Workbooks(myPurchasingDataFilename).Close False
    Workbooks(mySalesOnlyFilename).Close False
    
    'Ver2.3: Add Pivot sheet
    Workbooks(myBucketReportFilename).Activate
    PivotBucket
    
    'Ver3.3: Add new logic
    Workbooks(mySalesFilename).Activate
    myLastColTemp = Cells(myFindRow, Columns.Count).End(xlToLeft).Column
    myTempLastRow = Range("A" & Rows.Count).End(xlUp).Row
    For myA = myLastColTemp To 1 Step -1
        If Cells(myFindRow, myA) = "Mat. Cost %" Then
            Cells(myFindRow, myA + 1).EntireColumn.Insert
            Cells(myFindRow, myA + 1).Value = "Mat. Cost %"
            Cells(myFindRow, myA).Value = "COGS %"
            Range(Cells(myFindRow + 1, myA + 1), Cells(myTempLastRow, myA + 1)).Value = "=IFERROR(RC[-5]/RC[-4],""-"")"
            'Range(Cells(myFindRow + 1, myA + 1), Cells(myTempLastRow, myA + 1)).Style = "Percent"
            'Range(Cells(myFindRow + 1, myA + 1), Cells(myTempLastRow, myA + 1)).EntireColumn.Interior.ThemeColor = xlThemeColorAccent5
            'Range(Cells(myFindRow + 1, myA + 1), Cells(myTempLastRow, myA + 1)).EntireColumn.Interior.TintAndShade = 0.799981688894314
        End If
    Next myA
    Cells.Copy
    Workbooks(myProjectedInvFilename).Activate
    Sheets("Mat. Cost Calc.").Select
    Range("A1").PasteSpecial xlPasteAll
    Columns("B:B").Insert
    Range(Cells(myFindRow + 1, 2), Cells(myTempLastRow, 2)).Value = "=LEFT(RIGHT(A8,7),6)"
    Sheets("Inventory Projection").Select
    Range("A2").Select
    myLastColTemp = Cells(2, Columns.Count).End(xlToLeft).Column
    myTempUpdate = Range("A2").End(xlDown).Row - 1
    For myA = 1 To myLastColTemp
        If Cells(2, myA) = "Material Cost %" Then
            Cells(1, myA).Select
            mySelectionDate = ActiveCell.Value
            If Left(mySelectionDate, 1) = "Q" Then
                mySelectionDate = Left(mySelectionDate, 2) & " " & Right(mySelectionDate, 3)
            End If
            Range(Cells(3, myA), Cells(myTempUpdate, myA)).Select
            Range(Cells(3, myA), Cells(myTempUpdate, myA)).Value = "=IFERROR(VLOOKUP($A3&TEXT($B3,""000""),'Mat. Cost Calc.'!$B:$MM,MATCH(""" & mySelectionDate & """,'Mat. Cost Calc.'!$6:$6,0)+4,0),"""")"
            Range(Cells(3, myA), Cells(myTempUpdate, myA)).Value = Range(Cells(3, myA), Cells(myTempUpdate, myA)).Value
        End If
    Next myA
    
    myEndTime = Time
    MsgBox "Done in " & Format(myEndTime - myStrTime, "hh:mm:ss")
End Sub
Sub PivotBucket()
    On Error GoTo Err1
    Application.DisplayAlerts = False
        Sheets("Details").Delete
    Application.DisplayAlerts = True
    Sheets("Temp").Name = "Details"
    Set mySearchValue = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
    If mySearchValue Is Nothing Then

    Else
        mySearchValue = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
        myBlankCheck = Application.WorksheetFunction.CountBlank(Range(Cells(4, 1), Cells(4, mySearchValue)))
        If myBlankCheck > 1 Then
            Range(Cells(4, 1), Cells(4, mySearchValue)).SpecialCells(xlCellTypeBlanks).EntireColumn.Delete
            myLastCol = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
        End If
        myLastCol = Cells.Find(What:="Bucket16 Shortages $$", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Column
        myTempPivot = Range("B" & Rows.Count).End(xlUp).Row
        Sheets.Add
        ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:="Details!R4C1:R" & myTempPivot & "C" & myLastCol, Version:=xlPivotTableVersion15).CreatePivotTable TableDestination:=ActiveSheet.Name & "!R3C1", TableName:="PivotTable1"
        Cells(3, 1).Select
        With ActiveSheet.PivotTables("PivotTable1").PivotFields("MPF")
            .Orientation = xlRowField
            .Position = 1
        End With
        With ActiveSheet.PivotTables("PivotTable1").PivotFields("LT")
            .Orientation = xlPageField
            .Position = 1
        End With
        With ActiveSheet.PivotTables("PivotTable1").PivotFields("Type")
            .Orientation = xlColumnField
            .Position = 1
        End With
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").PivotItems("830G").Position = 1
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").PivotItems("830O").Position = 2
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").PivotItems("(blank)").Position = 3
        Range("B4:D4").Group
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type2").PivotItems("Group1").Caption = "Discrete"
        myLastPivotCol = Cells.SpecialCells(xlCellTypeLastCell).Column - 1
        Range(Cells(5, 5), Cells(5, myLastPivotCol)).Group
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type2").PivotItems("Group2").Caption = "SCM"
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Type").Orientation = xlHidden
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket1 Shortages $$"), "Sum of Bucket1 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket2 Shortages $$"), "Sum of Bucket2 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket3 Shortages $$"), "Sum of Bucket3 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket4 Shortages $$"), "Sum of Bucket4 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket5 Shortages $$"), "Sum of Bucket5 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket6 Shortages $$"), "Sum of Bucket6 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket7 Shortages $$"), "Sum of Bucket7 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket8 Shortages $$"), "Sum of Bucket8 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket9 Shortages $$"), "Sum of Bucket9 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket10 Shortages $$"), "Sum of Bucket10 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket11 Shortages $$"), "Sum of Bucket11 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket12 Shortages $$"), "Sum of Bucket12 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket13 Shortages $$"), "Sum of Bucket13 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket14 Shortages $$"), "Sum of Bucket14 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket15 Shortages $$"), "Sum of Bucket15 Shortages $$", xlSum
        ActiveSheet.PivotTables("PivotTable1").AddDataField ActiveSheet.PivotTables("PivotTable1").PivotFields("Bucket16 Shortages $$"), "Sum of Bucket16 Shortages $$", xlSum
        With ActiveSheet.PivotTables("PivotTable1").DataPivotField
            .Orientation = xlColumnField
            .Position = 1
        End With
        Range("B6").Select
        Range(Selection, Selection.End(xlToRight)).Select
        Range(Selection, Selection.End(xlDown)).Select
        Selection.Style = "Currency"
        Selection.NumberFormat = "_($* #,##0_);_($* (#,##0);_($* ""-""??_);_(@_)"
        ActiveSheet.Name = "PV"
        Rows("4:4").RowHeight = 52.5
        Selection.ColumnWidth = 10.67
        Rows("4:4").WrapText = True
        Selection.EntireColumn.AutoFit
        Rows("4:4").EntireRow.AutoFit
        Sheets("Details").Select
    End If
Err1:
End Sub
Sub InventoryProjection1a()
    Workbooks(myProjectedInvFilename).Activate
    Range(Range("CC3"), Range("CC3").End(xlDown).Offset(-1, 0)).Select
    Range(Selection, Selection.End(xlToRight)).Select
        'Ver1.3: Change Sheetname
        'Selection.Value = "=VLOOKUP(TEXT($C3,""000""),'[" & mySalesOnlyFilename & "]My Sales'!$A:$AAB,MATCH(TEXT(CC$2,""Mmm Yy"")&""Total Net Sales excluding Unbilled"",'[" & mySalesOnlyFilename & "]My Sales'!$1:$1,0),0)"
        Selection.Value = "=VLOOKUP(TEXT($C3,""000""),'[" & mySalesOnlyFilename & "]" & mySalesOnlySheetname & "'!$A:$AAB,MATCH(TEXT(CC$2,""Mmm Yy"")&""Total Net Sales excluding Unbilled"",'[" & mySalesOnlyFilename & "]" & mySalesOnlySheetname & "'!$1:$1,0),0)"
    Selection.Value = Selection.Value
    
    'Cells.Find(What:="Material Cost %", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Cells.Find(What:="COGS %", After:=Range("A1"), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    myStartRow = Selection.End(xlDown).Row
        'Add platform to vlookup
        Sheets("Mat. Cost Calc.").Columns("B:B").Insert
        myLastMatCostCalcTotal = Sheets("Mat. Cost Calc.").Range("A" & Rows.Count).End(xlUp).Row
        Sheets("Mat. Cost Calc.").Range("B1:B" & myLastMatCostCalcTotal).Value = "=Left(Right(A1,4),3)"
    Range("CC" & myStartRow).Select
    Range(Selection, Selection.End(xlDown).Offset(-1, 0)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.Value = "=VLOOKUP(TEXT($C" & myStartRow & ",""000""),'Mat. Cost Calc.'!$B:$AAB,MATCH(""Mat. Cost %"" & TEXT(CC$" & myStartRow - 1 & ",""Mmm Yy""),'Mat. Cost Calc.'!$2:$2,0)-1,0)"
    Selection.Value = Selection.Value
        'Delete column
        Sheets("Mat. Cost Calc.").Columns("B:B").Delete
    
    Workbooks(myCurrentVsBaseFilename).Sheets("Temp").Columns("B:B").Insert
    myLastCurrentVsBase = Workbooks(myCurrentVsBaseFilename).Sheets("Temp").Range("A" & Rows.Count).End(xlUp).Row
    Workbooks(myCurrentVsBaseFilename).Sheets("Temp").Range("B1:B" & myLastCurrentVsBase).Value = "=Left(Right(A1,4),3)"
    
    Sheets("Inventory Projection").Select
    myTotalInvProjection = Range("A" & Rows.Count).End(xlUp).Row - 1

    Range("E1").Value = Date
    Range("E3:I" & myTotalInvProjection).ClearContents
    
    Range("G1").Value = "'" & myInvMth1
    Range("R3:R" & myTotalInvProjection).ClearContents
    Range("V3:V" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("V3:V" & myTotalInvProjection).Value = Range("V3:V" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("S:S"), 0)
    Range("T" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob1 = "" Then
        myInvMthFob1 = 0
    End If
    Range("T" & myPpvOtherRow).Value = Range("T" & myPpvOtherRow).Value - myInvMthFob1
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("S:S"), 0)
    Range("T" & myFobRow).Value = myInvMthFob1
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("S:S"), 0)
    Range("U" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("U" & myEstimatedPlantRow).Value = Range("U" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("S:S"), 0)
    Range("T" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth1, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("T" & myTargetRow).Value = Range("T" & myTargetRow).Value
    
    Range("X1").Value = "'" & myInvMth2
    Range("X3:X" & myTotalInvProjection).ClearContents
    Range("AN3:AN" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("AN3:AN" & myTotalInvProjection).Value = Range("AN3:AN" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("AK:AK"), 0)
    Range("AL" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob2 = "" Then
        myInvMthFob2 = 0
    End If
    Range("AL" & myPpvOtherRow).Value = Range("AL" & myPpvOtherRow).Value - myInvMthFob2
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("AK:AK"), 0)
    Range("AL" & myFobRow).Value = myInvMthFob2
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("AK:AK"), 0)
    Range("AM" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("AM" & myEstimatedPlantRow).Value = Range("AM" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("AK:AK"), 0)
    Range("AL" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth2, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("AL" & myTargetRow).Value = Range("AL" & myTargetRow).Value
    
    Range("AP1").Value = "'" & myInvMth3
    Range("AP3:AR" & myTotalInvProjection).ClearContents
    Range("BF3:BF" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BF3:BF" & myTotalInvProjection).Value = Range("BF3:BF" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("BC:BC"), 0)
    Range("BD" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob3 = "" Then
        myInvMthFob3 = 0
    End If
    Range("BD" & myPpvOtherRow).Value = Range("BD" & myPpvOtherRow).Value - myInvMthFob3
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("BC:BC"), 0)
    Range("BD" & myFobRow).Value = myInvMthFob3
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("BC:BC"), 0)
    Range("BE" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BE" & myEstimatedPlantRow).Value = Range("BE" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("BC:BC"), 0)
    Range("BD" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth3, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BD" & myTargetRow).Value = Range("BD" & myTargetRow).Value
    
    Range("BI1").Value = "'" & myInvMth4
    Range("BI3:BK" & myTotalInvProjection).ClearContents
    Range("BY3:BY" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BY3:BY" & myTotalInvProjection).Value = Range("BY3:BY" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("BV:BV"), 0)
    Range("BW" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    If myInvMthFob4 = "" Then
        myInvMthFob4 = 0
    End If
    Range("BW" & myPpvOtherRow).Value = Range("BW" & myPpvOtherRow).Value - myInvMthFob4
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("BV:BV"), 0)
    Range("BW" & myFobRow).Value = myInvMthFob4
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("BV:BV"), 0)
    Range("BX" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BX" & myEstimatedPlantRow).Value = Range("BX" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("BV:BV"), 0)
    Range("BW" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth4, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("BW" & myTargetRow).Value = Range("BW" & myTargetRow).Value
    
    Range("CA1").Value = "'" & myInvMth5
    Range("CA3:CC" & myTotalInvProjection).ClearContents
    If myInvMth5 = "" Then
        Range("CF3:CF" & myTotalInvProjection).ClearContents
        Range("CF3:CF" & myTotalInvProjection).ClearComments
        Range("CJ3:CL" & myTotalInvProjection).ClearContents
        Range("CJ3:CL" & myTotalInvProjection).ClearComments
        Range("CO3:CO" & myTotalInvProjection).ClearContents
        Range("CQ3:CQ" & myTotalInvProjection).ClearContents
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("CN:CN"), 0)
        Range("CO" & myPpvOtherRow).Value = ""
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("CN:CN"), 0)
        Range("CO" & myFobRow).Value = ""
        Range("CP" & myEstimatedPlantRow).Value = ""
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("CN:CN"), 0)
        Range("CO" & myTargetRow).Value = ""
        Columns("CA:CR").Hidden = True
    Else
        Columns("CA:CR").Hidden = False
        Columns("CD:CE").Hidden = True
        Range("CQ3:CQ" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("CQ3:CQ" & myTotalInvProjection).Value = Range("CQ3:CQ" & myTotalInvProjection).Value
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("CN:CN"), 0)
        Range("CO" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        If myInvMthFob5 = "" Then
            myInvMthFob5 = 0
        End If
        Range("CO" & myPpvOtherRow).Value = Range("CO" & myPpvOtherRow).Value - myInvMthFob5
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("CN:CN"), 0)
        Range("CO" & myFobRow).Value = myInvMthFob5
        myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("CN:CN"), 0)
        Range("CP" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("CP" & myEstimatedPlantRow).Value = Range("CP" & myEstimatedPlantRow).Value
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("CN:CN"), 0)
        Range("CO" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth5, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("CO" & myTargetRow).Value = Range("CO" & myTargetRow).Value
        If Range("CO3").Value <> "" Then
            Range("CO3:CO" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP($B3,INDIRECT(""COGS!C""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":$XFD$1000000""),MATCH(DATEVALUE(""1 ""&CA$1),INDIRECT(""COGS!""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":""&MATCH(""After Adjustment"",COGS!$B:$B,0)),0)-2,0),"""")"
        End If
    End If
        
    Range("CS1").Value = "'" & myInvMth6
    Range("CS3:CU" & myTotalInvProjection).ClearContents
    If myInvMth6 = "" Then
        Range("CW3:CW" & myTotalInvProjection).ClearContents
        Range("CW3:CW" & myTotalInvProjection).ClearComments
        Range("CY3:CY" & myTotalInvProjection).ClearContents
        Range("CY3:CY" & myTotalInvProjection).ClearComments
        Range("DD3:DD" & myTotalInvProjection).ClearContents
        Range("DF3:DF" & myTotalInvProjection).ClearContents
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("DC:DC"), 0)
        Range("DD" & myPpvOtherRow).Value = ""
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("DC:DC"), 0)
        Range("DD" & myFobRow).Value = ""
        Range("DE" & myEstimatedPlantRow).Value = ""
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("DC:DC"), 0)
        Range("DD" & myTargetRow).Value = ""
        Columns("CS:DG").Hidden = True
    Else
        Columns("CS:DG").Hidden = False
        Columns("CV:CV").Hidden = True
        Range("DF3:DF" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("DF3:DF" & myTotalInvProjection).Value = Range("DF3:DF" & myTotalInvProjection).Value
        myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("DC:DC"), 0)
        Range("DD" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        If myInvMthFob6 = "" Then
            myInvMthFob6 = 0
        End If
        Range("DD" & myPpvOtherRow).Value = Range("DD" & myPpvOtherRow).Value - myInvMthFob6
        myFobRow = Application.WorksheetFunction.Match("FOB", Columns("DC:DC"), 0)
        Range("DD" & myFobRow).Value = myInvMthFob6
        myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("DC:DC"), 0)
        Range("DE" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("DE" & myEstimatedPlantRow).Value = Range("DE" & myEstimatedPlantRow).Value
        'INV Days excl Unbilled
        myTargetRow = Application.WorksheetFunction.Match("Target", Columns("DC:DC"), 0)
        Range("DD" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvMth6, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
        Range("DD" & myTargetRow).Value = Range("DD" & myTargetRow).Value
        If Range("DD3").Value <> "" Then
            Range("DD3:DD" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP($B3,INDIRECT(""COGS!C""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":$XFD$1000000""),MATCH(DATEVALUE(""1 ""&CS$1),INDIRECT(""COGS!""&MATCH(""After Adjustment"",COGS!$B:$B,0)&"":""&MATCH(""After Adjustment"",COGS!$B:$B,0)),0)-2,0),"""")"
        End If
    End If
  
    Range("DH1").Value = myInvQtr1
    Range("DH3:DJ" & myTotalInvProjection).ClearContents
    Range("DU3:DU" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DU3:DU" & myTotalInvProjection).Value = Range("DU3:DU" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("DR:DR"), 0)
    'Range("DS" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DS" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("DS" & myPpvOtherRow).Value = Range("DS" & myPpvOtherRow).Value - myInvQtrFob1
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("DR:DR"), 0)
    Range("DS" & myFobRow).Value = myInvQtrFob1
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("DR:DR"), 0)
    Range("DT" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DT" & myEstimatedPlantRow).Value = Range("DT" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("DR:DR"), 0)
    Range("DS" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr1, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("DS" & myTargetRow).Value = Range("DS" & myTargetRow).Value

    Range("DW1").Value = myInvQtr2
    Range("DW3:DY" & myTotalInvProjection).ClearContents
    Range("EJ3:EJ" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EJ3:EJ" & myTotalInvProjection).Value = Range("EJ3:EJ" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("EG:EG"), 0)
    'Range("EH" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EH" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("EH" & myPpvOtherRow).Value = Range("EH" & myPpvOtherRow).Value - myInvQtrFob2
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("EG:EG"), 0)
    Range("EH" & myFobRow).Value = myInvQtrFob2
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("EG:EG"), 0)
    Range("EI" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EI" & myEstimatedPlantRow).Value = Range("EI" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("EG:EG"), 0)
    Range("EH" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr2, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EH" & myTargetRow).Value = Range("EH" & myTargetRow).Value

    Range("EL1").Value = myInvQtr3
    Range("EL3:EN" & myTotalInvProjection).ClearContents
    Range("EY3:EY" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EY3:EY" & myTotalInvProjection).Value = Range("EY3:EY" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("EV:EV"), 0)
    'Range("EW" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EW" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("EW" & myPpvOtherRow).Value = Range("EW" & myPpvOtherRow).Value - myInvQtyFob3
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("EV:EV"), 0)
    Range("EW" & myFobRow).Value = myInvQtyFob3
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("EV:EV"), 0)
    Range("EX" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EX" & myEstimatedPlantRow).Value = Range("EX" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("EV:EV"), 0)
    Range("EW" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr3, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("EW" & myTargetRow).Value = Range("EW" & myTargetRow).Value
    
    Range("FA1").Value = myInvQtr4
    Range("FA3:FC" & myTotalInvProjection).ClearContents
    Range("FN3:FN" & myTotalInvProjection).Value = "=VLOOKUP(TEXT($B3,""000""),'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FN3:FN" & myTotalInvProjection).Value = Range("FN3:FN" & myTotalInvProjection).Value
    myPpvOtherRow = Application.WorksheetFunction.Match("PPV + Others", Columns("FK:FK"), 0)
    'Range("FL" & myPpvOtherRow).Value = "=VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FL" & myPpvOtherRow).Value = "=IFERROR(VLOOKUP(""830"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0),0)"
    Range("FL" & myPpvOtherRow).Value = Range("FL" & myPpvOtherRow).Value - myInvQtyFob4
    myFobRow = Application.WorksheetFunction.Match("FOB", Columns("FK:FK"), 0)
    Range("FL" & myFobRow).Value = myInvQtyFob4
    myEstimatedPlantRow = Application.WorksheetFunction.Match("Total Estimated Plant Net Inv ", Columns("FK:FK"), 0)
    Range("FM" & myEstimatedPlantRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "Inventory excluding Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FM" & myEstimatedPlantRow).Value = Range("FM" & myEstimatedPlantRow).Value
    'INV Days excl Unbilled
    myTargetRow = Application.WorksheetFunction.Match("Target", Columns("FK:FK"), 0)
    Range("FL" & myTargetRow).Value = "=VLOOKUP(""vie"",'[" & myCurrentVsBaseFilename & "]Temp'!$B:$AAB,MATCH(""" & Replace(myInvQtr4, " ", "", 1) & "INV Days excl Unbilled" & """,'[" & myCurrentVsBaseFilename & "]Temp'!$1:$1,0)-1,0)"
    Range("FL" & myTargetRow).Value = Range("FL" & myTargetRow).Value

    'Total Inventory(07)
    Range("E3:E" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP(B3,'[" & myWipInventoryFilename & "]PV'!$A:$B,2,0),0)+IFERROR(VLOOKUP(B3,'[" & myRawMaterialFilename & "]Summary'!$A:$F,5,0),0)"
    Range("E3:E" & myTotalInvProjection).Value = Range("E3:E" & myTotalInvProjection).Value
    
    'Total Shipped
    Range("R3:R" & myTotalInvProjection).Value = "=VLOOKUP(B3,'[" & mySrsFilename & "]Summary'!$C:$G,5,0)"
    Range("R3:R" & myTotalInvProjection).Value = Range("R3:R" & myTotalInvProjection).Value
    
    'Projected PO
    'Month
    Range("G3:G" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("G3:G" & myTotalInvProjection).Value = Range("G3:G" & myTotalInvProjection).Value
    Range("X3:X" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("X3:X" & myTotalInvProjection).Value = Range("X3:X" & myTotalInvProjection).Value
    Range("AP3:AP" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("AP3:AP" & myTotalInvProjection).Value = Range("AP3:AP" & myTotalInvProjection).Value
    Range("BI3:BI" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth4, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("BI3:BI" & myTotalInvProjection).Value = Range("BI3:BI" & myTotalInvProjection).Value
    Range("CA3:CA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth5, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CA3:CA" & myTotalInvProjection).Value = Range("CA3:CA" & myTotalInvProjection).Value
    Range("CS3:CS" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth6, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CS3:CS" & myTotalInvProjection).Value = Range("CS3:CS" & myTotalInvProjection).Value
    
    'Quarter1
    If myQtr1_1 <> "" Then
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
    End If
    If myQtr1_2 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
    End If
    If myQtr1_3 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
    End If
    'Quarter2
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
        Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DX3:DX" & myTotalInvProjection).ClearContents
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
        Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
        Range("DX3:DX" & myTotalInvProjection).ClearContents
    'Quarter3
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
        Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EM3:EM" & myTotalInvProjection).ClearContents
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
        Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
        Range("EM3:EM" & myTotalInvProjection).ClearContents
    'Quarter4
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+FB3"
        Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        Range("FB3:FB" & myTotalInvProjection).ClearContents
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        'Ver1.5: Refer to wrong cells
        'Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+BF3"
        Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+FB3"
        Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
        Range("FB3:FB" & myTotalInvProjection).ClearContents
    
    'Planned Discrete Order & Planned SCM Order (myWeekRemain)
    'Ver1.4: Change logic from Leadtime + today's date to just consider leadtime only
'    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'
'    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
'    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1)-$H3"
'    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
'    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
'    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1)-$Y3"
'    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
'    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
'    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1)-$AQ3"
'    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
'    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
'    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1)-$BJ3"
'    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
'    If myInvMth5 = "" Then
'        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BG:BN").Insert
'        Columns("CA:CR").Hidden = True
'    Else
'        Columns("CA:CR").Hidden = False
'        Columns("CD:CD").Hidden = True
'        Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
'    End If
'    If myInvMth6 = "" Then
'        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BO:BV").Insert
'        Columns("CS:DG").Hidden = True
'    Else
'        Columns("CS:DG").Hidden = False
'        Columns("CV:CV").Hidden = True
'        Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1)-$CB3"
'        Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
'        Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
'        Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1)-$CT3"
'        Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
'    End If
'    'Qtr1
'    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
'    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ") & """)-$DI3"
'    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
'    'Qtr2
'    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
'    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """)-$DX3"
'    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
'    'Qtr3
'    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
'    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """)-$EM3"
'    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
'    'Qtr4
'    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
'    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """)-$FB3"
'    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
    myWeekRemain = myWeekRemain * 7
    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$H3"
    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
    If Month("1 " & myInvMth2) / 3 - Int(Month("1 " & myInvMth2) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$Y3"
    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
    If Month("1 " & myInvMth3) / 3 - Int(Month("1 " & myInvMth3) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$AQ3"
    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
    If Month("1 " & myInvMth4) / 3 - Int(Month("1 " & myInvMth4) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$BJ3"
    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
    If myInvMth5 = "" Then
        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BG:BN").Insert
        Columns("CA:CR").Hidden = True
    Else
        If Month("1 " & myInvMth5) / 3 - Int(Month("1 " & myInvMth5) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Columns("CA:CR").Hidden = False
        Columns("CD:CD").Hidden = True
        Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
        Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CB3"
        Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
    End If
    
    If myInvMth6 = "" Then
        Workbooks(myPoYetToPlaceFilename).Sheets("Details").Columns("BO:BV").Insert
        Columns("CS:DG").Hidden = True
    Else
        If Month("1 " & myInvMth6) / 3 - Int(Month("1 " & myInvMth6) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Columns("CS:DG").Hidden = False
        Columns("CV:CV").Hidden = True
        Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
        Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CT3"
        Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
    End If
    'Qtr1
    myWeekRemain = myWeekRemain + 91
    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DI3"
    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
    'Qtr2
    myWeekRemain = myWeekRemain + 91
    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DX3"
    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
    'Qtr3
    myWeekRemain = myWeekRemain + 91
    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$EM3"
    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
    'Qtr4
    myWeekRemain = myWeekRemain + 91
    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$FB3"
    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
End Sub
Sub InvertoryProjection2()
    Sheets("Inv Proj (Product)").Select
    myTotalInvProjection = Range("B2").End(xlDown).Row
    myTotalInvProjectionStr1 = Range("B" & myTotalInvProjection + 2).End(xlDown).Row + 1
    myTotalInvProjectionEnd1 = Range("B" & myTotalInvProjectionStr1).End(xlDown).Row

    Range("E1").Value = Date
    Range("E" & myTotalInvProjectionStr1 - 2).Value = Date
    Range("E3:I" & myTotalInvProjection).ClearContents
    Range("E" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).ClearContents
    
    Range("G1").Value = "'" & myInvMth1
    Range("R3:R" & myTotalInvProjection).ClearContents
    Range("G" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth1
    Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).ClearContents
    
    Range("X1").Value = "'" & myInvMth2
    Range("X3:X" & myTotalInvProjection).ClearContents
    Range("X" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth2
    Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).ClearContents
        
    Range("AP1").Value = "'" & myInvMth3
    Range("AP3:AR" & myTotalInvProjection).ClearContents
    Range("AP" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth3
    Range("AP" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).ClearContents
    
    Range("BI1").Value = "'" & myInvMth4
    Range("BI3:BK" & myTotalInvProjection).ClearContents
    Range("BI" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth4
    Range("BI" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).ClearContents
    
    Range("CA1").Value = "'" & myInvMth5
    Range("CA3:CC" & myTotalInvProjection).ClearContents
    Range("CA" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth5
    Range("CA" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).ClearContents
    If myInvMth5 = "" Then
        Columns("CA:CR").Hidden = True
    Else
        Columns("CA:CR").Hidden = False
        Columns("CD:CE").Hidden = True
    End If
        
    Range("CS1").Value = "'" & myInvMth6
    Range("CS3:CU" & myTotalInvProjection).ClearContents
    Range("CS" & myTotalInvProjectionStr1 - 2).Value = "'" & myInvMth6
    Range("CS" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).ClearContents
    If myInvMth6 = "" Then
        Columns("CS:DG").Hidden = True
    Else
        Columns("CS:DG").Hidden = False
        Columns("CV:CV").Hidden = True
    End If
  
    Range("DH1").Value = myInvQtr1
    Range("DH3:DJ" & myTotalInvProjection).ClearContents
    Range("DH" & myTotalInvProjectionStr1 - 2).Value = myInvQtr1
    Range("DH" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).ClearContents

    Range("DW1").Value = myInvQtr2
    Range("DW3:DY" & myTotalInvProjection).ClearContents
    Range("DW" & myTotalInvProjectionStr1 - 2).Value = myInvQtr2
    Range("DW" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).ClearContents

    Range("EL1").Value = myInvQtr3
    Range("EL3:EN" & myTotalInvProjection).ClearContents
    Range("EL" & myTotalInvProjectionStr1 - 2).Value = myInvQtr3
    Range("EL" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).ClearContents
    
    Range("FA1").Value = myInvQtr4
    Range("FA3:FC" & myTotalInvProjection).ClearContents
    Range("FA" & myTotalInvProjectionStr1 - 2).Value = myInvQtr4
    Range("FA" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).ClearContents
    
    'Get Micron & Harmonic Product Family
    'myHarmonicProductModelFile = Range("B15").Value
    Workbooks.Open Filename:=myHarmonicProductModelFile, ReadOnly:=True
    myHarmonicProductModelFilename = ActiveWorkbook.Name
    Range("A1:B" & Range("A" & Rows.Count).End(xlUp).Row).Copy
        'myMicronProductFile = Range("B19").Value
        Workbooks.Open Filename:=myMicronProductFile, ReadOnly:=True
        myMicronProductFilename = ActiveWorkbook.Name
        ActiveSheet.Name = "Temp"
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
        Application.DisplayAlerts = False
        Workbooks(myHarmonicProductModelFilename).Close False
        Application.DisplayAlerts = True
        Workbooks(myWipInventoryFilename).Activate
        Sheets("Detail WIP").Select
        myWipInvTotal = Range("G" & Rows.Count).End(xlUp).Row
        Range("C5:C" & myWipInvTotal).Value = "=VLOOKUP(G5,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
        Range("C5:C" & myWipInvTotal).Value = Range("C5:C" & myWipInvTotal).Value
        Sheets("PV").Select
        'ActiveSheet.PivotTables("PivotTable9").PivotCache.Refresh
        ActiveSheet.PivotTables("PivotTable1").PivotCache.Refresh
        'ActiveSheet.PivotTables("PivotTable9").PivotFields("Plan Fmly").ClearAllFilters
        ActiveSheet.PivotTables("PivotTable1").PivotFields("Plan Fmly").ClearAllFilters
        Workbooks(myRawMaterialFilename).Activate
        Sheets("Detail").Select
        myWipInvTotal = Range("B" & Rows.Count).End(xlUp).Row
        Range("B5:B" & myWipInvTotal).Value = "=VLOOKUP(F5,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
        Range("B5:B" & myWipInvTotal).Value = Range("B5:B" & myWipInvTotal).Value
        Sheets("Summary").Select
        'ActiveSheet.PivotTables("PivotTable8").PivotCache.Refresh
        'ActiveSheet.PivotTables("PivotTable8").PivotFields("MPF").ClearAllFilters
        ActiveSheet.PivotTables("PivotTable1").PivotCache.Refresh
        ActiveSheet.PivotTables("PivotTable1").PivotFields("MPF").ClearAllFilters
            'Ver2.9: Extend formula
            myTempTotal = Range("A" & Rows.Count).End(xlUp).Row
            Range("F1:F" & myTempTotal).Value = "=B1+C1"
            
    Workbooks(myProjectedInvFilename).Activate
    'Total Inventory(07)
    Range("E3:E" & myTotalInvProjection).Value = "=IFERROR(VLOOKUP(B3,'[" & myWipInventoryFilename & "]PV'!$A:$B,2,0),0)+IFERROR(VLOOKUP(B3,'[" & myRawMaterialFilename & "]Summary'!$A:$F,5,0),0)"
    Range("E3:E" & myTotalInvProjection).Value = Range("E3:E" & myTotalInvProjection).Value
    Range("E" & myTotalInvProjectionStr1 & ":E" & myTotalInvProjectionEnd1).Value = "=IFERROR(VLOOKUP(B" & myTotalInvProjectionStr1 & ",'[" & myWipInventoryFilename & "]PV'!$A:$B,2,0),0)+IFERROR(VLOOKUP(B" & myTotalInvProjectionStr1 & ",'[" & myRawMaterialFilename & "]Summary'!$A:$F,5,0),0)"
    Range("E" & myTotalInvProjectionStr1 & ":E" & myTotalInvProjectionEnd1).Value = Range("E" & myTotalInvProjectionStr1 & ":E" & myTotalInvProjectionEnd1).Value

    'Total Shipped
    Workbooks(mySrsFilename).Activate
    Sheets("SRS").Select
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(BD3=""SO"",BD3=""S1"",BD3=""CO""),Row(BD3),""Delete"")"
    Range("BE3:BE" & mySrsTotal).Value = Range("BE3:BE" & mySrsTotal).Value
    Range("A3:BE" & mySrsTotal).RemoveDuplicates Columns:=57, Header:=xlNo
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    'Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(RIGHT(TRIM(H3),3)=""-MF"",RIGHT(TRIM(H3),3)=""-SW"",RIGHT(TRIM(H3),3)=""-CW"",RIGHT(TRIM(H3),2)=""-S"",RIGHT(TRIM(H3),2)=""-W"",RIGHT(TRIM(H3),2)=""-C""),Row(BD3),""Delete"")"
    Range("BE3:BE" & mySrsTotal).Value = "=IF(OR(RIGHT(TRIM(H3),3)=""-MF"",RIGHT(TRIM(H3),3)=""-SW"",RIGHT(TRIM(H3),2)=""-S"",RIGHT(TRIM(H3),2)=""-W"",RIGHT(TRIM(H3),2)=""-C""),Row(BD3),""Delete"")"
    Range("BE3:BE" & mySrsTotal).Value = Range("BE3:BE" & mySrsTotal).Value
    Range("A3:BE" & mySrsTotal).RemoveDuplicates Columns:=57, Header:=xlNo
    Range("G4:G" & mySrsTotal).Value = "=VLOOKUP(B4,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("G4:G" & mySrsTotal).Value = Range("G4:G" & mySrsTotal).Value
    Sheets("Shipped Not Yet Billed Report").Select
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("AB4:AB" & mySrsTotal).Value = "=IF(OR(G4=""SO"",G4=""S1"",G4=""CO""),Row(G4),""Delete"")"
    Range("AB4:AB" & mySrsTotal).Value = Range("AB4:AB" & mySrsTotal).Value
    Range("A4:BE" & mySrsTotal).RemoveDuplicates Columns:=28, Header:=xlNo
    mySrsTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("G4:G" & mySrsTotal).Value = "=VLOOKUP(K4,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("G4:G" & mySrsTotal).Value = Range("G4:G" & mySrsTotal).Value
    Workbooks(myProjectedInvFilename).Activate
    Range("R3:R" & myTotalInvProjection).Value = "=SUMIF('[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$G:$G,B3,'[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$V:$V)+SUMIF('[" & mySrsFilename & "]SRS'!$G:$G,B3,'[" & mySrsFilename & "]SRS'!$Z:$Z)"
    Range("R3:R" & myTotalInvProjection).Value = Range("R3:R" & myTotalInvProjection).Value
    Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).Value = "=SUMIF('[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$G:$G,B" & myTotalInvProjectionStr1 & ",'[" & mySrsFilename & "]Shipped Not Yet Billed Report'!$V:$V)+SUMIF('[" & mySrsFilename & "]SRS'!$G:$G,B" & myTotalInvProjectionStr1 & ",'[" & mySrsFilename & "]SRS'!$Z:$Z)"
    Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).Value = Range("R" & myTotalInvProjectionStr1 & ":R" & myTotalInvProjectionEnd1).Value
    
    'Projected PO
    Workbooks(myProjectedPoFilename).Activate
    Sheets("PO").Select
    myProPoTotal = Range("B" & Rows.Count).End(xlUp).Row
        'Ver2.9: Backup original MPF
        Range("A4:A" & myProPoTotal).Value = Range("B4:B" & myProPoTotal).Value
    Range("B4:B" & myProPoTotal).Value = "=VLOOKUP(Q4,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("B4:B" & myProPoTotal).Value = Range("B4:B" & myProPoTotal).Value
    Sheets("PV").Select
    ActiveSheet.PivotTables("PivotTable2").PivotCache.Refresh
    'Ver2.9: Change title
    'ActiveSheet.PivotTables("PivotTable2").PivotFields("Family").ClearAllFilters
    ActiveSheet.PivotTables("PivotTable2").PivotFields("MPF").ClearAllFilters
    
    Workbooks(myProjectedInvFilename).Activate
    'Month
    Range("G3:G" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("G3:G" & myTotalInvProjection).Value = Range("G3:G" & myTotalInvProjection).Value
    Range("X3:X" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("X3:X" & myTotalInvProjection).Value = Range("X3:X" & myTotalInvProjection).Value
    Range("AP3:AP" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("AP3:AP" & myTotalInvProjection).Value = Range("AP3:AP" & myTotalInvProjection).Value
    Range("BI3:BI" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth4, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("BI3:BI" & myTotalInvProjection).Value = Range("BI3:BI" & myTotalInvProjection).Value
    Range("CA3:CA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth5, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CA3:CA" & myTotalInvProjection).Value = Range("CA3:CA" & myTotalInvProjection).Value
    Range("CS3:CS" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth6, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("CS3:CS" & myTotalInvProjection).Value = Range("CS3:CS" & myTotalInvProjection).Value
    Range("G" & myTotalInvProjectionStr1 & ":G" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("G" & myTotalInvProjectionStr1 & ":G" & myTotalInvProjectionEnd1).Value = Range("G" & myTotalInvProjectionStr1 & ":G" & myTotalInvProjectionEnd1).Value
    Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).Value = Range("X" & myTotalInvProjectionStr1 & ":X" & myTotalInvProjectionEnd1).Value
    Range("AP" & myTotalInvProjectionStr1 & ":AP" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("AP" & myTotalInvProjectionStr1 & ":AP" & myTotalInvProjectionEnd1).Value = Range("AP" & myTotalInvProjectionStr1 & ":AP" & myTotalInvProjectionEnd1).Value
    Range("BI" & myTotalInvProjectionStr1 & ":BI" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth4, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("BI" & myTotalInvProjectionStr1 & ":BI" & myTotalInvProjectionEnd1).Value = Range("BI" & myTotalInvProjectionStr1 & ":BI" & myTotalInvProjectionEnd1).Value
    Range("CA" & myTotalInvProjectionStr1 & ":CA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth5, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("CA" & myTotalInvProjectionStr1 & ":CA" & myTotalInvProjectionEnd1).Value = Range("CA" & myTotalInvProjectionStr1 & ":CA" & myTotalInvProjectionEnd1).Value
    Range("CS" & myTotalInvProjectionStr1 & ":CS" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myInvMth6, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
    Range("CS" & myTotalInvProjectionStr1 & ":CS" & myTotalInvProjectionEnd1).Value = Range("CS" & myTotalInvProjectionStr1 & ":CS" & myTotalInvProjectionEnd1).Value
        
    'Quarter1
    If myQtr1_1 <> "" Then
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
    End If
    If myQtr1_2 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DI" & myTotalInvProjectionStr1
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).ClearContents
    End If
    If myQtr1_3 <> "" Then
        Range("DI3:DI" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DH3:DH" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DI3"
        Range("DH3:DH" & myTotalInvProjection).Value = Range("DH3:DH" & myTotalInvProjection).Value
        Range("DI3:DI" & myTotalInvProjection).ClearContents
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr1_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DI" & myTotalInvProjectionStr1
        Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value = Range("DH" & myTotalInvProjectionStr1 & ":DH" & myTotalInvProjectionEnd1).Value
        Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).ClearContents
    End If
    'Quarter2
    If Range("DK2").Value <> "FOB" Then
        Range("DK2").Value = "FOB"
        Columns("DK:DK").Insert
        Columns("DK:DK").Hidden = True
    End If
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).ClearContents
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DW3:DW" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+DX3"
    Range("DW3:DW" & myTotalInvProjection).Value = Range("DW3:DW" & myTotalInvProjection).Value
    Range("DX3:DX" & myTotalInvProjection).ClearContents
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DX" & myTotalInvProjectionStr1
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).ClearContents
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr2_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+DX" & myTotalInvProjectionStr1
        Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value = Range("DW" & myTotalInvProjectionStr1 & ":DW" & myTotalInvProjectionEnd1).Value
        Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).ClearContents
    'Quarter3
    If Range("DZ2").Value <> "FOB" Then
        Range("DZ2").Value = "FOB"
        Columns("DZ:DZ").Insert
        Columns("DZ:DZ").Hidden = True
    End If
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).ClearContents
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EL3:EL" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+EM3"
    Range("EL3:EL" & myTotalInvProjection).Value = Range("EL3:EL" & myTotalInvProjection).Value
    Range("EM3:EM" & myTotalInvProjection).ClearContents
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+EM" & myTotalInvProjectionStr1
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).ClearContents
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr3_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+EM" & myTotalInvProjectionStr1
        Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value = Range("EL" & myTotalInvProjectionStr1 & ":EL" & myTotalInvProjectionEnd1).Value
        Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).ClearContents
    'Quarter4
    If Range("EO2").Value <> "FOB" Then
        Range("EO2").Value = "FOB"
        Columns("EO:EO").Insert
        Columns("EO:EO").Hidden = True
    End If
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+FB3"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).ClearContents
    'Range("FB3:BF" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FA3:FA" & myTotalInvProjection).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B3)+BF3"
    Range("FA3:FA" & myTotalInvProjection).Value = Range("FA3:FA" & myTotalInvProjection).Value
    Range("FB3:FB" & myTotalInvProjection).ClearContents
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_1, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")"
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_2, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+FB" & myTotalInvProjectionStr1
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).ClearContents
        'Range("FB" & myTotalInvProjectionStr1 & ":BF" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myProjectedPoFilename & "]PO'!$AD:$AD,'[" & myProjectedPoFilename & "]PO'!$AJ:$AJ,""" & Replace(myQtr4_3, " ", "'", 1) & """,'[" & myProjectedPoFilename & "]PO'!$B:$B,B" & myTotalInvProjectionStr1 & ")+BF" & myTotalInvProjectionStr1
        Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value = Range("FA" & myTotalInvProjectionStr1 & ":FA" & myTotalInvProjectionEnd1).Value
        Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).ClearContents
    
    'Ver2.9: Restore MPF
    Workbooks(myProjectedPoFilename).Activate
    Sheets("PO").Select
        'Ver3.0: Remain Product family
        Columns("A:A").Insert
        Range("A4:A" & myProPoTotal).Value = Range("C4:C" & myProPoTotal).Value
        Range("C4:C" & myProPoTotal).Value = Range("B4:B" & myProPoTotal).Value
        Range("B4:B" & myProPoTotal).Value = Range("A4:A" & myProPoTotal).Value
        Columns("A:A").Delete
        Sheets("PV").Select
        ActiveSheet.PivotTables("PivotTable2").PivotCache.Refresh
    'Range("B4:B" & myProPoTotal).Value = Range("A4:A" & myProPoTotal).Value
    'Range("A4:A" & myProPoTotal).Value = 830
    
    'Planned Discrete Order & Planned SCM Order
    Workbooks(myPoYetToPlaceFilename).Activate
        'Ver2.3: No longer using Po Yet to Place
        Sheets("Details").Copy After:=Sheets(Sheets.Count)
        ActiveSheet.Name = "Temp"
    Sheets("Details").Select
    myProPoTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("D5:D" & myProPoTotal).Value = "=VLOOKUP(B5,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0)"
    Range("D5:D" & myProPoTotal).Value = Range("D5:D" & myProPoTotal).Value
    'Sheets("PV").Select
    'ActiveSheet.PivotTables("PivotTable1").PivotCache.Refresh
    'ActiveSheet.PivotTables("PivotTable1").PivotFields("LeadTime").ClearAllFilters
    Workbooks(myProjectedInvFilename).Activate
    'Ver1.4: Change logic from Leadtime + today's date to just consider leadtime only
'    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
'    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1)-$H3"
'    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
'    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
'    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1)-$Y3"
'    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
'    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
'    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1)-$AQ3"
'    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
'    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
'    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1)-$BJ3"
'    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
'
'    Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
'
'    Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1)-$CB3"
'    Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
'    Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
'    Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1)-$CT3"
'    Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
'
'    'Qtr1
'    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
'    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ") & """)-$DI3"
'    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
'    'Qtr2
'    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
'    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """)-$DX3"
'    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
'    'Qtr3
'    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
'    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """)-$EM3"
'    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
'    'Qtr4
'    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
'    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """)-$FB3"
'    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
'    'Product Family 2nd table
'    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value
'    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,G$1)-$H" & myTotalInvProjectionStr1
'    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value
'    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value
'    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,X$1)-$Y" & myTotalInvProjectionStr1
'    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value
'    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value
'    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,AP$1)-$AQ" & myTotalInvProjectionStr1
'    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value
'    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value
'    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,BI$1)-$BJ" & myTotalInvProjectionStr1
'    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value
'
'    Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value
'    Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CA$1)-$CB" & myTotalInvProjectionStr1
'        Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value
'        Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1," _
'                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'        Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value
'        Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,CS$1)-$CT" & myTotalInvProjectionStr1
'        Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value
'
'    'Qtr1
'    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ", 1) & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value
'    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr1_3, "'", " ") & """)-$DI" & myTotalInvProjectionStr1
'    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value
'    'Qtr2
'    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value
'    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr2_3, "'", " ") & """)-$DX" & myTotalInvProjectionStr1
'    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value
'    'Qtr3
'    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value
'    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr3_3, "'", " ") & """)-$EM" & myTotalInvProjectionStr1
'    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value
'    'Qtr4
'    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """," _
'                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
'    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value
'    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_1, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_2, "'", " ") & """)" _
'                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$O:$O,""" & Replace(myQtr4_3, "'", " ") & """)-$FB" & myTotalInvProjectionStr1
'    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value
    
    myWeekRemain = Workbooks(myMacroFile).Sheets("Macro").Range("K61").Value
    myWeekRemain = myWeekRemain * 7
    Range("H3:H" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("H3:H" & myTotalInvProjection).Value = Range("H3:H" & myTotalInvProjection).Value
    Range("I3:I" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$H3"
    Range("I3:I" & myTotalInvProjection).Value = Range("I3:I" & myTotalInvProjection).Value
    
    If Month("1 " & myInvMth2) / 3 - Int(Month("1 " & myInvMth2) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("Y3:Y" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("Y3:Y" & myTotalInvProjection).Value = Range("Y3:Y" & myTotalInvProjection).Value
    Range("Z3:Z" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$Y3"
    Range("Z3:Z" & myTotalInvProjection).Value = Range("Z3:Z" & myTotalInvProjection).Value
    
    If Month("1 " & myInvMth3) / 3 - Int(Month("1 " & myInvMth3) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("AQ3:AQ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("AQ3:AQ" & myTotalInvProjection).Value = Range("AQ3:AQ" & myTotalInvProjection).Value
    Range("AR3:AR" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$AQ3"
    Range("AR3:AR" & myTotalInvProjection).Value = Range("AR3:AR" & myTotalInvProjection).Value
    
    If Month("1 " & myInvMth4) / 3 - Int(Month("1 " & myInvMth4) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("BJ3:BJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("BJ3:BJ" & myTotalInvProjection).Value = Range("BJ3:BJ" & myTotalInvProjection).Value
    Range("BK3:BK" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$BJ3"
    Range("BK3:BK" & myTotalInvProjection).Value = Range("BK3:BK" & myTotalInvProjection).Value
    
    If myInvMth5 = "" Then
        Columns("CA:CR").Hidden = True
    Else
        If Month("1 " & myInvMth5) / 3 - Int(Month("1 " & myInvMth5) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Range("CB3:CB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CB3:CB" & myTotalInvProjection).Value = Range("CB3:CB" & myTotalInvProjection).Value
        Range("CC3:CC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CB3"
        Range("CC3:CC" & myTotalInvProjection).Value = Range("CC3:CC" & myTotalInvProjection).Value
    End If
    
    If myInvMth6 = "" Then
        Columns("CA:DG").Hidden = True
    Else
        If Month("1 " & myInvMth6) / 3 - Int(Month("1 " & myInvMth6) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Range("CT3:CT" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                     & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                     & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
        Range("CT3:CT" & myTotalInvProjection).Value = Range("CT3:CT" & myTotalInvProjection).Value
        Range("CU3:CU" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CT3"
        Range("CU3:CU" & myTotalInvProjection).Value = Range("CU3:CU" & myTotalInvProjection).Value
    End If
    'Qtr1
    myWeekRemain = myWeekRemain + 91
    Range("DI3:DI" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DI3:DI" & myTotalInvProjection).Value = Range("DI3:DI" & myTotalInvProjection).Value
    Range("DJ3:DJ" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DI3"
    Range("DJ3:DJ" & myTotalInvProjection).Value = Range("DJ3:DJ" & myTotalInvProjection).Value
    'Qtr2
    myWeekRemain = myWeekRemain + 91
    Range("DX3:DX" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DX3:DX" & myTotalInvProjection).Value = Range("DX3:DX" & myTotalInvProjection).Value
    Range("DY3:DY" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DX3"
    Range("DY3:DY" & myTotalInvProjection).Value = Range("DY3:DY" & myTotalInvProjection).Value
    'Qtr3
    myWeekRemain = myWeekRemain + 91
    Range("EM3:EM" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("EM3:EM" & myTotalInvProjection).Value = Range("EM3:EM" & myTotalInvProjection).Value
    Range("EN3:EN" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$EM3"
    Range("EN3:EN" & myTotalInvProjection).Value = Range("EN3:EN" & myTotalInvProjection).Value
    'Qtr4
    myWeekRemain = myWeekRemain + 91
    Range("FB3:FB" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("FB3:FB" & myTotalInvProjection).Value = Range("FB3:FB" & myTotalInvProjection).Value
    Range("FC3:FC" & myTotalInvProjection).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B3,'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$FB3"
    Range("FC3:FC" & myTotalInvProjection).Value = Range("FC3:FC" & myTotalInvProjection).Value
    'Product Family 2nd table
    myWeekRemain = Workbooks(myMacroFile).Sheets("Macro").Range("K61").Value
    myWeekRemain = myWeekRemain * 7
    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value = Range("H" & myTotalInvProjectionStr1 & ":H" & myTotalInvProjectionEnd1).Value
    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AH:$AH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$H" & myTotalInvProjectionStr1
    Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value = Range("I" & myTotalInvProjectionStr1 & ":I" & myTotalInvProjectionEnd1).Value
    
    If Month("1 " & myInvMth2) / 3 - Int(Month("1 " & myInvMth2) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value = Range("Y" & myTotalInvProjectionStr1 & ":Y" & myTotalInvProjectionEnd1).Value
    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AP:$AP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$Y" & myTotalInvProjectionStr1
    Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value = Range("Z" & myTotalInvProjectionStr1 & ":Z" & myTotalInvProjectionEnd1).Value
    
    If Month("1 " & myInvMth3) / 3 - Int(Month("1 " & myInvMth3) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value = Range("AQ" & myTotalInvProjectionStr1 & ":AQ" & myTotalInvProjectionEnd1).Value
    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$AX:$AX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$AQ" & myTotalInvProjectionStr1
    Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value = Range("AR" & myTotalInvProjectionStr1 & ":AR" & myTotalInvProjectionEnd1).Value
    
    If Month("1 " & myInvMth4) / 3 - Int(Month("1 " & myInvMth4) / 3) = 0 Then
        myWeekRemain = myWeekRemain + 35
    Else
        myWeekRemain = myWeekRemain + 28
    End If
    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value = Range("BJ" & myTotalInvProjectionStr1 & ":BJ" & myTotalInvProjectionEnd1).Value
    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BF:$BF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$BJ" & myTotalInvProjectionStr1
    Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value = Range("BK" & myTotalInvProjectionStr1 & ":BK" & myTotalInvProjectionEnd1).Value
    
    If myInvMth5 = "" Then
        
    Else
        If Month("1 " & myInvMth5) / 3 - Int(Month("1 " & myInvMth5) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
        Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                         & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
            Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value = Range("CB" & myTotalInvProjectionStr1 & ":CB" & myTotalInvProjectionEnd1).Value
        Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BN:$BN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CB" & myTotalInvProjectionStr1
            Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value = Range("CC" & myTotalInvProjectionStr1 & ":CC" & myTotalInvProjectionEnd1).Value
    End If
    
    If myInvMth6 = "" Then
        
    Else
        If Month("1 " & myInvMth6) / 3 - Int(Month("1 " & myInvMth6) / 3) = 0 Then
            myWeekRemain = myWeekRemain + 35
        Else
            myWeekRemain = myWeekRemain + 28
        End If
            Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                         & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                         & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
            Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value = Range("CT" & myTotalInvProjectionStr1 & ":CT" & myTotalInvProjectionEnd1).Value
            Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$BV:$BV,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$CT" & myTotalInvProjectionStr1
            Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value = Range("CU" & myTotalInvProjectionStr1 & ":CU" & myTotalInvProjectionEnd1).Value
    End If
    
    'Qtr1
    myWeekRemain = myWeekRemain + 91
    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value = Range("DI" & myTotalInvProjectionStr1 & ":DI" & myTotalInvProjectionEnd1).Value
    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CD:$CD,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CL:$CL,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$CT:$CT,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DI" & myTotalInvProjectionStr1
    Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value = Range("DJ" & myTotalInvProjectionStr1 & ":DJ" & myTotalInvProjectionEnd1).Value
    'Qtr2
    myWeekRemain = myWeekRemain + 91
    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value = Range("DX" & myTotalInvProjectionStr1 & ":DX" & myTotalInvProjectionEnd1).Value
    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DB:$DB,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DJ:$DJ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DR:$DR,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$DX" & myTotalInvProjectionStr1
    Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value = Range("DY" & myTotalInvProjectionStr1 & ":DY" & myTotalInvProjectionEnd1).Value
    'Qtr3
    myWeekRemain = myWeekRemain + 91
    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value = Range("EM" & myTotalInvProjectionStr1 & ":EM" & myTotalInvProjectionEnd1).Value
    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$DZ:$DZ,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EH:$EH,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EP:$EP,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$EM" & myTotalInvProjectionStr1
    Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value = Range("EN" & myTotalInvProjectionStr1 & ":EN" & myTotalInvProjectionEnd1).Value
    'Qtr4
    myWeekRemain = myWeekRemain + 91
    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,""*830*"")" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & "," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """," _
                                                 & "'[" & myPoYetToPlaceFilename & "]Details'!$I:$I,"""")"
    Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value = Range("FB" & myTotalInvProjectionStr1 & ":FB" & myTotalInvProjectionEnd1).Value
    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = "=SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$EX:$EX,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FF:$FF,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)" _
                                                 & "+SUMIFS('[" & myPoYetToPlaceFilename & "]Details'!$FN:$FN,'[" & myPoYetToPlaceFilename & "]Details'!$D:$D,$B" & myTotalInvProjectionStr1 & ",'[" & myPoYetToPlaceFilename & "]Details'!$M:$M,""<=" & myWeekRemain & """)-$FB" & myTotalInvProjectionStr1
    Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value = Range("FC" & myTotalInvProjectionStr1 & ":FC" & myTotalInvProjectionEnd1).Value
End Sub
Sub ProductModelCheck()
    myMacroFile = ActiveWorkbook.Name
    myMacroPath = ActiveWorkbook.Path
    myStrTime = Time
    Range("A54:F" & Rows.Count).ClearContents
    Application.DisplayAlerts = False
    myBucketReportFile = Range("B13").Value
    myHarmonicProductModelFile = Range("B15").Value
    myMicronProductFile = Range("B19").Value
    myOpenPoFile = Range("B27").Value
    myRawMaterialFile = Range("B29").Value
    mySrsFile = Range("B33").Value
    myWipInventoryFile = Range("B35").Value
    
    Workbooks.Open Filename:=myHarmonicProductModelFile, ReadOnly:=True
    myHarmonicProductModelFilename = ActiveWorkbook.Name
    Range("A1:B" & Range("A" & Rows.Count).End(xlUp).Row).Copy
        Workbooks.Open Filename:=myMicronProductFile, ReadOnly:=True
        myMicronProductFilename = ActiveWorkbook.Name
        ActiveSheet.Name = "Temp"
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    Workbooks.Open Filename:=myBucketReportFile, ReadOnly:=True
    myBucketReportFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("A" & Rows.Count).End(xlUp).Row
        'Ver1.6: Format change afte JDE upgrade
        'Range("A1:DK" & myTempTotal).RemoveDuplicates Columns:=2, Header:=xlNo
        Range("A1:DK" & myTempTotal).RemoveDuplicates Columns:=5, Header:=xlNo
        Columns("E:F").Cut
        Columns("B:B").Insert
        myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
        'Range("A1:A" & myTempTotal).Value = "=IF(OR(D1=148,D1=321,D1=586),IF(DB1>0,IFERROR(VLOOKUP(B1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),""""),"""")"
        Range("A1:A" & myTempTotal).Value = "=IF(OR(D1=""148"",D1=""321"",D1=""586""),IF(DS1>0,IFERROR(VLOOKUP(B1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),""""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:DK" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myBucketTotal = Range("B" & Rows.Count).End(xlUp).Row
    If myBucketTotal > 1 Then
        Range("B2:B" & myBucketTotal).Copy
        Workbooks(myMacroFile).Activate
        Range("A54").PasteSpecial xlPasteValues
    End If
    Workbooks(myBucketReportFilename).Close False
    
    Workbooks.Open Filename:=myOpenPoFile, ReadOnly:=True
    myOpenPoFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("Q" & Rows.Count).End(xlUp).Row
    Range("A1:BG" & myTempTotal).RemoveDuplicates Columns:=17, Header:=xlNo
    myTempTotal = Range("Q" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(B1=148,B1=321,B1=586),IFERROR(VLOOKUP(Q1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:BG" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myTempTotal = Range("Q" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("Q2:Q" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("B54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(myOpenPoFilename).Close False
    
    Workbooks.Open Filename:=myRawMaterialFile, ReadOnly:=True
    Sheets("Detail").Select
    myRawMaterialFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("F" & Rows.Count).End(xlUp).Row
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=6, Header:=xlNo
    myTempTotal = Range("F" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(B1=148,B1=321,B1=586),IFERROR(VLOOKUP(F1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myTempTotal = Range("F" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("F2:F" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("C54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(myRawMaterialFilename).Close False
    
    Workbooks.Open Filename:=mySrsFile, ReadOnly:=True
    Sheets("SRS").Select
    mySrsFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
    If ActiveSheet.AutoFilterMode = True Then
       Rows("3:3").AutoFilter
    End If
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=2, Header:=xlNo
    myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(G1=148,G1=321,G1=586),IFERROR(VLOOKUP(B1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
    myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("B2:B" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("D54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(mySrsFilename).Activate
        Sheets("Shipped Not Yet Billed Report").Select
        If ActiveSheet.AutoFilterMode = True Then
           Rows("3:3").AutoFilter
        End If
        ActiveSheet.Name = "Temp1"
            If Range("B3").Value = "" Then
                Rows("3:3").Delete
            End If
            If Range("B2").Value = "" Then
                Rows("2:2").Delete
            End If
            If Range("B1").Value = "" Then
                Rows("1:1").Delete
            End If
        myTempTotal = Range("K" & Rows.Count).End(xlUp).Row
        Range("A1:AA" & myTempTotal).RemoveDuplicates Columns:=11, Header:=xlNo
        myTempTotal = Range("K" & Rows.Count).End(xlUp).Row
        Range("A1:A" & myTempTotal).Value = "=IF(OR(X1=148,X1=321,X1=586),IFERROR(VLOOKUP(K1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
        Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
        Range("C1:C" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
        Range("C1:C" & myTempTotal).Value = Range("C1:C" & myTempTotal).Value
        Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=3, Header:=xlNo
        myTempTotal = Range("B" & Rows.Count).End(xlUp).Row
        If myTempTotal > 1 Then
            Range("B2:B" & myTempTotal).Copy
            Workbooks(myMacroFile).Activate
            'Range("E54").PasteSpecial xlPasteValues
            Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
        End If
    Workbooks(mySrsFilename).Close False
    
    Workbooks.Open Filename:=myWipInventoryFile, ReadOnly:=True
    Sheets("Detail WIP").Select
    myWipInventoryFilename = ActiveWorkbook.Name
    ActiveSheet.Name = "Temp"
        If Range("B3").Value = "" Then
            Rows("3:3").Delete
        End If
        If Range("B2").Value = "" Then
            Rows("2:2").Delete
        End If
        If Range("B1").Value = "" Then
            Rows("1:1").Delete
        End If
    myTempTotal = Range("G" & Rows.Count).End(xlUp).Row
    Range("A1:U" & myTempTotal).RemoveDuplicates Columns:=7, Header:=xlNo
    myTempTotal = Range("G" & Rows.Count).End(xlUp).Row
    Range("A1:A" & myTempTotal).Value = "=IF(OR(C1=148,C1=321,C1=586),IFERROR(VLOOKUP(G1,'[" & myMicronProductFilename & "]Temp'!$A:$B,2,0),""NA""),"""")"
    Range("A1:A" & myTempTotal).Value = Range("A1:A" & myTempTotal).Value
    Range("B1:B" & myTempTotal).Value = "=IF(A1=""NA"",Row(A1),""Delete"")"
    Range("B1:B" & myTempTotal).Value = Range("B1:B" & myTempTotal).Value
    Range("A1:M" & myTempTotal).RemoveDuplicates Columns:=2, Header:=xlNo
    myTempTotal = Range("G" & Rows.Count).End(xlUp).Row
    If myTempTotal > 1 Then
        Range("G2:G" & myTempTotal).Copy
        Workbooks(myMacroFile).Activate
        'Range("F54").PasteSpecial xlPasteValues
        Range("A" & Range("A" & Rows.Count).End(xlUp).Row + 1).PasteSpecial xlPasteValues
    End If
    Workbooks(myWipInventoryFilename).Close False
    Workbooks(myHarmonicProductModelFilename).Close False
    Workbooks(myMicronProductFilename).Close False
    Workbooks(myMacroFile).Activate
    If Range("A" & Rows.Count).End(xlUp).Row > 53 Then
        Range("A53:A" & Range("A" & Rows.Count).End(xlUp).Row).RemoveDuplicates Columns:=1, Header:=xlNo
    End If
    Columns("A:F").EntireColumn.AutoFit
    Application.DisplayAlerts = True
    myEndTime = Time
    Range("A1").Select
    MsgBox "Done in " & Format(myEndTime - myStrTime, "hh:mm:ss")
End Sub
Sub ErrHnd1()
    On Error GoTo Err1
    Sheets("Aging Parts Details (ISL)").Select
    ActiveSheet.Name = "Aging Parts Details (ISL)2"
    Exit Sub
Err1:
End Sub
Sub ErrHnd2()
    On Error GoTo Err2
    Sheets("PV").Select
    ActiveSheet.Name = "PV_2"
    Exit Sub
Err2:
End Sub
    
